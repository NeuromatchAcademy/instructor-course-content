
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 3: Numerical Methods — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W0D4_DaySummary.html" rel="next" title="Day Summary"/>
<link href="W0D4_Tutorial2.html" rel="prev" title="Tutorial 2: Differential Equations"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training: Computational Neuroscience (CN)
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Calculus (W0D4)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W0D4_Calculus/instructor/W0D4_Tutorial3.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W0D4_Calculus/instructor/W0D4_Tutorial3.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Numerical Methods
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-intro-to-the-euler-method-using-the-population-differential-equation">
   Section 1: Intro to the Euler method using the population differential equation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-intro-to-numerical-methods-for-differential-equations">
     Video 1: Intro to numerical methods for differential equations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-slope-of-line-as-approximation-of-derivative">
     Section 1.1: Slope of line as approximation of derivative
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-slope-of-a-line">
       Interactive Demo 1.1: Slope of a Line
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-euler-error-for-a-single-step">
     Section 1.2: Euler error for a single step
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-euler-error-for-a-single-step">
       Interactive Demo 1.2: Euler error for a single step
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-3-taking-more-steps">
     Section 1.3: Taking more steps
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-taking-more-steps">
       Video 2: Taking more steps
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-3-step-step-step">
       Coding Exercise 1.3: Step, step, step
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-euler-method-for-the-leaky-integrate-and-fire">
   Section 2: Euler method for the leaky integrate and fire
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-leaky-integrate-and-fire">
     Video 3: Leaky integrate and fire
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-lif-and-euler">
     Coding Exercise 2: LIF and Euler
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-systems-of-differential-equations">
   Section 3: Systems of differential equations
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-systems-of-differential-equations">
     Video 4: Systems of differential equations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-using-euler-to-approximate-a-simple-system">
     Section 3.1: Using Euler to approximate a simple system
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-1-euler-on-a-simple-system">
       Coding Exercise 3.1: Euler on a Simple System
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-simple-euler-solution-to-the-wilson-cowan-model">
       Think! 3.1: Simple Euler solution to the Wilson Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-phase-plane-plot-and-nullcline">
     Section 3.2: Phase Plane Plot and Nullcline
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-6-1-discuss-the-plots">
       Think! 6.1: Discuss the Plots
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-3-adding-internal-connections">
     Section 3.3: Adding internal connections
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-3-oscillations">
       Think! 3.3: Oscillations
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-4-phase-plane-and-nullclines-part-2">
     Section 3.4 Phase Plane and Nullclines Part 2
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-4-a-small-change-changes-everything">
       Interactive Demo 3.4: A small change changes everything
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-summary">
     Video 5: Summary
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#links-to-neuromatch-days">
   Links to Neuromatch Days
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#references">
   References
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bibliography">
   Bibliography
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#supplemental-popular-reading-list">
     Supplemental Popular Reading List
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#popular-podcast">
     Popular Podcast
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-the-4th-order-runge-kutta">
     Bonus Section 1: The 4th Order Runge Kutta
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end">
     Bonus  Section 2: Neural oscillations are a start toward understanding brain activity rather than the end
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
       Helper functions
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-1-what-is-an-oscillator">
       Bonus 2.1: What is an Oscillator?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-bonus-2-1">
         Interactive Demo Bonus 2.1
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-2-not-all-oscillators-are-alike">
       Bonus 2.2 : Not all oscillators are alike
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-bonus-2-stuart-landau-system">
         Interactive Demo Bonus 2: Stuart-Landau System
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 3: Numerical Methods</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Numerical Methods
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-intro-to-the-euler-method-using-the-population-differential-equation">
   Section 1: Intro to the Euler method using the population differential equation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-intro-to-numerical-methods-for-differential-equations">
     Video 1: Intro to numerical methods for differential equations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-slope-of-line-as-approximation-of-derivative">
     Section 1.1: Slope of line as approximation of derivative
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-slope-of-a-line">
       Interactive Demo 1.1: Slope of a Line
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-euler-error-for-a-single-step">
     Section 1.2: Euler error for a single step
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-euler-error-for-a-single-step">
       Interactive Demo 1.2: Euler error for a single step
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-3-taking-more-steps">
     Section 1.3: Taking more steps
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-taking-more-steps">
       Video 2: Taking more steps
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-3-step-step-step">
       Coding Exercise 1.3: Step, step, step
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-euler-method-for-the-leaky-integrate-and-fire">
   Section 2: Euler method for the leaky integrate and fire
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-leaky-integrate-and-fire">
     Video 3: Leaky integrate and fire
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-lif-and-euler">
     Coding Exercise 2: LIF and Euler
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-systems-of-differential-equations">
   Section 3: Systems of differential equations
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-systems-of-differential-equations">
     Video 4: Systems of differential equations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-using-euler-to-approximate-a-simple-system">
     Section 3.1: Using Euler to approximate a simple system
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-1-euler-on-a-simple-system">
       Coding Exercise 3.1: Euler on a Simple System
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-simple-euler-solution-to-the-wilson-cowan-model">
       Think! 3.1: Simple Euler solution to the Wilson Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-phase-plane-plot-and-nullcline">
     Section 3.2: Phase Plane Plot and Nullcline
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-6-1-discuss-the-plots">
       Think! 6.1: Discuss the Plots
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-3-adding-internal-connections">
     Section 3.3: Adding internal connections
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-3-oscillations">
       Think! 3.3: Oscillations
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-4-phase-plane-and-nullclines-part-2">
     Section 3.4 Phase Plane and Nullclines Part 2
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-4-a-small-change-changes-everything">
       Interactive Demo 3.4: A small change changes everything
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-summary">
     Video 5: Summary
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#links-to-neuromatch-days">
   Links to Neuromatch Days
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#references">
   References
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bibliography">
   Bibliography
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#supplemental-popular-reading-list">
     Supplemental Popular Reading List
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#popular-podcast">
     Popular Podcast
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-the-4th-order-runge-kutta">
     Bonus Section 1: The 4th Order Runge Kutta
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end">
     Bonus  Section 2: Neural oscillations are a start toward understanding brain activity rather than the end
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
       Helper functions
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-1-what-is-an-oscillator">
       Bonus 2.1: What is an Oscillator?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-bonus-2-1">
         Interactive Demo Bonus 2.1
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-2-not-all-oscillators-are-alike">
       Bonus 2.2 : Not all oscillators are alike
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-bonus-2-stuart-landau-system">
         Interactive Demo Bonus 2: Stuart-Landau System
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/precourse/blob/main/tutorials/W0D4_Calculus/instructor/W0D4_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D4_Calculus/instructor/W0D4_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-3-numerical-methods">
<h1>Tutorial 3: Numerical Methods<a class="headerlink" href="#tutorial-3-numerical-methods" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 0, Day 3: Calculus</strong></p>
<p><strong>Content creators:</strong> John S Butler, Arvind Kumar with help from Harvey McCone</p>
<p><strong>Content reviewers:</strong> Swapnil Kumar, Matthew McCann</p>
<p><strong>Production editors:</strong> Matthew McCann, Ella Batty</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 70 minutes</em></p>
<p>While a great deal of neuroscience can be described by mathematics, a great deal of the mathematics used cannot be solved exactly. This might seem very odd that you can writing something in mathematics that cannot be immediately solved but that is the beauty and mystery of mathematics. To side step this issue we use Numerical Methods to estimate the solution.</p>
<p>In this tutorial, we will look at the Euler method to estimate the solution of a few different differential equations: the population equation, the Leaky Integrate and Fire model and a simplified version of the Wilson-Cowan model which is a system of differential equations.</p>
<p><strong>Steps:</strong></p>
<ul class="simple">
<li><p>Code the Euler estimate of the Population Equation;</p></li>
<li><p>Investigate the impact of time step on the error of the numerical solution;</p></li>
<li><p>Code the Euler estimate of the Leaky Integrate and Fire model for a constant input;</p></li>
<li><p>Visualize and listen to the response of the integrate for different inputs;</p></li>
<li><p>Apply the Euler method to estimate the solution of a system of differential equations.</p></li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">ipd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>  <span class="c1"># interactive display</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">Label</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/content-creation/main/nma.mplstyle"</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting Functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_slope</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      dt  : time-step</span>
<span class="sd">    Returns:</span>
<span class="sd">      A figure of an exponential, the slope of the exponential and the derivative exponential</span>
<span class="sd">  """</span>

  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># Exponential</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y'</span><span class="p">)</span>
    <span class="c1"># slope</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">))],</span><span class="s1">':og'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac{y(1+\Delta t)-y(1)}{\Delta t}$'</span><span class="p">)</span>
    <span class="c1"># derivative</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))],</span><span class="s1">'-k'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{dy}{dt}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">)),</span> <span class="s1">'og'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="k">def</span> <span class="nf">plot_StepEuler</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      dt  : time-step</span>
<span class="sd">    Returns:</span>
<span class="sd">      A figure of one step of the Euler method for an exponential growth function</span>
<span class="sd">  """</span>

  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,],[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">)],</span><span class="s1">'og'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Known'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">)],</span><span class="s1">':g'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Euler'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="s1">'or'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Estimate $p_1$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">'bo'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Exact $p(t_1)$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">),</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Error $e_1$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="sa">r</span><span class="s1">'$e_1$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Population (millions)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(years)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">visualize_population_approx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Exact Solution'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="s1">':o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Euler Estimate'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span>
              <span class="n">colors</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Error $e_k$'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Population (millions)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (years)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">## LIF PLOT</span>
<span class="k">def</span> <span class="nf">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      t  : time</span>
<span class="sd">      V  : membrane Voltage</span>
<span class="sd">      I  : Input</span>
<span class="sd">      Spike_time : Spike_times</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with three panels</span>
<span class="sd">      top panel: Input as a function of time</span>
<span class="sd">      middle panel: membrane potential as a function of time</span>
<span class="sd">      bottom panel: Raster plot</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># PLOT OF INPUT</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$I_e(nA)$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="s1">'g'</span><span class="p">)</span>
    <span class="c1">#plt.ylim((2,4))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="c1"># PLOT OF ACTIVITY</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="s1">':'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$V(t)$(mV)'</span><span class="p">)</span>
    <span class="c1"># PLOT OF SPIKES</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Spike'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(ms)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation rate</span>
<span class="sd">      r_I : inhibition rate</span>

<span class="sd">    Returns:</span>
<span class="sd">      figure of r_I and r_E as a function of time</span>

<span class="sd">  """</span>
  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(ms)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Firing Rate (Hz)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_rErI_Simple</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation rate</span>
<span class="sd">      r_I : inhibition rate</span>

<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      left panel: r_I and r_E as a function of time</span>
<span class="sd">      right panel: r_I as a function of r_E with Nullclines</span>

<span class="sd">  """</span>
  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># LEFT PANEL</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(ms)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Firing Rate (Hz)'</span><span class="p">)</span>
    <span class="c1"># RIGHT PANEL</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">'k:'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">'go'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">r_E</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_E</span><span class="p">),</span><span class="n">linestyles</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_E=0$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">r_I</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_I</span><span class="p">),</span><span class="n">linestyles</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_I=0$'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">Null_rE</span><span class="p">,</span> <span class="n">Null_rI</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      t   : time</span>
<span class="sd">      r_E : excitation firing rate</span>
<span class="sd">      r_I : inhibition firing rate</span>
<span class="sd">      Null_rE: Nullclines excitation firing rate</span>
<span class="sd">      Null_rI: Nullclines inhibition firing rate</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      left panel: r_I and r_E as a function of time</span>
<span class="sd">      right panel: r_I as a function of r_E with Nullclines</span>

<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_E</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(ms)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Firing Rate (Hz)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">r_I</span><span class="p">,</span><span class="s1">'k:'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">'go'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">Null_rE</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_E=0$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_E</span><span class="p">,</span><span class="n">Null_rI</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{d}{dt}</span><span class="s1">r_I=0$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-intro-to-the-euler-method-using-the-population-differential-equation">
<h1>Section 1: Intro to the Euler method using the population differential equation<a class="headerlink" href="#section-1-intro-to-the-euler-method-using-the-population-differential-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-1-intro-to-numerical-methods-for-differential-equations">
<h2>Video 1: Intro to numerical methods for differential equations<a class="headerlink" href="#video-1-intro-to-numerical-methods-for-differential-equations" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="section-1-1-slope-of-line-as-approximation-of-derivative">
<h2>Section 1.1: Slope of line as approximation of derivative<a class="headerlink" href="#section-1-1-slope-of-line-as-approximation-of-derivative" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 8 min</em></p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>The Euler method is one of the straight forward and elegant methods to approximate a differential. It was designed by <a class="reference external" href="https://en.wikipedia.org/wiki/Leonhard_Euler">Leonhard Euler</a> (1707-1783).
Simply put we just replace the derivative in the differential equation by the formula for a line and re-arrange.</p>
<p>The slope is the rate of change between two points. The formula for the slope of a line between the points <span class="math notranslate nohighlight">\((t_0,y(t_0))\)</span> and <span class="math notranslate nohighlight">\((t_1,y(t_1))\)</span> is given by:
$<span class="math notranslate nohighlight">\( m=\frac{y(t_1)-y(t_0)}{t_1-t_0}, \)</span><span class="math notranslate nohighlight">\(
which can be written as 
\)</span><span class="math notranslate nohighlight">\( m=\frac{y_1-y_0}{t_1-t_0}, \)</span><span class="math notranslate nohighlight">\(
or as
\)</span><span class="math notranslate nohighlight">\( m=\frac{\Delta y_0}{\Delta t_0}, \)</span><span class="math notranslate nohighlight">\(
where \)</span>\Delta y_0=y_1-y_0<span class="math notranslate nohighlight">\( and \)</span>\Delta t_0=t_1-t_0<span class="math notranslate nohighlight">\( or in words as
\)</span><span class="math notranslate nohighlight">\( m=\frac{\text{ Change in y} }{\text{Change in t}}. \)</span><span class="math notranslate nohighlight">\(
The slope can be used as an approximation of the derivative such that
\)</span><span class="math notranslate nohighlight">\( \frac{d}{dt}y(t)\approx \frac{y(t_0+\Delta t)-y(t_0)}{t_0+\Delta t-t_0}=\frac{y(t_0+dt)-y(t_0)}{\Delta t}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\Delta t$ is a time-step.</p>
</details><div class="section" id="interactive-demo-1-1-slope-of-a-line">
<h3>Interactive Demo 1.1: Slope of a Line<a class="headerlink" href="#interactive-demo-1-1-slope-of-a-line" title="Permalink to this headline">¶</a></h3>
<p>The plot below shows a function <span class="math notranslate nohighlight">\(y(t)\)</span> in blue, its exact derivative <span class="math notranslate nohighlight">\( \frac{d}{dt}y(t)\)</span> at <span class="math notranslate nohighlight">\(t_0=1\)</span> in black, and the approximate derivative calculated using the slope formula <span class="math notranslate nohighlight">\(=\frac{y(1+\Delta t)-y(1)}{\Delta t}\)</span> for different time-steps sizes <span class="math notranslate nohighlight">\(\Delta t\)</span> in green.</p>
<p>Interact with the widget to see how time-step impacts the accuracy of the slope which is the estimate of the derivative.</p>
<ul class="simple">
<li><p>How does the size of <span class="math notranslate nohighlight">\(\Delta t\)</span> affect the approximation?</p></li>
</ul>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>

    <span class="n">dt</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>

<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="n">plot_slope</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">  The larger the time-step $dt$, the worse job the formula of the slope of a</span>
<span class="sd">  line does to approximate the derivative.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-2-euler-error-for-a-single-step">
<h2>Section 1.2: Euler error for a single step<a class="headerlink" href="#section-1-2-euler-error-for-a-single-step" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 12 min</em></p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>Linking with the previous tutorial, we will use the population differential equation to get an intuitive feel of using the Euler method to approximate the solution of a differential equation, as it has an exact solution with no discontinuities.</p>
<p>The population differential equation is given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{d}{dt}\,p(t) &amp;= \alpha p(t)\\\\
p(0)&amp;=p_0 \quad \text{Initial Condition}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(p(t)\)</span> is the population at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> is a parameter representing birth rate. The exact solution of the differential equation is
$<span class="math notranslate nohighlight">\( p(t)=p_0e^{\alpha t}.\)</span>$</p>
<p>To numerically estimate the population differential equation we replace the derivate with the slope of the line to get the discrete (not continuous) equation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\\
\frac{p_1-p_0}{t_1-t_0} &amp;= \alpha p_0\\\\
p(0)&amp;=p_0 \quad \text{Initial Condition}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_1\)</span> is the estimate of <span class="math notranslate nohighlight">\(p(t_1)\)</span>. Let <span class="math notranslate nohighlight">\(\Delta t=t_1-t_0\)</span> be the time-step and re-arrange the equation gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p_1}&amp;=\color{green}{p_0}+\color{blue}{\Delta t} (\color{blue}{\alpha} \color{green}{p_0})
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{p_1}\)</span> is the unknown future, <span class="math notranslate nohighlight">\(\color{green}{p_0}\)</span> is the known current population, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter and <span class="math notranslate nohighlight">\(\color{blue}{\alpha}\)</span> is the given birth rate parameter.
Another way to read the re-arranged discrete equation is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{\text{"Future Population"}}&amp;=\color{green}{\text{ "Current Population"}}+\color{blue}{\text{ time-step}} \times (\color{blue}{\text{ "Birth rate}}\times  \color{green}{\text{ Current Population"}}).
\end{align*}\]</div>
<p>So pretty much, we can use the current population and add a bit of the dynamics of the differential equation to predict the future. We will make millions… But wait there is always an error.</p>
<p>The solution of the Euler method <span class="math notranslate nohighlight">\(p_1\)</span> is an estimate of the exact solution <span class="math notranslate nohighlight">\(p(t_1)\)</span> at <span class="math notranslate nohighlight">\(t_1\)</span> which means there is a bit of error <span class="math notranslate nohighlight">\(e_1\)</span> which gives the equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
p(t_1)&amp;=p_1+e_1\\\\
\text{Rearranging}\\\\
e_1&amp;=p(t_1)-p_1,\\
\text{Error}&amp;=\text{Exact-Estimate}.
\end{align*}\]</div>
<p>Most of the time we do not know the exact answer <span class="math notranslate nohighlight">\(p(t_1)\)</span> and hence the size of the error <span class="math notranslate nohighlight">\(e_1\)</span> but for the population equation we have the exact solution <span class="math notranslate nohighlight">\( p(t)=p_0e^{\alpha}.\)</span></p>
<p>This means we can explore what the error looks like.</p>
</details><div class="section" id="interactive-demo-1-2-euler-error-for-a-single-step">
<h3>Interactive Demo 1.2: Euler error for a single step<a class="headerlink" href="#interactive-demo-1-2-euler-error-for-a-single-step" title="Permalink to this headline">¶</a></h3>
<p>Interact with the widget to see how the time-step <span class="math notranslate nohighlight">\(\Delta t\)</span>, dt in code, impacts the estimate <span class="math notranslate nohighlight">\(p_1\)</span> and the error <span class="math notranslate nohighlight">\(e_1\)</span> of the Euler method.</p>
<ol class="simple">
<li><p>What happens to the estimate <span class="math notranslate nohighlight">\(p_1\)</span> as the time-step <span class="math notranslate nohighlight">\(\Delta t\)</span> increases?</p></li>
<li><p>Is there a relationship between the size of <span class="math notranslate nohighlight">\(\Delta t\)</span> and <span class="math notranslate nohighlight">\(e_1\)</span>?</p></li>
<li><p>How would you improve the error <span class="math notranslate nohighlight">\(e_1\)</span>?</p></li>
</ol>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="n">plot_StepEuler</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">  1. The larger the time-step $\Delta t$ the more the estimate $p_1$ deviates</span>
<span class="sd">  from the exact $p(t_1)$.</span>

<span class="sd">  2. There is a linear relationship between $\Delta t$ and $e_1$: double the time-step double the error.</span>

<span class="sd">  3. Make more shorter time-steps</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>The error <span class="math notranslate nohighlight">\(e_1\)</span> from one time-step is known as the <strong>local error</strong>. For the Euler method the local error is linear, which means that the error decreases linearly as a function of timestep and is written as <span class="math notranslate nohighlight">\(O(\Delta t)\)</span>.</p>
</div>
</div>
<div class="section" id="section-1-3-taking-more-steps">
<h2>Section 1.3: Taking more steps<a class="headerlink" href="#section-1-3-taking-more-steps" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 16 min</em></p>
<div class="section" id="video-2-taking-more-steps">
<h3>Video 2: Taking more steps<a class="headerlink" href="#video-2-taking-more-steps" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>In the above exercise we saw that by increasing the time-step <span class="math notranslate nohighlight">\(\Delta t\)</span> the error between the estimate <span class="math notranslate nohighlight">\(p_1\)</span> and the exact <span class="math notranslate nohighlight">\(p(t_1)\)</span> increased.  The largest error in the example above was for <span class="math notranslate nohighlight">\(\Delta t=4\)</span>, meaning the first time point was at 1 year and the second was at 5 years (as 5 - 1 = 4).</p>
<p>To decrease the error, we can divide the interval <span class="math notranslate nohighlight">\([1, 5]\)</span> into more steps using a smaller <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>In the plot below we use <span class="math notranslate nohighlight">\(\Delta t=1\)</span>, which divides the interval into four segments
$<span class="math notranslate nohighlight">\(n=\frac{5-1}{1}=4,\)</span><span class="math notranslate nohighlight">\(
giving
\)</span><span class="math notranslate nohighlight">\( t_0=t[0]=1, \ t_1=t[1]=2, \ t_2=t[2]=3, \ t_3=t[3]=4 \ \text{ and } t_4=t[4]=5. \)</span><span class="math notranslate nohighlight">\(
This can be written as
\)</span><span class="math notranslate nohighlight">\( t[k]=1+k\times1, \text{ for } k=0,\cdots 4, \)</span><span class="math notranslate nohighlight">\(
and more generally as 
\)</span><span class="math notranslate nohighlight">\( t[k]=t[k]+k\times \Delta t, \text{ for } k=0,\cdots n, \)</span><span class="math notranslate nohighlight">\(
where \)</span>n$ is the number of steps.</p>
<p>Using the Euler method, the continuous population differential equation is written as a series of discrete difference equations of the form:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p[k+1]}&amp;=\color{green}{p[k]}+\color{blue}{\Delta t} (\color{blue}{\alpha} \color{green}{p[k]})\\
&amp;\text{for } k=0,1,\cdots n-1
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{p[k+1]}\)</span> is the unknown estimate of the future population at <span class="math notranslate nohighlight">\(t[k+1]\)</span>, <span class="math notranslate nohighlight">\(\color{green}{p[k]}\)</span> is the known current population estimate at <span class="math notranslate nohighlight">\(t_k\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter and <span class="math notranslate nohighlight">\(\color{blue}{\alpha}\)</span> is the given birth rate parameter.</p>
<p>The Euler method can be applied to all first order differential equations of the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d}{dt}y(t)&amp;=f(t,y(t)),\\
y(t_{0})&amp;=y_0,\\
\end{align*}\]</div>
<p>on an interval <span class="math notranslate nohighlight">\([a,b]\)</span>.</p>
<p>Using the Euler method all differential equation can be written as discrete difference equations:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{y[k+1]}-\color{green}{y[k]}}{\color{blue}{\Delta t}}&amp;=f(\color{blue}{t[k]},\color{green}{y[k]}),\\
\text{Re-arranging}\\
\color{red}{y[k+1]}&amp;=\color{green}{y[k]}+\color{blue}{\Delta t}f(\color{blue}{t[k]},\color{green}{y[k]}),\\
&amp;\text{ for } k=0, \cdots n-1,\\
y[0]&amp;=\color{green}{y_0},\\
\end{align*}\]</div>
<p>where  <span class="math notranslate nohighlight">\(\color{red}{y[k+1]}\)</span> is the unknown estimate at <span class="math notranslate nohighlight">\(t[k+1]\)</span>, <span class="math notranslate nohighlight">\(\color{green}{y[k]}\)</span> is the known at <span class="math notranslate nohighlight">\(t_k\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is the chosen time-step parameter, <span class="math notranslate nohighlight">\(\color{blue}{t[k]}\)</span> is the time point and <span class="math notranslate nohighlight">\(f\)</span> is the right hand side of the differential equation.
The discrete time steps are:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{blue}{t[k]}&amp;=\color{blue}{t[0]}+\color{blue}{k}\color{blue}{\Delta t},\\
n&amp;=\frac{b-a}{\Delta t}\\
&amp;\text{ for } k=0, \cdots n.\\
\end{align*}\]</div>
<p>Once again this can be simply put into words:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{\text{ "Future" }}&amp;=\color{green}{\text{ "Current Info" }}+\color{blue}{\text{ time-step } }\times\text{ "Dynamics of the system which is a function of } \color{blue}{ \text{ time }} \text{ and }\color{green}{ \text{ Current Info." }}
\end{align*}\]</div>
<p><em>Execute this cell to visualize time steps</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute this cell to visualize time steps*</span>
<span class="n">dt</span>  <span class="o">=</span><span class="mi">1</span>
<span class="n">t</span>  <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="c1"># Time from 1 to 5 years in 0.1 steps</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="s1">':o'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span><span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">':go'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Initial Condition'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$t_0$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$t_1$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$t_2$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$t_3$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="sa">r</span><span class="s1">'$t_4$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\Delta t$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\Delta t$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\Delta t$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\Delta t$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span><span class="c1">#plt.ylabel('Population (millions)')</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time(years)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</details></div>
<div class="section" id="coding-exercise-1-3-step-step-step">
<h3>Coding Exercise 1.3: Step, step, step<a class="headerlink" href="#coding-exercise-1-3-step-step-step" title="Permalink to this headline">¶</a></h3>
<p>Given the population differential equation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d}{dt}\,p(t) &amp;= 0.3 p(t),\\
\end{align*}\]</div>
<p>and the initial condition:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
p(t_0=1)&amp;=e^{0.3},
\end{align*}\]</div>
<p>code the difference equation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{p[k+1]}&amp;=\color{green}{p[k]}+\color{blue}{\Delta t} (\color{blue}{0.3} \color{green}{p[k]}),\\
\color{green}{p[0]}&amp;=e^{0.3},\quad \text{Initial Condition,}\\
&amp;\text{for } k=0,1,\cdots 4,\\
\end{align*}\]</div>
<p>to estimate the population on the interval <span class="math notranslate nohighlight">\([1,5]\)</span> with a time-step <span class="math notranslate nohighlight">\(\Delta t=1\)</span>, denoted by <code class="docutils literal notranslate"><span class="pre">dt</span></code> in code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time step</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Make time range from 1 to 5 years with step size dt</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Get number of steps</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Initialize p array</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># initial condition</span>

<span class="c1"># Loop over steps</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

  <span class="c1">########################################################################</span>
  <span class="c1">## TODO for students</span>
  <span class="c1">## Complete line of code and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: calculate the population step for each time point"</span><span class="p">)</span>
  <span class="c1">########################################################################</span>

  <span class="c1"># Calculate the population step</span>
  <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Visualize</span>
<span class="n">visualize_population_approx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Time step</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Make time range from 1 to 5 years with step size dt</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Get number of steps</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Initialize p array</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># initial condition</span>

<span class="c1"># Loop over steps</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

  <span class="c1"># Calculate the population step</span>
    <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">visualize_population_approx</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The error is smaller for 4 time-steps than taking one large time step from 1 to 5 but do note that the error is increasing for each step. This is known as <strong>global error</strong> so the futher in time you want to predict, the larger the error.
You can read the theorems <a class="reference external" href="https://colab.research.google.com/github/john-s-butler-dit/Numerical-Analysis-Python/blob/master/Chapter%2001%20-%20Euler%20Methods/102_Euler_method_with_Theorems_nonlinear_Growth_function.ipynb">here.</a></p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-euler-method-for-the-leaky-integrate-and-fire">
<h1>Section 2: Euler method for the leaky integrate and fire<a class="headerlink" href="#section-2-euler-method-for-the-leaky-integrate-and-fire" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 26 min</em></p>
<div class="section" id="video-3-leaky-integrate-and-fire">
<h2>Video 3: Leaky integrate and fire<a class="headerlink" href="#video-3-leaky-integrate-and-fire" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<details>
<summary> <font color="blue">Click here for text recap of video </font></summary>
<p>The Leaky Integrate and Fire (LIF) differential equation is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d48a2fe8-8785-48e1-9c7f-b15dc4a7112a">
<span class="eqno">(82)<a class="headerlink" href="#equation-d48a2fe8-8785-48e1-9c7f-b15dc4a7112a" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dV}{dt} = \frac{-(V-E_L) + R_mI(t)}{\tau_m}\,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_m\)</span> is the time constant, <span class="math notranslate nohighlight">\(V\)</span> is the membrane potential, <span class="math notranslate nohighlight">\(E_L\)</span> is the resting potential, <span class="math notranslate nohighlight">\(R_m\)</span> is leak resistance and <span class="math notranslate nohighlight">\(I(t)\)</span> is the external input current.</p>
<p>The solution of the LIF can be estimated by applying the Euler method to give the difference equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0229e774-2d57-4ac4-a5c8-5f428f3b19f9">
<span class="eqno">(83)<a class="headerlink" href="#equation-0229e774-2d57-4ac4-a5c8-5f428f3b19f9" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\color{red}{V[k+1]}-\color{green}{V[k]}}{\color{blue}{\Delta t}}=\big(\frac{-(\color{green}{V[k]}-\color{blue}{E_L}) + \color{blue}{R_m}I[k]}{\color{blue}{\tau_m}}\big),\\
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(V[k]\)</span> is the estimate of the membrane potential at time point <span class="math notranslate nohighlight">\(t[k]\)</span>.
Re-arranging the equation such that all the known terms are on the right gives:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c11a8a8b-7c71-4c77-889e-1ef07f871bb7">
<span class="eqno">(84)<a class="headerlink" href="#equation-c11a8a8b-7c71-4c77-889e-1ef07f871bb7" title="Permalink to this equation">¶</a></span>\[\begin{align}
\color{red}{V[k+1]}=\color{green}{V[k]}+\color{blue}{\Delta t}\big(\frac{-(\color{green}{V[k]}-\color{blue}{E_L}) + \color{blue}{R_m}I[k]}{\color{blue}{\tau_m}}\big),\\
\text{for } k=0\cdots n-1,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{V[k+1]}\)</span> is the unknown membrane potential at <span class="math notranslate nohighlight">\(t[k+1]\)</span>, <span class="math notranslate nohighlight">\(\color{green}{V[k]} \)</span> is known membrane potential, <span class="math notranslate nohighlight">\(\color{blue}{E_L}\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{R_m}\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_m}\)</span> are known parameters, <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}\)</span> is a chosen time-step and  <span class="math notranslate nohighlight">\(I(t_k)\)</span> is a function for an external input current.</p>
</details></div>
<div class="section" id="coding-exercise-2-lif-and-euler">
<h2>Coding Exercise 2: LIF and Euler<a class="headerlink" href="#coding-exercise-2-lif-and-euler" title="Permalink to this headline">¶</a></h2>
<p>Code the difference equation for the LIF:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ef7f12c2-db06-4b8a-a275-c6bb24ba8235">
<span class="eqno">(85)<a class="headerlink" href="#equation-ef7f12c2-db06-4b8a-a275-c6bb24ba8235" title="Permalink to this equation">¶</a></span>\[\begin{align}
\color{red}{V[k+1]}=\color{green}{V[k]}+\color{blue}{\Delta t}\big(\frac{-(\color{green}{V[k]}-\color{blue}{E_L}) + \color{blue}{R_m}I[k]}{\color{blue}{\tau_m}}\big),\\
\text{for } k=0\cdots n-1,
\end{align}\]</div>
<p>with the given parameters set as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">V_reset</span> <span class="pre">=</span> <span class="pre">-75,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E_L</span> <span class="pre">=</span> <span class="pre">-75,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tau_m</span> <span class="pre">=</span> <span class="pre">10,</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_m</span> <span class="pre">=</span> <span class="pre">10.</span></code></p></li>
</ul>
<p>We will then visualize the result.
The figure has three panels:</p>
<ul class="simple">
<li><p>the top panel is the sinusoidal input, <span class="math notranslate nohighlight">\(I\)</span>,</p></li>
<li><p>the middle panel is the estimate membrane potential <span class="math notranslate nohighlight">\(V_k\)</span>. To illustrate a spike, <span class="math notranslate nohighlight">\(V_k\)</span> is set to <span class="math notranslate nohighlight">\(0\)</span> and then reset,</p></li>
<li><p>the bottom panel is the raster plot with each dot indicating a spike.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    I: Input</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    Spike: Spike count</span>
<span class="sd">    Spike_time: Spike times</span>
<span class="sd">    V: membrane potential esitmated by the Euler method</span>
<span class="sd">  """</span>

  <span class="n">Spike</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tau_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">R_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">t_isi</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">V_reset</span> <span class="o">=</span> <span class="n">E_L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">75</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="n">V_reset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">V_th</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
  <span class="n">Spike_time</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1">#######################################################################</span>
    <span class="c1">## TODO for students: calculate the estimate solution of V at t[i+1]</span>
    <span class="c1">## Complete line of codes for dV and remove</span>
    <span class="c1">## Run the code in Section 5.1 or 5.2 to see the output!</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: calculate the estimate solution of V at t[i+1]"</span><span class="p">)</span>
    <span class="c1">########################################################################</span>

    <span class="n">dV</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dV</span>

    <span class="c1"># Discontinuity for Spike</span>
    <span class="k">if</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">V_th</span><span class="p">:</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">t_isi</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
      <span class="n">Spike</span> <span class="o">=</span> <span class="n">Spike</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">Spike_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span>

<span class="c1"># Set up time step and current</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

<span class="c1"># Model integrate and fire neuron</span>
<span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Spike_time</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="k">def</span> <span class="nf">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    I: Input</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    Spike: Spike count</span>
<span class="sd">    Spike_time: Spike times</span>
<span class="sd">    V: membrane potential esitmated by the Euler method</span>
<span class="sd">  """</span>

  <span class="n">Spike</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tau_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">R_m</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">t_isi</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">V_reset</span> <span class="o">=</span> <span class="n">E_L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">75</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="n">V_reset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">V_th</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
  <span class="n">Spike_time</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dV</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_L</span><span class="p">)</span> <span class="o">+</span> <span class="n">R_m</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span> <span class="n">tau_m</span>
    <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dV</span>

    <span class="c1"># Discontinuity for Spike</span>
    <span class="k">if</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">V_th</span><span class="p">:</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">t_isi</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
      <span class="n">Spike</span> <span class="o">=</span> <span class="n">Spike</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">Spike_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Spike_time</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span>

<span class="c1"># Set up time step and current</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

<span class="c1"># Model integrate and fire neuron</span>
<span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Spike_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As electrophysiologists normally listen to spikes when conducting experiments,  listen to the music of the LIF neuron below. Note: this does not work on all browsers so just move on if you can’t hear the audio.</p>
<p><em>Execute this cell to visualize the LIF for sinusoidal input</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute this cell to visualize the LIF for sinusoidal input*</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">Spike</span><span class="p">,</span> <span class="n">Spike_time</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Euler_Integrate_and_Fire</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">plot_IF</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Spike_time</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-systems-of-differential-equations">
<h1>Section 3: Systems of differential equations<a class="headerlink" href="#section-3-systems-of-differential-equations" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 34 min</em></p>
<div class="section" id="video-4-systems-of-differential-equations">
<h2>Video 4: Systems of differential equations<a class="headerlink" href="#video-4-systems-of-differential-equations" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="section-3-1-using-euler-to-approximate-a-simple-system">
<h2>Section 3.1: Using Euler to approximate a simple system<a class="headerlink" href="#section-3-1-using-euler-to-approximate-a-simple-system" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 40 min</em></p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>To get to grips with solving a system of differential equations using the Euler method, we will simplify the Wilson Cowan model, a set of equations that will be explored in more detail in the Dynamical Systems day.
Looking at systems of differential equations will also allow us to introduce the concept of a phase-plane plot which is a method of investigating how different processes interact.</p>
<p>In the previous section we looked at the LIF model for a single neuron. We now model a collection of neurons using a differential equation which describes the firing rate of a population of neurons.
We will model the firing rate <span class="math notranslate nohighlight">\(r\)</span> of two types of populations of neurons which interact, the excitation population firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and inhibition population firing rate <span class="math notranslate nohighlight">\(r_I\)</span>. These firing rates of neurons regulate each other by weighted connections <span class="math notranslate nohighlight">\(w\)</span>. The directed graph below illustrates this.</p>
<p>Our system of differential equations is a linear version of the Wilson Cowan model. Consider the equations,</p>
<div class="amsmath math notranslate nohighlight" id="equation-becf89f7-9f81-4def-b7c6-c961a6e31a82">
<span class="eqno">(86)<a class="headerlink" href="#equation-becf89f7-9f81-4def-b7c6-c961a6e31a82" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= w_{EE}r_E+w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;= w_{IE}r_E+w_{II}r_I
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(r_E(t)\)</span> represents the average activation (or firing rate) of the excitatory population at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the activation (or firing rate) of the inhibitory population. The parameters <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> control the timescales of the dynamics of each population. Connection strengths are given by: <span class="math notranslate nohighlight">\(w_{EE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{EI}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{IE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> I), and <span class="math notranslate nohighlight">\(w_{II}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> I). The terms <span class="math notranslate nohighlight">\(w_{EI}\)</span> and <span class="math notranslate nohighlight">\(w_{IE}\)</span> represent connections from inhibitory to excitatory population and vice versa, respectively.</p>
<p>To start we will further simplify the linear system of equations by setting <span class="math notranslate nohighlight">\(w_{EE}\)</span> and <span class="math notranslate nohighlight">\(w_{II}\)</span> to zero, we now have the equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-cfabeb9b-ed08-45b6-b783-d23481be36c1">
<span class="eqno">(87)<a class="headerlink" href="#equation-cfabeb9b-ed08-45b6-b783-d23481be36c1" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;= w_{IE}r_E, \qquad (1)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_E=100\)</span> and <span class="math notranslate nohighlight">\(\tau_I=120\)</span>, no internal connection <span class="math notranslate nohighlight">\(w_{EE}=w_{II}=0\)</span>, and <span class="math notranslate nohighlight">\(w_{EI}=-1\)</span> and <span class="math notranslate nohighlight">\(w_{IE}=1\)</span>,
with the initial conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-62da05e6-fc51-43de-bc64-58ac3bba010e">
<span class="eqno">(88)<a class="headerlink" href="#equation-62da05e6-fc51-43de-bc64-58ac3bba010e" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E(0)=30, \\ 
r_I(0)=20.
\end{align}\]</div>
<p>The solution can be approximated using the Euler method such that we have the difference equations:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{r_E[k+1]}-\color{green}{r_E[k]}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{EI}}\color{green}{r_I[k]}}{\color{blue}{\tau_E}}\big),\\
\frac{\color{red}{r_I[k+1]}-\color{green}{r_I[k]}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{IE}}\color{green}{r_E[k]}}{\color{blue}{\tau_I}}\big),\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_E[k]\)</span> and <span class="math notranslate nohighlight">\(r_I[k]\)</span> are the numerical estimates of the firing rate of the excitation population <span class="math notranslate nohighlight">\(r_E(t[k])\)</span> and inhibition population <span class="math notranslate nohighlight">\(r_I(t[k])\)</span> and <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time-step.</p>
<p>Re-arranging the equation such that all the known terms are on the right gives:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{r_E[k+1]}&amp;=\color{green}{r_E[k]}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{EI}}\color{green}{r_I[k]}}{\color{blue}{\tau_E}}\big),\\
\color{red}{r_I[k+1]}&amp;=\color{green}{r_I[k]}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{IE}}\color{green}{r_E[k]}}{\color{blue}{\tau_I}}\big),\\
&amp;\text{ for  } k=0, \cdots , n-1,\\\\
r_E[0]&amp;=30,\\
r_I[0]&amp;=20.\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{r_E[k+1]}\)</span> and  <span class="math notranslate nohighlight">\(\color{red}{r_I[k+1]}\)</span> are unknown, <span class="math notranslate nohighlight">\(\color{green}{r_E[k]} \)</span> and  <span class="math notranslate nohighlight">\(\color{green}{r_I[k]} \)</span> are known, <span class="math notranslate nohighlight">\(\color{blue}{w_{EI}}=-1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{IE}}=1\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_E}=100ms\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_I}=120ms\)</span>  are known parameters and <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}=0.01ms\)</span> is a chosen time-step.</p>
</details>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D4_Calculus/static/Linear_Wilson.png"/>
</figure><div class="section" id="coding-exercise-3-1-euler-on-a-simple-system">
<h3>Coding Exercise 3.1: Euler on a Simple System<a class="headerlink" href="#coding-exercise-3-1-euler-on-a-simple-system" title="Permalink to this headline">¶</a></h3>
<p>Our difference equations are:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{r_E[k+1]}&amp;=\color{green}{r_E[k]}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{EI}}\color{green}{r_I[k]}}{\color{blue}{\tau_E}}\big),\\
\color{red}{r_I[k+1]}&amp;=\color{green}{r_I[k]}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{IE}}\color{green}{r_E[k]}}{\color{blue}{\tau_I}}\big),\\
&amp;\text{ for  } k=0, \cdots , n-1,\\\\
r_E[0]&amp;=30,\\
r_I[0]&amp;=20.\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{r_E[k+1]}\)</span> and  <span class="math notranslate nohighlight">\(\color{red}{r_I[k+1]}\)</span> are unknown, <span class="math notranslate nohighlight">\(\color{green}{r_E[k]} \)</span> and  <span class="math notranslate nohighlight">\(\color{green}{r_I[k]} \)</span> are known, <span class="math notranslate nohighlight">\(\color{blue}{w_{EI}}=-1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{IE}}=1\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_E}=100ms\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_I}=120ms\)</span>  are known parameters and <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}=0.01ms\)</span> is a chosen time-step.
<strong>Code the difference equations to estimate <span class="math notranslate nohighlight">\(r_{E}\)</span> and <span class="math notranslate nohighlight">\(r_{I}\)</span></strong>.</p>
<p>Note that the equations have to estimated in the same <code class="docutils literal notranslate"><span class="pre">for</span></code> loop as they depend on each other.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    time: time</span>
<span class="sd">  dt  : time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    r_E : Excitation Firing Rate</span>
<span class="sd">    r_I : Inhibition Firing Rate</span>

<span class="sd">  """</span>

  <span class="c1"># Set up parameters</span>
  <span class="n">tau_E</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">tau_I</span> <span class="o">=</span> <span class="mi">120</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">r_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
  <span class="n">r_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

  <span class="c1">#######################################################################</span>
  <span class="c1">## TODO for students: calculate the estimate solutions of r_E and r_I at t[i+1]</span>
  <span class="c1">## Complete line of codes for dr_E and dr_I and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: calculate the estimate solutions of r_E and r_I at t[i+1]"</span><span class="p">)</span>
  <span class="c1">########################################################################</span>

  <span class="c1"># Loop over time steps</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Estimate r_e</span>
    <span class="n">dr_E</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_E</span>

    <span class="c1"># Estimate r_i</span>
    <span class="n">dr_I</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_I</span>

  <span class="k">return</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span>

<span class="c1"># Set up dt, t</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Run Euler method</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span> <span class="o">=</span> <span class="n">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="k">def</span> <span class="nf">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    time: time</span>
<span class="sd">  dt  : time-step</span>
<span class="sd">  Returns:</span>
<span class="sd">    r_E : Excitation Firing Rate</span>
<span class="sd">    r_I : Inhibition Firing Rate</span>

<span class="sd">  """</span>

  <span class="c1"># Set up parameters</span>
  <span class="n">tau_E</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">tau_I</span> <span class="o">=</span> <span class="mi">120</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">r_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
  <span class="n">r_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>

  <span class="c1"># Loop over time steps</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Estimate r_e</span>
    <span class="n">dr_E</span> <span class="o">=</span> <span class="o">-</span><span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">tau_E</span>
    <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_E</span>

    <span class="c1"># Estimate r_i</span>
    <span class="n">dr_I</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">tau_I</span>
    <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dr_I</span>

  <span class="k">return</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span>

<span class="c1"># Set up dt, t</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Run Euler method</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span> <span class="o">=</span> <span class="n">Euler_Simple_Linear_System</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="think-3-1-simple-euler-solution-to-the-wilson-cowan-model">
<h3>Think! 3.1: Simple Euler solution to the Wilson Cowan model<a class="headerlink" href="#think-3-1-simple-euler-solution-to-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Is the simulation biologically plausible?</p></li>
<li><p>What is the effect of combined excitation and inhibition?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">  1. The simulation is not biologically plausible as there are negative firing</span>
<span class="sd">  rates but a mathematician could just say that it is firing rate relative to</span>
<span class="sd">  baseline.</span>
<span class="sd">  2. Excitation and inhibition creates an oscillation.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-2-phase-plane-plot-and-nullcline">
<h2>Section 3.2: Phase Plane Plot and Nullcline<a class="headerlink" href="#section-3-2-phase-plane-plot-and-nullcline" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 50 min</em></p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>When there are two differential equations describing the interaction of two processes like excitation <span class="math notranslate nohighlight">\(r_{E}\)</span> and inhibition <span class="math notranslate nohighlight">\(r_{I}\)</span> that are  dependent on each other they can be plotted as a function of each other, which is known as a phase plane plot. The phase plane plot can give insight give insight into the state of the system but more about that later in Neuromatch Academy.</p>
<p>In the animated figure below, the panel of the left shows the excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and the inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span> as a function of time. The panel on the right hand side is the phase plane plot which shows the inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span> as a function of excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span>.</p>
<p>An addition to the phase plane plot are the “nullcline”. These lines plot when the rate of change <span class="math notranslate nohighlight">\(\frac{d}{dt}\)</span> of the variables is equal to <span class="math notranslate nohighlight">\(0\)</span>. We saw a variation of this for a single differential equation in the differential equation tutorial.</p>
<p>As we have two differential equations we set <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0\)</span> which gives the equations,</p>
<div class="amsmath math notranslate nohighlight" id="equation-43015461-0f53-4499-a252-e6672bdb71a6">
<span class="eqno">(89)<a class="headerlink" href="#equation-43015461-0f53-4499-a252-e6672bdb71a6" title="Permalink to this equation">¶</a></span>\[\begin{align}
0&amp;= w_{EI}r_I, \\
0&amp;= w_{IE}r_E,\\
\end{align}\]</div>
<p>these are a unique example as they are a vertical and horizontal line. Where the lines cross is the stable point which the <span class="math notranslate nohighlight">\(r_E(t)\)</span> excitatory population and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the inhibitory population orbit around.</p>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D4_Calculus/static/E_I.gif"/>
</figure><div class="section" id="think-6-1-discuss-the-plots">
<h3>Think! 6.1: Discuss the Plots<a class="headerlink" href="#think-6-1-discuss-the-plots" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Which representation is more intuitive (and useful), the time plot or the phase plane plot?</p></li>
<li><p>Why do we only see one circle?</p></li>
<li><p>What do the quadrants represent?</p></li>
</ol>
<p>Execute the code to plot the solution to the system</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute the code to plot the solution to the system</span>
<span class="n">plot_rErI_Simple</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">  1. Personal preference: both have their benefits</span>
<span class="sd">  2. The solution is stable.</span>
<span class="sd">  3. The quadrants are:</span>
<span class="sd">    - Top right positive derivative for inhibition and  negative for excitation (r_I increases, r_E decreases)</span>
<span class="sd">    - top left negative derivative for both inhibition and excitation (r_I decrease, r_E decrease)</span>
<span class="sd">    - bottom left negative derivative for inhibition and  positive for excitation (r_I decrease, r_E increase)</span>
<span class="sd">    - bottom right positive derivative for inhibition and excitation (r_I increase, r_E increase)</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</details></div>
<div class="section" id="section-3-3-adding-internal-connections">
<h2>Section 3.3: Adding internal connections<a class="headerlink" href="#section-3-3-adding-internal-connections" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 57 min</em></p>
<p>Building up the equations in the previous section we re-introduce internal connections <span class="math notranslate nohighlight">\(w_{EE}\)</span>, <span class="math notranslate nohighlight">\(w_{II}\)</span>. The two coupled differential equations, each representing the dynamics of the excitatory or inhibitory population are now:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6eeae1f5-a629-4f75-bdfb-29cca7574c52">
<span class="eqno">(90)<a class="headerlink" href="#equation-6eeae1f5-a629-4f75-bdfb-29cca7574c52" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;=w_{EE}r_E +w_{EI}r_I, \\
\tau_I \frac{dr_I}{dt} &amp;=w_{IE}r_E +w_{II}r_I ,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_E=100\)</span> and <span class="math notranslate nohighlight">\(\tau_I=120\)</span>, <span class="math notranslate nohighlight">\(w_{EE}=1\)</span> and <span class="math notranslate nohighlight">\(w_{II}=-1\)</span>, and <span class="math notranslate nohighlight">\(w_{EI}=-5\)</span> and <span class="math notranslate nohighlight">\(w_{IE}=0.6\)</span>,
with the initial conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-99dad232-87db-4854-9bb7-9fc23221b189">
<span class="eqno">(91)<a class="headerlink" href="#equation-99dad232-87db-4854-9bb7-9fc23221b189" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E(0)=30, \\ 
r_I(0)=20.
\end{align}\]</div>
<p>The solutions can be approximated using the Euler method such that the equations become:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\color{red}{rE_{k+1}}-\color{green}{rE_k}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{EE}}\color{green}{rE_k}+\color{blue}{w_{EI}}\color{green}{rI_k}}{\color{blue}{\tau_E}}\big),\\
\frac{\color{red}{rI_{k+1}}-\color{green}{rI_k}}{\color{blue}{\Delta t}}&amp;=\big(\frac{\color{blue}{w_{II}}\color{green}{rI_k}+\color{blue}{w_{IE}}\color{green}{rE_k}}{\color{blue}{\tau_I}}\big),\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_E[k]\)</span> and <span class="math notranslate nohighlight">\(r_I[k]\)</span> are the numerical estimates of the firing rate of the excitation population <span class="math notranslate nohighlight">\(r_E(t_k)\)</span> and inhibition population <span class="math notranslate nohighlight">\(r_I(t_K)\)</span> and <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time-step.</p>
<p>Re-arranging the equation such that all the known terms are on the right gives:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{rE_{k+1}}&amp;=\color{green}{rE_k}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{EE}}\color{green}{rE_k}+\color{blue}{w_{EI}}\color{green}{rI_k}}{\color{blue}{\tau_E}}\big),\\
\color{red}{rI_{k+1}}&amp;=\color{green}{rI_k}+\color{blue}{\Delta t}\big(\frac{\color{blue}{w_{II}}\color{green}{rI_k}+\color{blue}{w_{IE}}\color{green}{rE_k}}{\color{blue}{\tau_I}}\big),\\
&amp;\text{ for } k=0, \cdots n-1,\\\\
rE_0&amp;=30,\\
rI_0&amp;=20.\\
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\color{red}{rE_{k+1}}\)</span> and  <span class="math notranslate nohighlight">\(\color{red}{rI_{k+1}}\)</span> are unknown, <span class="math notranslate nohighlight">\(\color{green}{rE_{k}} \)</span> and  <span class="math notranslate nohighlight">\(\color{green}{rI_{k}} \)</span> are known, <span class="math notranslate nohighlight">\(\color{blue}{w_{EI}}=-1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{IE}}=1\)</span>, <span class="math notranslate nohighlight">\(\color{blue}{w_{EE}}=1\)</span>,  <span class="math notranslate nohighlight">\(\color{blue}{w_{II}}=-1\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_E}=100\)</span> and <span class="math notranslate nohighlight">\(\color{blue}{\tau_I}=120\)</span>  are known parameters and <span class="math notranslate nohighlight">\(\color{blue}{\Delta t}=0.1\)</span> is a chosen time-step.</p>
<div class="section" id="think-3-3-oscillations">
<h3>Think! 3.3: Oscillations<a class="headerlink" href="#think-3-3-oscillations" title="Permalink to this headline">¶</a></h3>
<p>The code below implements and visualizes the linear Wilson-Cowan model.</p>
<ol class="simple">
<li><p>What will happen to the oscillations if the time period is extended?</p></li>
<li><p>How would you control or predict the oscillations?</p></li>
</ol>
<p><em>Execute this cell to visualize the Linear Willson-Cowan</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute this cell to visualize the Linear Willson-Cowan*</span>

<span class="k">def</span> <span class="nf">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w_EE</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">    w_EE: Excitation to excitation weight</span>
<span class="sd">  Returns:</span>
<span class="sd">    r_E: Excitation Firing Rate</span>
<span class="sd">    r_I: Inhibition Firing Rate</span>
<span class="sd">    N_Er: Nullclines for drE/dt=0</span>
<span class="sd">    N_Ir: Nullclines for drI/dt=0</span>
<span class="sd">  """</span>

  <span class="n">tau_E</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">tau_I</span> <span class="o">=</span> <span class="mi">120</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">r_I</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">r_E</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">w_EI</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
  <span class="n">w_IE</span> <span class="o">=</span> <span class="mf">0.6</span>
  <span class="n">w_II</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Calculate the derivatives of the E and I populations</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_EI</span><span class="o">*</span><span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">w_EE</span><span class="o">*</span><span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span> <span class="n">tau_E</span>
    <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">drE</span>

    <span class="n">drI</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_II</span><span class="o">*</span><span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">w_IE</span><span class="o">*</span><span class="n">r_E</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span> <span class="n">tau_I</span>
    <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">drI</span>


  <span class="n">N_Er</span> <span class="o">=</span> <span class="o">-</span><span class="n">w_EE</span> <span class="o">/</span> <span class="n">w_EI</span><span class="o">*</span><span class="n">r_E</span>
  <span class="n">N_Ir</span> <span class="o">=</span> <span class="o">-</span><span class="n">w_IE</span> <span class="o">/</span> <span class="n">w_II</span><span class="o">*</span><span class="n">r_E</span>

  <span class="k">return</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span>


<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">plot_rErI</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1. The oscillations start getting larger and larger which could in the end become uncontrollable</span>
<span class="sd">2. Looking at the shape of the spiral</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-4-phase-plane-and-nullclines-part-2">
<h2>Section 3.4 Phase Plane and Nullclines Part 2<a class="headerlink" href="#section-3-4-phase-plane-and-nullclines-part-2" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 62 min</em></p>
<p>Like before, we have two differential equations so we can plot the results on a phase plane. We can also calculate the Nullclines when we set <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0\)</span> which gives,</p>
<div class="amsmath math notranslate nohighlight" id="equation-39357522-4830-4ab5-b7ef-47655319fd9b">
<span class="eqno">(92)<a class="headerlink" href="#equation-39357522-4830-4ab5-b7ef-47655319fd9b" title="Permalink to this equation">¶</a></span>\[\begin{align}
0&amp;= w_{EE}r_E+w_{EI}r_I, \\
0&amp;= w_{IE}r_E+w_{II}r_I,
\end{align}\]</div>
<p>re-arranging as two lines</p>
<div class="amsmath math notranslate nohighlight" id="equation-152ff2c1-8c52-4a33-8a91-fd63c4f5dab9">
<span class="eqno">(93)<a class="headerlink" href="#equation-152ff2c1-8c52-4a33-8a91-fd63c4f5dab9" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_I&amp;= -\frac{w_{EE}}{w_{EI}}r_E, \\
r_I&amp;= -\frac{w_{IE}}{w_{II}}r_E, 
\end{align}\]</div>
<p>which crosses at the stable point.</p>
<p>The panel on the left shows excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and inhibition firing rate  <span class="math notranslate nohighlight">\(r_I\)</span> as a function of time. On the right side the phase plane plot shows inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span> as a function of excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> with the Nullclines for <span class="math notranslate nohighlight">\(\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\frac{dr_I}{dt}=0.\)</span></p>
<p><em>Run this cell to visualize the phase plane</em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Run this cell to visualize the phase plane*</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-3-4-a-small-change-changes-everything">
<h3>Interactive Demo 3.4: A small change changes everything<a class="headerlink" href="#interactive-demo-3-4-a-small-change-changes-everything" title="Permalink to this headline">¶</a></h3>
<p>We will illustrate that even changing one parameter in a system of differential equations can have a large impact on the solutions of the excitation firing rate <span class="math notranslate nohighlight">\(r_E\)</span> and inhibition firing rate <span class="math notranslate nohighlight">\(r_I\)</span>.
Interact with the widget below to change the size of <span class="math notranslate nohighlight">\(w_{EE}\)</span>.</p>
<p>Take note of:</p>
<ol class="simple">
<li><p>How the solution changes for positive and negative of <span class="math notranslate nohighlight">\(w_{EE}\)</span>. Pay close attention to the axis.</p></li>
<li><p>How would you maintain a stable oscillation.</p></li>
</ol>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">w_EE</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">w_EE</span><span class="p">):</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># time-step</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
  <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span> <span class="o">=</span> <span class="n">Euler_Linear_System_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w_EE</span><span class="p">)</span>
  <span class="n">plot_rErI_Matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r_E</span><span class="p">,</span> <span class="n">r_I</span><span class="p">,</span> <span class="n">N_Er</span><span class="p">,</span> <span class="n">N_Ir</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 70 minutes</em></p>
<div class="section" id="video-5-summary">
<h2>Video 5: Summary<a class="headerlink" href="#video-5-summary" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>Using pretty much the formula for the slope of a line, the solution of differential equation can be estimated with reasonable accuracy.
This will be much more relevant when dealing with more complicated (non-linear) differential equations where there is no known exact solution.</p>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="links-to-neuromatch-days">
<h1>Links to Neuromatch Days<a class="headerlink" href="#links-to-neuromatch-days" title="Permalink to this headline">¶</a></h1>
<p>The Euler method is used to estimate differential equations in a number of different Neuromatch days:</p>
<ul class="simple">
<li><p>The LIF model is discussed in more details in Model Types (Week 1 Day 1) and  Biological Neuron Models (Week 2 Day 3).</p></li>
<li><p>Drift Diffusion model which is a differential equation for decision making is discussed in Linear Systems (Week 2 Day 2).</p></li>
<li><p>Phase-plane plots are discussed in Linear Systems (Week 2 Day 2) and Dynamic Networks (Week 2 Day 4).</p></li>
<li><p>The Wilson-Cowan model is discussed in Dynamic Networks (Week 2 Day 4).</p></li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Lotka, A. L, (1920)   Analytical note on certain rhythmic  relations inorganic  systems.Proceedings of the National Academy of Sciences,6(7):410–415,1920.</p></li>
<li><p>Brunel N, van Rossum MC. Lapicque’s 1907 paper: from frogs to integrate-and-fire. Biol Cybern. 2007 Dec;97(5-6):337-9. doi: 10.1007/s00422-007-0190-0. Epub 2007 Oct 30. PMID: 17968583.</p></li>
</ol>
</div>
<div class="section" id="bibliography">
<h1>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Dayan, P., &amp; Abbott, L. F. (2001). Theoretical neuroscience: computational and mathematical modeling of neural systems. Computational Neuroscience Series.</p></li>
<li><p>Strogatz, S. Nonlinear dynamics and chaos: with applications to physics, biology, chemistry, and engineering (studies in nonlinearity), Westview Press; 2 edition (29 July 2014)</p></li>
</ol>
<div class="section" id="supplemental-popular-reading-list">
<h2>Supplemental Popular Reading List<a class="headerlink" href="#supplemental-popular-reading-list" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Lindsay, G. (2021). Models of the Mind: How Physics, Engineering and Mathematics Have Shaped Our Understanding of the Brain. Bloomsbury Publishing.</p></li>
<li><p>Strogatz, S. (2004). Sync: The emerging science of spontaneous order. Penguin UK.</p></li>
</ol>
</div>
<div class="section" id="popular-podcast">
<h2>Popular Podcast<a class="headerlink" href="#popular-podcast" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Strogatz, S. (Host). (2020), Joy of X  https://www.quantamagazine.org/tag/the-joy-of-x/ Quanta Magazine</p></li>
</ol>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="bonus">
<h1>Bonus<a class="headerlink" href="#bonus" title="Permalink to this headline">¶</a></h1>
<hr class="docutils"/>
<div class="section" id="bonus-section-1-the-4th-order-runge-kutta">
<h2>Bonus Section 1: The 4th Order Runge Kutta<a class="headerlink" href="#bonus-section-1-the-4th-order-runge-kutta" title="Permalink to this headline">¶</a></h2>
<p>Another popular numerical method to estimate the solution of differential equations of the general form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ad2b7612-867f-451b-a74a-e1e91b1e234e">
<span class="eqno">(94)<a class="headerlink" href="#equation-ad2b7612-867f-451b-a74a-e1e91b1e234e" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{d}{dt}y=f(t,y)
\end{align}\]</div>
<p>is the 4th Order Runge Kutta:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1620ca2b-0e5a-4ef6-8f8d-a2f3dbfb7801">
<span class="eqno">(95)<a class="headerlink" href="#equation-1620ca2b-0e5a-4ef6-8f8d-a2f3dbfb7801" title="Permalink to this equation">¶</a></span>\[\begin{align}
k_1 &amp;= f(t_k,y_k)\\
k_2 &amp;= f(t_k+\frac{\Delta t}{2},y_k+\frac{\Delta t}{2}k_1)\\
k_3 &amp;= f(t_k+\frac{\Delta t}{2},y_k+\frac{\Delta t}{2}k_2)\\
k_4 &amp;= f(t_k+\Delta t,y_k+\Delta tk_3)\\
y_{k+1} &amp;= y_{k}+\frac{\Delta t}{6}(k_1+2k_2+2k_3+k_4)\\
\end{align}\]</div>
<p>for <span class="math notranslate nohighlight">\(k=0,1,\cdots,n-1\)</span>,
which is more accurate than the Euler method.</p>
<p>Given the population differential equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d}{dt}\,p(t) &amp;= 0.3 p(t),\\
p(t_0=1)&amp;=e^{0.3}\quad \text{Initial Condition},
\end{align*}\]</div>
<p>the 4th Runge Kutta difference equation is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
k_1&amp;=0.3\color{green}{p[k]},\\
k_2&amp;=0.3(\color{green}{p[k]}+\frac{\Delta t}{2}k_1),\\
k_3&amp;=0.3(\color{green}{p[k]}+\frac{\Delta t}{2}k_2),\\
k_4&amp;=0.3(\color{green}{p[k]}+k_3),\\
\color{red}{p_{k[k]}}&amp;=\color{green}{p[k]}+\frac{\color{blue}{\Delta t}}{6}( \color{green}{k_1+2k_2+2k_3+k_4})\\
\end{align*}\]</div>
<p>for <span class="math notranslate nohighlight">\(k=0,1,\cdots 4\)</span> to estimate the population for <span class="math notranslate nohighlight">\(\Delta t=0.5\)</span>.</p>
<p>The code is implemented below. Note how much more accurate the 4th Order Runge Kutta (yellow) is compared to the Euler Method (blue). The 4th order Runge Kutta is of order 4 which means that if you half the time-step <span class="math notranslate nohighlight">\(\Delta t\)</span> the error decreases by a factor of <span class="math notranslate nohighlight">\(\Delta t^4\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute this cell to show the difference between the Runge Kutta Method and the Euler Method*</span>


<span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">t_fine</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">+</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">pRK4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">pRK4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Initial Condition</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Exact Solution'</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">dp</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span> <span class="c1"># Euler</span>
      <span class="n">k1</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="n">k2</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>
      <span class="n">k3</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k2</span><span class="p">)</span>
      <span class="n">k4</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">k3</span><span class="p">)</span>
      <span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pRK4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_fine</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">t_fine</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Exact'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="s1">':ro'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Euler Estimate'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pRK4</span><span class="p">,</span><span class="s1">':co'</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s1">'4th Order Runge Kutta Estimate'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Population (millions)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (years)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">RK4</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Bonus Reference 1: A full course on numerical methods in Python</strong></p>
<p>For a full course on Numerical Methods for differential Equations you can look here https://github.com/john-s-butler-dit/Numerical-Analysis-Python</p>
</div>
<hr class="docutils"/>
<div class="section" id="bonus-section-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end">
<h2>Bonus  Section 2: Neural oscillations are a start toward understanding brain activity rather than the end<a class="headerlink" href="#bonus-section-2-neural-oscillations-are-a-start-toward-understanding-brain-activity-rather-than-the-end" title="Permalink to this headline">¶</a></h2>
<p>The differential equations we have discussed above are all to simulate neuronal processes, another way differential equations can be used is to motivate experimental findings.</p>
<p>A great deal of experimental and neurophysiological studies have investigated whether the brain oscillates and/or entrain to a stimulus.
An issue with these studies is that there is not a consistent  definition of what constitutes an oscillation. Right now it is a bit of I know one when I see one problem.</p>
<p>In an essay from May 2021 in PLOS Biology by Keith Dowling (a past Neuromatch TA) and M. Florencia Assaneo discussed a mathematical way of thinking about what should be expected experimentally  when studying  oscillations. In the essay they propose that instead of thinking about the brain we should look at this question from the mathematical side, to motivate what can be defined as an oscillation.</p>
<p>To do this they used Stuart–Landau equations, which is a system of differential equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-c0b24db6-e2d7-4d6e-98ec-7e7118a92ef4">
<span class="eqno">(96)<a class="headerlink" href="#equation-c0b24db6-e2d7-4d6e-98ec-7e7118a92ef4" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dx}{dt} &amp;= \lambda x-\omega y -\gamma (x^2+y^2)x+s\\
\frac{dy}{dt} &amp;= \lambda y+\omega x -\gamma (x^2+y^2)y 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is input to the system, and <span class="math notranslate nohighlight">\(\lambda\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are parameters.</p>
<p>The Stuart–Landau equations are a well described system of non-linear differential equations that generate oscillations. For their purpose,  Dowling and  Assaneo used the equations to motivate what experimenters should expect when conducting experiments looking for oscillations.
In their paper, using the Stuart–Landau equations, they outline</p>
<ul class="simple">
<li><p>“What is an oscillator?”</p></li>
<li><p>“What an oscillator is not”</p></li>
<li><p>“Not all that oscillates is an oscillator”</p></li>
<li><p>“Not all oscillators are alike.”</p></li>
</ul>
<p>The Euler form of the Stuart–Landau system of equations is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\color{red}{x_{k+1}}&amp;=\color{green}{x_k}+\color{blue}{\Delta t}\big(\lambda \color{green}{x_k}-\omega \color{green}{y_k} -\gamma (\color{green}{x_k}^2+\color{green}{y_k}^2)\color{green}{x_k}+s\big),\\
\color{red}{y_{k+1}}&amp;=\color{green}{y_k}+\color{blue}{\Delta t}\big(\lambda \color{green}{y_k}+\omega \color{green}{x_k} -\gamma (\color{green}{x_k}^2+\color{green}{y_k}^2)\color{green}{y_k} \big),\\
&amp;\text{ for } k=0, \cdots n-1,\\
x_0&amp;=1,\\
y_0&amp;=1,\\
\end{align*}\]</div>
<p>with <span class="math notranslate nohighlight">\( \Delta t=0.1/1000\)</span> ms.</p>
<div class="section" id="helper-functions">
<h3>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>
<span class="k">def</span> <span class="nf">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      t  : time</span>
<span class="sd">      x  : x</span>
<span class="sd">      y  : y</span>
<span class="sd">      s : input</span>
<span class="sd">    Returns:</span>
<span class="sd">      figure with two panels</span>
<span class="sd">      top panel: Input as a function of time</span>
<span class="sd">      bottom panel: x</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># PLOT OF INPUT</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$s$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">)</span>
    <span class="c1">#plt.ylim((2,4))</span>

    <span class="c1"># PLOT OF ACTIVITY</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span> <span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'x'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'t'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">'go'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'x'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'y'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">lamba</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    I: Input</span>
<span class="sd">    time: time</span>
<span class="sd">    dt: time-step</span>
<span class="sd">  """</span>

  <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
  <span class="n">omega</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">lamba</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dx</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">lamba</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">dy</span>

  <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-2-1-what-is-an-oscillator">
<h3>Bonus 2.1: What is an Oscillator?<a class="headerlink" href="#bonus-2-1-what-is-an-oscillator" title="Permalink to this headline">¶</a></h3>
<p>Doelling &amp; Assaneo (2021), using the Stuart–Landau system, show different possible states of an oscillator by manipulating the <span class="math notranslate nohighlight">\(\lambda\)</span> term in the equation.
From the paper: “this qualitative change in behavior takes place at λ = 0: For λ &lt; 0, the system decays to a stable equilibrium, while for λ &gt; 0, it keeps oscillating.”</p>
<p>This illustrates an oscillations does not have to maintain all the time, so experimentally we should not expect perfectly maintained oscillations. We see this all the time in <span class="math notranslate nohighlight">\(\alpha\)</span> band oscillations in EEG the oscillations come and go.</p>
<div class="section" id="interactive-demo-bonus-2-1">
<h4>Interactive Demo Bonus 2.1<a class="headerlink" href="#interactive-demo-bonus-2-1" title="Permalink to this headline">¶</a></h4>
<p>The plot below shows the estimated solution of the Stuart–Landau system with a base frequency <span class="math notranslate nohighlight">\(\omega\)</span> set to <span class="math notranslate nohighlight">\(4\times 2\pi\)</span>, <span class="math notranslate nohighlight">\(\gamma=1\)</span> and <span class="math notranslate nohighlight">\(k=25\)</span> over 3 seconds. The input to the system <span class="math notranslate nohighlight">\(s(t)\)</span> is plotted in the top panel, <span class="math notranslate nohighlight">\(x\)</span> as a function of time in the the bottom panel and on the right the phase plane plot of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. You can manipulate <span class="math notranslate nohighlight">\(\lambda\)</span> to see how the oscillations change.</p>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">lamda</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">lamda</span><span class="p">):</span>
    <span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">lamda</span><span class="p">)</span>
    <span class="n">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-2-2-not-all-oscillators-are-alike">
<h3>Bonus 2.2 : Not all oscillators are alike<a class="headerlink" href="#bonus-2-2-not-all-oscillators-are-alike" title="Permalink to this headline">¶</a></h3>
<div class="section" id="interactive-demo-bonus-2-stuart-landau-system">
<h4>Interactive Demo Bonus 2: Stuart-Landau System<a class="headerlink" href="#interactive-demo-bonus-2-stuart-landau-system" title="Permalink to this headline">¶</a></h4>
<p>The plot below shows estimated solution of the Stuart–Landau system with a base frequency of 4Hz by stetting <span class="math notranslate nohighlight">\(\omega\)</span> to <span class="math notranslate nohighlight">\(4\times 2\pi\)</span>, <span class="math notranslate nohighlight">\(\lambda=1\)</span>, <span class="math notranslate nohighlight">\(\gamma=1\)</span> and <span class="math notranslate nohighlight">\(k=50\)</span> over 3 seconds the input to the system <span class="math notranslate nohighlight">\(s(t)=\sin(freq 2\pi t) \)</span> in the top panel, <span class="math notranslate nohighlight">\(x\)</span> as a function of time in the the bottom panel and on the right the phase plane plot of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>You can manipulate the frequency <span class="math notranslate nohighlight">\(freq\)</span> of the input to see how the oscillations change and for frequencies <span class="math notranslate nohighlight">\(freq\)</span> further and further from the base frequency of 4Hz the oscillations breaks down.</p>
<p>This shoes that if you have an oscillating input into an oscillator with it does not have to respond by oscillating about could even breakdown. Hence the frequency of the input oscillation is important to the system.
So if you flash something at 50Hz, for example, the visual system might not follow the signal but that does not mean the visual system is not an oscillator it might just be the wrong frequency.</p>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">freq</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">Pop_widget</span><span class="p">(</span><span class="n">freq</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Euler_Stuart_Landau</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">lamba</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plot_Stuart_Landa</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Bonus Reference 2</strong></p>
<p><a class="reference external" href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.3001234">Doelling, K. B., &amp; Assaneo, M. F. (2021). Neural oscillations are a start toward understanding brain activity rather than the end. PLoS biology, 19(5), e3001234.</a></p>
</div>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W0D4_Calculus/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W0D4_Tutorial2.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 2: Differential Equations</p>
</div>
</a>
<a class="right-next" href="W0D4_DaySummary.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Day Summary</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br/>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>