
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 3: Autoencoders applications — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="Bonus_Outro.html" rel="next" title="Outro"/>
<link href="Bonus_Tutorial2.html" rel="prev" title="Tutorial 2: Autoencoder extensions"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/Bonus_Autoencoders/instructor/Bonus_Tutorial3.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/Bonus_Autoencoders/instructor/Bonus_Tutorial3.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Autoencoders applications
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#autoencoder-applications">
     Autoencoder applications
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-applications">
     Video 1: Applications
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-download-and-prepare-mnist-dataset">
   Section 1: Download  and prepare MNIST dataset
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-download-a-pre-trained-model">
   Section 2: Download a pre-trained model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-applications-of-autoencoders">
   Section 3: Applications of autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-1-image-noise">
     Application 1 - Image noise
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#reconstructions-before-fine-tuning">
       Reconstructions before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#latent-space-before-fine-tuning">
       Latent space before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#fine-tuning-the-autoencoder-with-noisy-images">
       Fine-tuning the autoencoder with noisy images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#global-latent-space-shift">
       Global latent space shift
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-2-image-occlusion">
     Application 2 - Image occlusion
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#before-fine-tuning">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#after-fine-tuning">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-3-image-rotation">
     Application 3 - Image rotation
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
     Application 4 - What would digit “6” look like if we had never seen it before?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-1-removing-the-most-dominant-digit-classes">
       Exercise 1: Removing the most dominant digit classes
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-anns-same-but-different">
   Section 4: ANNs? Same but different!
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-wrap-up">
     Video 2: Wrap-up
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 3: Autoencoders applications</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: Autoencoders applications
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#autoencoder-applications">
     Autoencoder applications
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-applications">
     Video 1: Applications
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-download-and-prepare-mnist-dataset">
   Section 1: Download  and prepare MNIST dataset
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-download-a-pre-trained-model">
   Section 2: Download a pre-trained model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-applications-of-autoencoders">
   Section 3: Applications of autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-1-image-noise">
     Application 1 - Image noise
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#reconstructions-before-fine-tuning">
       Reconstructions before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#latent-space-before-fine-tuning">
       Latent space before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#fine-tuning-the-autoencoder-with-noisy-images">
       Fine-tuning the autoencoder with noisy images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#global-latent-space-shift">
       Global latent space shift
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-2-image-occlusion">
     Application 2 - Image occlusion
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#before-fine-tuning">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#after-fine-tuning">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-3-image-rotation">
     Application 3 - Image rotation
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Before fine-tuning
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       After fine-tuning
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
     Application 4 - What would digit “6” look like if we had never seen it before?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-1-removing-the-most-dominant-digit-classes">
       Exercise 1: Removing the most dominant digit classes
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-anns-same-but-different">
   Section 4: ANNs? Same but different!
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-wrap-up">
     Video 2: Wrap-up
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/Bonus_Autoencoders/Bonus_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/Bonus_Autoencoders/Bonus_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-3-autoencoders-applications">
<h1>Tutorial 3: Autoencoders applications<a class="headerlink" href="#tutorial-3-autoencoders-applications" title="Permalink to this headline">¶</a></h1>
<p><strong>Bonus Day: Autoencoders</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Marco Brigham and the <a class="reference external" href="https://www.ccnss.org/">CCNSS</a> team (2014-2018)</p>
<p><strong>Content reviewers:</strong> Itzel Olivos, Karen Schroeder, Karolina Stosio, Kshitij Dwivedi, Spiros Chavlis, Michael Waskom</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<div class="section" id="autoencoder-applications">
<h2>Autoencoder applications<a class="headerlink" href="#autoencoder-applications" title="Permalink to this headline">¶</a></h2>
<p>How do autoencoders with rich internal representations perform on the MNIST cognitive task?</p>
<p>How do autoencoders perceive unseen digit classes?</p>
<p>How does ANN image encoding differ from human vision?</p>
<p>We are equipped with tools and techniques to answer these questions, and hopefully, many others you may encounter in your research!</p>
<br/>
<p><img alt="MNIST cognitive task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/mnist_task.png"/></p>
<br/>
<p>In this tutorial, you will:</p>
<ul class="simple">
<li><p>Analyze how autoencoders perceive transformed data (added noise, occluded parts, and rotations), and how that evolves with short re-train sessions</p></li>
<li><p>Use autoencoders to visualize unseen digit classes</p></li>
<li><p>Understand visual encoding for fully connected ANN autoencoders</p></li>
</ul>
</div>
<div class="section" id="video-1-applications">
<h2>Video 1: Applications<a class="headerlink" href="#video-1-applications" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f37e317d830447a8988db4a9d5b79cb6"}
</script></div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p>Please execute the cell(s) below to initialize the notebook environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">ndimage</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/NMA2020/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">downloadMNIST</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Download MNIST dataset and transform it to torch.Tensor</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    x_train : training images (torch.Tensor) (60000, 28, 28)</span>
<span class="sd">    x_test  : test images (torch.Tensor) (10000, 28, 28)</span>
<span class="sd">    y_train : training labels (torch.Tensor) (60000, )</span>
<span class="sd">    y_train : test labels (torch.Tensor) (10000, )</span>
<span class="sd">  """</span>
  <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s1">'mnist_784'</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="c1"># Trunk the data</span>
  <span class="n">n_train</span> <span class="o">=</span> <span class="mi">60000</span>
  <span class="n">n_test</span> <span class="o">=</span> <span class="mi">10000</span>

  <span class="n">train_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_train</span><span class="p">)</span>
  <span class="n">test_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_train</span><span class="p">,</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">)</span>

  <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
  <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_idx</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_idx</span><span class="p">]</span>

  <span class="c1"># Transform np.ndarrays to torch.Tensor</span>
  <span class="n">x_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span>
                                        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span>
                                         <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
  <span class="n">x_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span>
                                       <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span>
                                        <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>

  <span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
  <span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

  <span class="k">return</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">init_weights_kaiming_uniform</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Initializes weights from linear PyTorch layer</span>
<span class="sd">  with kaiming uniform distribution.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="c1"># check for linear PyTorch layer</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
    <span class="c1"># initialize weights with kaiming uniform distribution</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_uniform_</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">init_weights_kaiming_normal</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Initializes weights from linear PyTorch layer</span>
<span class="sd">  with kaiming normal distribution.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="c1"># check for linear PyTorch layer</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
    <span class="c1"># initialize weights with kaiming normal distribution</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_normal_</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_layer_weights</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Retrieves learnable parameters from PyTorch layer.</span>

<span class="sd">  Args:</span>
<span class="sd">    layer (torch.Module)</span>
<span class="sd">        Pytorch layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    list with learnable parameters</span>
<span class="sd">  """</span>
  <span class="c1"># initialize output list</span>
  <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="c1"># check whether layer has learnable parameters</span>
  <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="c1"># copy numpy array representation of each set of learnable parameters</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">layer</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
      <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

  <span class="k">return</span> <span class="n">weights</span>


<span class="k">def</span> <span class="nf">eval_mse</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evaluates mean square error (MSE) between y_pred and y_true</span>

<span class="sd">  Args:</span>
<span class="sd">    y_pred (torch.Tensor)</span>
<span class="sd">        prediction samples</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">        ground truth samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    MSE(y_pred, y_true)</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>

  <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">eval_bce</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evaluates binary cross-entropy (BCE) between y_pred and y_true</span>

<span class="sd">  Args:</span>
<span class="sd">    y_pred (torch.Tensor)</span>
<span class="sd">        prediction samples</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">        ground truth samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    BCE(y_pred, y_true)</span>
<span class="sd">  """</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>

  <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_row</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots rows of images from list of iterables (iterables: list, numpy array</span>
<span class="sd">  or torch.Tensor). Also accepts single iterable.</span>
<span class="sd">  Randomly selects images in each list element if item count &gt; show_n.</span>

<span class="sd">  Args:</span>
<span class="sd">    images (iterable or list of iterables)</span>
<span class="sd">        single iterable with images, or list of iterables</span>

<span class="sd">    show_n (integer)</span>
<span class="sd">        maximum number of images per row</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image if vectorized form</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">images</span><span class="p">]</span>

  <span class="k">for</span> <span class="n">items_idx</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>

    <span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">items</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>
      <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">image_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">image_shape</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">image_idx</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>

      <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">image_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">to_s2</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Projects 3D coordinates to spherical coordinates (theta, phi) surface of</span>
<span class="sd">  unit sphere S2.</span>
<span class="sd">  theta: [0, pi]</span>
<span class="sd">  phi: [-pi, pi]</span>

<span class="sd">  Args:</span>
<span class="sd">    u (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        3D coordinates</span>

<span class="sd">  Returns:</span>
<span class="sd">    Sperical coordinates (theta, phi) on surface of unit sphere S2.</span>
<span class="sd">  """</span>

  <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>
  <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>


<span class="k">def</span> <span class="nf">to_u3</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Converts from 2D coordinates on surface of unit sphere S2 to 3D coordinates</span>
<span class="sd">  (on surface of S2), i.e. (theta, phi) ---&gt; (1, theta, phi).</span>

<span class="sd">  Args:</span>
<span class="sd">    s (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates on unit sphere S_2</span>

<span class="sd">  Returns:</span>
<span class="sd">    3D coordinates on surface of unit sphere S_2</span>
<span class="sd">  """</span>

  <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>


<span class="k">def</span> <span class="nf">xy_lim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Return arguments for plt.xlim and plt.ylim calculated from minimum</span>
<span class="sd">  and maximum of x.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        data to be plotted</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="n">x_min</span> <span class="o">=</span> <span class="n">x_min</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
  <span class="n">x_max</span> <span class="o">=</span> <span class="n">x_max</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

  <span class="k">return</span> <span class="p">[</span><span class="n">x_min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">x_min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>


<span class="k">def</span> <span class="nf">plot_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">n_row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots images reconstructed by decoder_fn from a 2D grid in</span>
<span class="sd">  latent space that is determined by minimum and maximum values in x.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D or 3D coordinates in latent space</span>

<span class="sd">    decoder_fn (integer)</span>
<span class="sd">        function returning vectorized images from 2D latent space coordinates</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">    n_row (integer)</span>
<span class="sd">        number of rows in grid</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">to_s2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">n_row</span>
  <span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_row</span><span class="p">),</span>
          <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_row</span><span class="p">)]</span>

  <span class="n">canvas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_row</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_row</span><span class="p">))</span>

  <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'gray'</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">latent_y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">latent_x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>

      <span class="n">latent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">latent_x</span><span class="p">,</span> <span class="n">latent_y</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
        <span class="n">latent</span> <span class="o">=</span> <span class="n">to_u3</span><span class="p">(</span><span class="n">latent</span><span class="p">)</span>

      <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">x_decoded</span> <span class="o">=</span> <span class="n">decoder_fn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">latent</span><span class="p">))</span>

      <span class="n">x_decoded</span> <span class="o">=</span> <span class="n">x_decoded</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">)</span>

      <span class="n">canvas</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
             <span class="n">i</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">x_decoded</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">canvas</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_latent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots digit class of each sample in 2D latent space coordinates.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    n_row (integer)</span>
<span class="sd">        number of samples</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">    fontdict (dictionary)</span>
<span class="sd">        style option for plt.text</span>

<span class="sd">    xy_labels (list)</span>
<span class="sd">        optional list with [xlabel, ylabel]</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">fontdict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'weight'</span><span class="p">:</span> <span class="s1">'bold'</span><span class="p">,</span> <span class="s1">'size'</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">to_s2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'tab10'</span><span class="p">)</span>

  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>

  <span class="k">for</span> <span class="n">my_x</span><span class="p">,</span> <span class="n">my_y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">my_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">my_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">my_y</span><span class="p">)),</span>
             <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">my_y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.</span><span class="p">),</span>
             <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span>
             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

  <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">xy_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">xy_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">'$\varphi$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\theta$'</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">),</span>
               <span class="p">[</span><span class="s1">'0'</span><span class="p">,</span> <span class="s1">'$\pi/6$'</span><span class="p">,</span> <span class="s1">'$\pi/3$'</span><span class="p">,</span> <span class="s1">'$\pi/2$'</span><span class="p">,</span>
                <span class="s1">'$2\pi/3$'</span><span class="p">,</span> <span class="s1">'$5\pi/6$'</span><span class="p">,</span> <span class="s1">'$\pi$'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span>
               <span class="p">[</span><span class="s1">'$-\pi$'</span><span class="p">,</span> <span class="s1">'$-2\pi/3$'</span><span class="p">,</span> <span class="s1">'$-\pi/3$'</span><span class="p">,</span> <span class="s1">'0'</span><span class="p">,</span>
                <span class="s1">'$\pi/3$'</span><span class="p">,</span> <span class="s1">'$2\pi/3$'</span><span class="p">,</span> <span class="s1">'$\pi$'</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">xy_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xy_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'$Z_1$'</span><span class="p">,</span> <span class="s1">'$Z_2$'</span><span class="p">]</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xy_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">xy_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">plot_latent_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Two horizontal subplots generated with encoder map and decoder grid.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    decoder_fn (integer)</span>
<span class="sd">        function returning vectorized images from 2D latent space coordinates</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">    title (string)</span>
<span class="sd">        plot title</span>

<span class="sd">    xy_labels (list)</span>
<span class="sd">        optional list with [xlabel, ylabel]</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

  <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Encoder map'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">xy_labels</span><span class="o">=</span><span class="n">xy_labels</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Decoder grid'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_generative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decoder_fn</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_latent_ab</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">selected_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After'</span><span class="p">,</span> <span class="n">show_n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Two horizontal subplots with encoder maps.</span>

<span class="sd">  Args:</span>
<span class="sd">    x1 (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        2D coordinates in latent space (left plot)</span>

<span class="sd">    x2 (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample (right plot)</span>

<span class="sd">    y (list, numpy array or torch.Tensor of floats)</span>
<span class="sd">        digit class of each sample</span>

<span class="sd">    selected_idx (list of integers)</span>
<span class="sd">        indexes of elements to be plotted</span>

<span class="sd">    show_n (integer)</span>
<span class="sd">        maximum number of samples in each plot</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        convert 3D coordinates (x, y, z) to spherical coordinates (theta, phi)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'weight'</span><span class="p">:</span> <span class="s1">'bold'</span><span class="p">,</span> <span class="s1">'size'</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show_n</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">selected_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">show_n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>

  <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
    <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">to_s2</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">xy_lim</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_b</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plot_latent</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">runSGD</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">input_train</span><span class="p">,</span> <span class="n">input_test</span><span class="p">,</span> <span class="n">out_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">'bce'</span><span class="p">,</span> <span class="n">n_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Trains autoencoder network with stochastic gradient descent with</span>
<span class="sd">  optimizer and loss criterion. Train samples are shuffled, and loss is</span>
<span class="sd">  displayed at the end of each opoch for both MSE and BCE. Plots training loss</span>
<span class="sd">  at each minibatch (maximum of 500 randomly selected values).</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    input_train (torch.Tensor)</span>
<span class="sd">        vectorized input images from train set</span>

<span class="sd">    input_test (torch.Tensor)</span>
<span class="sd">        vectorized input images from test set</span>

<span class="sd">    criterion (string)</span>
<span class="sd">        train loss: 'bce' or 'mse'</span>

<span class="sd">    out_train (torch.Tensor)</span>
<span class="sd">        optional target images from train set</span>

<span class="sd">    out_test (torch.Tensor)</span>
<span class="sd">        optional target images from test set</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optional target images from train set</span>

<span class="sd">    criterion (string)</span>
<span class="sd">        train loss: 'bce' or 'mse'</span>

<span class="sd">    n_epochs (boolean)</span>
<span class="sd">        number of full iterations of training data</span>

<span class="sd">    batch_size (integer)</span>
<span class="sd">        number of element in mini-batches</span>

<span class="sd">    verbose (boolean)</span>
<span class="sd">        whether to print final loss</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="n">out_train</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">out_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">different_output</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">different_output</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="c1"># Initialize loss function</span>
  <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">'mse'</span><span class="p">:</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
  <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">'bce'</span><span class="p">:</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Please specify either "mse" or "bce" for loss criterion'</span><span class="p">)</span>

  <span class="c1"># Initialize SGD optimizer</span>
  <span class="k">if</span> <span class="n">optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

  <span class="c1"># Placeholder for loss</span>
  <span class="n">track_loss</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Epoch'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'Loss train'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'Loss test'</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>

    <span class="n">shuffle_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_train</span><span class="p">))</span>
    <span class="n">batches</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">input_train</span><span class="p">[</span><span class="n">shuffle_idx</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">batches_out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">out_train</span><span class="p">[</span><span class="n">shuffle_idx</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batches</span><span class="p">):</span>

      <span class="n">output_train</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">batches_out</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>

      <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

      <span class="c1"># Keep track of loss at each epoch</span>
      <span class="n">track_loss</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">)]</span>

    <span class="n">loss_epoch</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">n_epochs</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">output_train</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_train</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss_train</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">out_train</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss_train</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span> <span class="n">input_train</span><span class="p">)</span>

      <span class="n">loss_epoch</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">loss_train</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">'</span>

      <span class="n">output_test</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
        <span class="n">loss_test</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span> <span class="n">out_test</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">loss_test</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span> <span class="n">input_test</span><span class="p">)</span>

      <span class="n">loss_epoch</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">loss_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">'</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">loss_epoch</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
    <span class="c1"># Print loss</span>
    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">loss_mse</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">MSE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">out_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_mse</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">out_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">loss_mse</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">MSE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">input_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_mse</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_mse</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">input_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss_mse</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">different_output</span><span class="p">:</span>
      <span class="n">loss_bce</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'BCE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">out_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_bce</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">out_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">loss_bce</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'BCE</span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_train</span><span class="p">,</span><span class="w"> </span><span class="n">input_train</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
      <span class="n">loss_bce</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">'</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">eval_bce</span><span class="p">(</span><span class="n">output_test</span><span class="p">,</span><span class="w"> </span><span class="n">input_test</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1">'</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss_bce</span><span class="p">)</span>

  <span class="c1"># Plot loss</span>
  <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">track_loss</span><span class="p">)</span><span class="o">/</span><span class="mi">500</span><span class="p">))</span>
  <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">track_loss</span><span class="p">),</span> <span class="n">step</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">track_loss</span><span class="p">[::</span><span class="n">step</span><span class="p">],</span> <span class="s1">'C0'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">image_occlusion</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Randomly selects on quadrant of images and sets to zeros.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (torch.Tensor of floats)</span>
<span class="sd">        vectorized images</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">  Returns:</span>
<span class="sd">    torch.Tensor.</span>
<span class="sd">  """</span>

  <span class="n">selection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">my_x</span><span class="p">[</span><span class="n">selection</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):,</span> <span class="nb">int</span><span class="p">(</span><span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">my_x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">image_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Randomly rotates images by +- deg degrees.</span>

<span class="sd">  Args:</span>
<span class="sd">    x (torch.Tensor of floats)</span>
<span class="sd">        vectorized images</span>

<span class="sd">    deg (integer)</span>
<span class="sd">        rotation range</span>

<span class="sd">    image_shape (tuple or list)</span>
<span class="sd">        original shape of image</span>

<span class="sd">  Returns:</span>
<span class="sd">    torch.Tensor.</span>
<span class="sd">  """</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_x</span><span class="p">):</span>
    <span class="n">my_deg</span> <span class="o">=</span> <span class="n">deg</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">-</span> <span class="n">deg</span>
    <span class="n">my_x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">my_x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">my_deg</span><span class="p">,</span>
                               <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefilter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="n">my_x</span> <span class="o">=</span> <span class="n">my_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">my_x</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AutoencoderClass</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Deep autoencoder network object (nn.Module) with optional L2 normalization</span>
<span class="sd">  of activations in bottleneck layer.</span>

<span class="sd">  Args:</span>
<span class="sd">    input_size (integer)</span>
<span class="sd">        size of input samples</span>

<span class="sd">    s2 (boolean)</span>
<span class="sd">        whether to L2 normalize activatinos in bottleneck layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Autoencoder object inherited from nn.Module class.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">784</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">=</span> <span class="n">input_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span>

    <span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">enc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc1_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc2_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc3_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec1_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_size</span> <span class="o">*</span> <span class="mi">32</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec2_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">PReLU</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec3_f</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">encoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Encoder component.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc1_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc2_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc3_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Decoder component.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec1_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec2_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec3_f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Forward pass.</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">save_checkpoint</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Saves a PyTorch checkpoint.</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optimizer for SGD</span>

<span class="sd">    filename (string)</span>
<span class="sd">        filename (without extension)</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">'model_state_dict'</span><span class="p">:</span> <span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
              <span class="s1">'optimizer_state_dict'</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()},</span>
             <span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">load_checkpoint</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Loads a PyTorch checkpoint from URL is local file not present.</span>

<span class="sd">  Args:</span>
<span class="sd">    url (string)</span>
<span class="sd">        URL location of PyTorch checkpoint</span>

<span class="sd">    filename (string)</span>
<span class="sd">        filename (without extension)</span>

<span class="sd">  Returns:</span>
<span class="sd">    PyTorch checkpoint of saved model.</span>
<span class="sd">  """</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">"wget </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">.pt"</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'.pt'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">reset_checkpoint</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Resets PyTorch model to checkpoint.</span>

<span class="sd">  Args:</span>
<span class="sd">    net (torch network)</span>
<span class="sd">        ANN network (nn.Module)</span>

<span class="sd">    optimizer (torch optimizer)</span>
<span class="sd">        optimizer for SGD</span>

<span class="sd">    checkpoint (torch checkpoint)</span>
<span class="sd">        checkpoint of saved model</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">net</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
  <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-download-and-prepare-mnist-dataset">
<h1>Section 1: Download  and prepare MNIST dataset<a class="headerlink" href="#section-1-download-and-prepare-mnist-dataset" title="Permalink to this headline">¶</a></h1>
<p>We use the helper function <code class="docutils literal notranslate"><span class="pre">downloadMNIST</span></code> to download the dataset and transform it into <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> and assign train and test sets to (<code class="docutils literal notranslate"><span class="pre">x_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>) and (<code class="docutils literal notranslate"><span class="pre">x_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code>).</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">input_size</span></code> stores the length of <em>vectorized</em> versions of the images <code class="docutils literal notranslate"><span class="pre">input_train</span></code> and <code class="docutils literal notranslate"><span class="pre">input_test</span></code> for training and test images.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download MNIST</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">downloadMNIST</span><span class="p">()</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">image_shape</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">input_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">input_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">])</span>
<span class="n">input_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_size</span><span class="p">])</span>

<span class="n">test_selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">test_subset_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="mi">500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape image </span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{</span><span class="n">image_shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape input_train </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">input_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'shape input_test </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">input_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape image 		 torch.Size([28, 28])
shape input_train 	 torch.Size([60000, 784])
shape input_test 	 torch.Size([10000, 784])
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-download-a-pre-trained-model">
<h1>Section 2: Download a pre-trained model<a class="headerlink" href="#section-2-download-a-pre-trained-model" title="Permalink to this headline">¶</a></h1>
<p>The class <code class="docutils literal notranslate"><span class="pre">AutoencoderClass</span></code> implements the autoencoder architectures introduced in the previous tutorial. The design of this class follows the object-oriented programming (OOP) style from tutorial W3D4. Setting the boolean parameter <code class="docutils literal notranslate"><span class="pre">s2=True</span></code> specifies the model with projection onto the <span class="math notranslate nohighlight">\(S_2\)</span> sphere.</p>
<p>We trained both models for <code class="docutils literal notranslate"><span class="pre">n_epochs=25</span></code> and saved the weights to avoid a lengthy initial training period - these will be our reference model states.</p>
<p>Experiments are run from the identical initial conditions by resetting the autoencoder to the reference state at the beginning of each exercise.</p>
<p>The mechanism for loading and storing models from PyTorch is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="ow">or</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">()</span>

<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">'model_state_dict'</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s1">'optimizer_state_dict'</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()},</span>
           <span class="n">filename_path</span><span class="p">)</span>

<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename_path</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
<p>See additional <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/saving_and_loading_a_general_checkpoint.html">PyTorch instructions</a>, and when to use <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> and <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> for more complex models.</p>
<p>We provide the functions <code class="docutils literal notranslate"><span class="pre">save_checkpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">load_checkpoint</span></code>, and <code class="docutils literal notranslate"><span class="pre">reset_checkpoint</span></code> to implement the steps above and download pre-trained weights from the GitHub repo.</p>
<p>If downloading from GitHub fails, please uncomment the 3rd cell bellow to train the model for <code class="docutils literal notranslate"><span class="pre">n_epochs=10</span></code> and save it locally.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="s1">'https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders'</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">'ae_6h_prelu_bce_adam_25e_32b'</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">s2</span><span class="p">:</span>
  <span class="n">filename</span> <span class="o">+=</span> <span class="s1">'_s2'</span>
  <span class="n">url</span> <span class="o">+=</span> <span class="s1">'_s2'</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>

<span class="n">checkpoint</span> <span class="o">=</span> <span class="n">load_checkpoint</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'model_state_dict'</span><span class="p">])</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">'optimizer_state_dict'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please uncomment and execute this cell if download of</span>
<span class="c1"># pre-trained weights fail</span>

<span class="c1"># model = AutoencoderClass(s2=s2)</span>
<span class="c1"># encoder = model.encoder</span>
<span class="c1"># decoder = model.decoder</span>
<span class="c1"># n_epochs = 10</span>
<span class="c1"># batch_size = 128</span>
<span class="c1"># runSGD(model, input_train, input_test,</span>
<span class="c1">#        n_epochs=n_epochs, batch_size=batch_size)</span>
<span class="c1"># save_checkpoint(model, optimizer, filename)</span>
<span class="c1"># checkpoint = load_checkpoint(url, filename)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_18_0.png" src="../../../_images/Bonus_Tutorial3_18_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_18_1.png" src="../../../_images/Bonus_Tutorial3_18_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_18_2.png" src="../../../_images/Bonus_Tutorial3_18_2.png"/>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-applications-of-autoencoders">
<h1>Section 3: Applications of autoencoders<a class="headerlink" href="#section-3-applications-of-autoencoders" title="Permalink to this headline">¶</a></h1>
<div class="section" id="application-1-image-noise">
<h2>Application 1 - Image noise<a class="headerlink" href="#application-1-image-noise" title="Permalink to this headline">¶</a></h2>
<p>Removing noise added to images is often showcased in dimensionality reduction techniques. The tutorial  <em>W1D5 Dimensionality reduction</em> illustrated this capability with PCA.</p>
<p>We first observe that autoencoders trained with noise-free images output noise-free images when receiving noisy images as input.  However, the reconstructed images will be different from the original images (without noise) since the added noise maps to different coordinates in latent space.</p>
<p>The ability to map noise-free and noisy versions to similar regions in latent space is known as <em>robustness</em> or <em>invariance</em> to noise. How can we build such functionality into the autoencoder?</p>
<p>The solution is to train the autoencoder with noise-free and noisy versions mapping to the noise-free version. A faster alternative is to re-train the autoencoder for few epochs with noisy images. These short training sessions fine-tune the weights to map noisy images to their noise-free versions from similar latent space coordinates.</p>
<p>Let’s start by resetting to the reference state of the autoencoder.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cells below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reconstructions-before-fine-tuning">
<h3>Reconstructions before fine-tuning<a class="headerlink" href="#reconstructions-before-fine-tuning" title="Permalink to this headline">¶</a></h3>
<p>Let’s verify that an autoencoder trained on clean images will output clean images from noisy inputs. We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with noisy images inputs</p></li>
<li><p>Middle row with reconstructions of noisy images</p></li>
<li><p>Bottom row with reconstructions of the original images (noise-free)</p></li>
</ul>
<p><img alt="Noise task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_noise.png"/></p>
<p>The bottom row helps identify samples with reconstruction issues before adding noise. This row shows the baseline reconstruction quality for these samples rather than the original images. (Why?)</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">input_train_noisy</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_train</span>
                     <span class="o">+</span> <span class="n">noise_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">input_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">input_train_noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">input_train_noisy</span><span class="p">,</span> <span class="n">input_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="n">input_train</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">input_test_noisy</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_test</span>
                    <span class="o">+</span> <span class="n">noise_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">input_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">input_test_noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">,</span> <span class="n">input_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                           <span class="n">input_test</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">latent_test_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_24_0.png" src="../../../_images/Bonus_Tutorial3_24_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_24_1.png" src="../../../_images/Bonus_Tutorial3_24_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_24_2.png" src="../../../_images/Bonus_Tutorial3_24_2.png"/>
</div>
</div>
</div>
<div class="section" id="latent-space-before-fine-tuning">
<h3>Latent space before fine-tuning<a class="headerlink" href="#latent-space-before-fine-tuning" title="Permalink to this headline">¶</a></h3>
<p>We investigate the origin of reconstruction errors by looking at how adding noise to input affects latent space coordinates. The decoder interprets significant coordinate changes as different digits.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">plot_latent_ab</span></code> compares latent space coordinates for the same set of samples between two conditions.  Here, we display coordinates for the ten samples from the previous cell before and after adding noise:</p>
<ul class="simple">
<li><p>The left plot shows the coordinates of the original samples (noise-free)</p></li>
<li><p>The plot on the right shows the new coordinates after adding noise</p></li>
</ul>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before noise'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After noise'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_26_0.png" src="../../../_images/Bonus_Tutorial3_26_0.png"/>
</div>
</div>
</div>
<div class="section" id="fine-tuning-the-autoencoder-with-noisy-images">
<h3>Fine-tuning the autoencoder with noisy images<a class="headerlink" href="#fine-tuning-the-autoencoder-with-noisy-images" title="Permalink to this headline">¶</a></h3>
<p>Let’s re-train the autoencoder with noisy images on the input and original (noise-free) images on the output, and regenerate the previous plots.</p>
<p>We now see that both noisy and noise-free images match similar locations in latent space. The network denoises the input with a latent-space representation that is more robust to noise.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_noisy</span><span class="p">,</span> <span class="n">input_test_noisy</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1759		 0.1769
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1760		 0.1769
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1732		 0.1745
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_28_4.png" src="../../../_images/Bonus_Tutorial3_28_4.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">latent_test_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_noisy</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_29_0.png" src="../../../_images/Bonus_Tutorial3_29_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_29_1.png" src="../../../_images/Bonus_Tutorial3_29_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_29_2.png" src="../../../_images/Bonus_Tutorial3_29_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_29_3.png" src="../../../_images/Bonus_Tutorial3_29_3.png"/>
</div>
</div>
</div>
<div class="section" id="global-latent-space-shift">
<h3>Global latent space shift<a class="headerlink" href="#global-latent-space-shift" title="Permalink to this headline">¶</a></h3>
<p>The new latent space representation is more robust to noise and may result in a better internal representation of the dataset. We verify this by inspecting the latent space with clean images before and after fine-tuning with noisy images.</p>
<p>Fine-tuning the network with noisy images causes a <em>domain shift</em> in the dataset, i.e., a change in the distribution of images since the dataset was initially composed of noise-free images. Depending on the task and the extent of changes during re-train,  (number of epochs, optimizer characteristics, etc.), the new latent space representation may become less well adapted to the original data as a side-effect. How could we address <em>domain shift</em> and improve both noisy and noise-free images?</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_31_0.png" src="../../../_images/Bonus_Tutorial3_31_0.png"/>
</div>
</div>
</div>
</div>
<div class="section" id="application-2-image-occlusion">
<h2>Application 2 - Image occlusion<a class="headerlink" href="#application-2-image-occlusion" title="Permalink to this headline">¶</a></h2>
<p>We now investigate the effects of image occlusion. Drawing from the previous exercise, we expect the autoencoder to reconstruct complete images since the train set does not contain occluded images (right?).</p>
<p>We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with occluded images</p></li>
<li><p>Middle row with reconstructions of occluded images</p></li>
<li><p>Bottom row with reconstructions of the original images</p></li>
</ul>
<p><img alt="Occlusion task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_occlusion.png"/></p>
<p>Similarly, we investigate the source of this issue by looking at the representation of partial images in latent space and how it adjusts after fine-tuning.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="before-fine-tuning">
<h3>Before fine-tuning<a class="headerlink" href="#before-fine-tuning" title="Permalink to this headline">¶</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_train_mask</span> <span class="o">=</span> <span class="n">image_occlusion</span><span class="p">(</span><span class="n">input_train</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
<span class="n">input_test_mask</span> <span class="o">=</span> <span class="n">image_occlusion</span><span class="p">(</span><span class="n">input_test</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_mask</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">latent_test_mask</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_mask</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before occlusion'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After occlusion'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_36_0.png" src="../../../_images/Bonus_Tutorial3_36_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_36_1.png" src="../../../_images/Bonus_Tutorial3_36_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_36_2.png" src="../../../_images/Bonus_Tutorial3_36_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_36_3.png" src="../../../_images/Bonus_Tutorial3_36_3.png"/>
</div>
</div>
</div>
<div class="section" id="after-fine-tuning">
<h3>After fine-tuning<a class="headerlink" href="#after-fine-tuning" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_mask</span><span class="p">,</span> <span class="n">input_test_mask</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1722		 0.1736
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1709		 0.1725
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1704		 0.1722
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_38_4.png" src="../../../_images/Bonus_Tutorial3_38_4.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_mask</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">latent_test_mask</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_mask</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_mask</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_mask</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_39_0.png" src="../../../_images/Bonus_Tutorial3_39_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_39_1.png" src="../../../_images/Bonus_Tutorial3_39_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_39_2.png" src="../../../_images/Bonus_Tutorial3_39_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_39_3.png" src="../../../_images/Bonus_Tutorial3_39_3.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_40_0.png" src="../../../_images/Bonus_Tutorial3_40_0.png"/>
</div>
</div>
</div>
</div>
<div class="section" id="application-3-image-rotation">
<h2>Application 3 - Image rotation<a class="headerlink" href="#application-3-image-rotation" title="Permalink to this headline">¶</a></h2>
<p>Finally, we look at the effect of image rotation in latent space coordinates. This task is arguably more challenging since it may require a complete re-write of image reconstruction.</p>
<p>We visualize this by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with rotated images</p></li>
<li><p>Middle row with reconstructions of rotated images</p></li>
<li><p>Bottom row with reconstructions of the original images</p></li>
</ul>
<p><img alt="Rotation task" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_rotation.png"/></p>
<p>We investigate the source of this issue by looking at the representation of rotated images in latent space and how it adjusts after fine-tuning.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset_checkpoint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_ref</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Before fine-tuning<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_train_rotation</span> <span class="o">=</span> <span class="n">image_rotation</span><span class="p">(</span><span class="n">input_train</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
<span class="n">input_test_rotation</span> <span class="o">=</span> <span class="n">image_rotation</span><span class="p">(</span><span class="n">input_test</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_rotation</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">latent_test_rotation</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_rotation</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before rotation'</span><span class="p">,</span> <span class="n">title_b</span><span class="o">=</span><span class="s1">'After rotation'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_45_0.png" src="../../../_images/Bonus_Tutorial3_45_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_45_1.png" src="../../../_images/Bonus_Tutorial3_45_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_45_2.png" src="../../../_images/Bonus_Tutorial3_45_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_45_3.png" src="../../../_images/Bonus_Tutorial3_45_3.png"/>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>After fine-tuning<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_rotation</span><span class="p">,</span> <span class="n">input_test_rotation</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/5	 0.2225		 0.2227
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/5	 0.2139		 0.2149
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/5	 0.2105		 0.2109
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4/5	 0.2080		 0.2092
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/5	 0.2053		 0.2061
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_47_6.png" src="../../../_images/Bonus_Tutorial3_47_6.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test_rotation</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">latent_test_rotation</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_rotation</span><span class="p">)</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_rotation</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">]],</span> <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test</span><span class="p">,</span> <span class="n">latent_test_rotation</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_selected_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_48_0.png" src="../../../_images/Bonus_Tutorial3_48_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_48_1.png" src="../../../_images/Bonus_Tutorial3_48_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_48_2.png" src="../../../_images/Bonus_Tutorial3_48_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_48_3.png" src="../../../_images/Bonus_Tutorial3_48_3.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>

<span class="n">plot_latent_ab</span><span class="p">(</span><span class="n">latent_test_ref</span><span class="p">,</span> <span class="n">latent_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">test_subset_idx</span><span class="p">,</span>
               <span class="n">title_a</span><span class="o">=</span><span class="s1">'Before fine-tuning'</span><span class="p">,</span>
               <span class="n">title_b</span><span class="o">=</span><span class="s1">'After fine-tuning'</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_49_0.png" src="../../../_images/Bonus_Tutorial3_49_0.png"/>
</div>
</div>
</div>
</div>
<div class="section" id="application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before">
<h2>Application 4 - What would digit “6” look like if we had never seen it before?<a class="headerlink" href="#application-4-what-would-digit-6-look-like-if-we-had-never-seen-it-before" title="Permalink to this headline">¶</a></h2>
<p>Before we start melting our brains with such an impossible task, let’s just ask the autoencoder to do it!</p>
<p>We train the autoencoder from scratch without digit class <code class="docutils literal notranslate"><span class="pre">6</span></code> and visualize reconstructions from digit <code class="docutils literal notranslate"><span class="pre">6</span></code>.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">my_input_train</span> <span class="o">=</span> <span class="n">input_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
<span class="n">my_input_test</span> <span class="o">=</span> <span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
<span class="n">my_y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">my_input_train</span><span class="p">,</span> <span class="n">my_input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">my_latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">my_input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1899		 0.1886
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1847		 0.1838
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1770		 0.1765
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_53_4.png" src="../../../_images/Bonus_Tutorial3_53_4.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">6</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">my_latent_test</span><span class="p">,</span> <span class="n">my_y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_54_0.png" src="../../../_images/Bonus_Tutorial3_54_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_54_1.png" src="../../../_images/Bonus_Tutorial3_54_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_54_2.png" src="../../../_images/Bonus_Tutorial3_54_2.png"/>
</div>
</div>
<div class="section" id="exercise-1-removing-the-most-dominant-digit-classes">
<h3>Exercise 1: Removing the most dominant digit classes<a class="headerlink" href="#exercise-1-removing-the-most-dominant-digit-classes" title="Permalink to this headline">¶</a></h3>
<p>Digit classes <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> are dominant in the sense that these occupy large areas of the decoder grid, compared to other digit classes that occupy very little generative space.</p>
<p>How will latent space change when removing the two most dominant digit classes? Will latent space re-distribute evenly among remaining classes or choose another two dominant classes?</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
<li><p>The intersection of two boolean arrays by condition is specified as <code class="docutils literal notranslate"><span class="pre">x[(cond_a)&amp;(cond_b)]</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">missing_b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#################################################</span>
<span class="c1">## TODO for students:</span>
<span class="c1">#################################################</span>
<span class="c1"># input train data</span>
<span class="c1"># my_input_train = ...</span>
<span class="c1"># input test data</span>
<span class="c1"># my_input_test = ...</span>
<span class="c1"># model</span>
<span class="c1"># my_y_test = ...</span>

<span class="c1"># Uncomment to test your code</span>
<span class="c1"># print(my_input_train.shape)</span>
<span class="c1"># print(my_input_test.shape)</span>
<span class="c1"># print(my_y_test.shape)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="o">**</span><span class="n">SAMPLE</span> <span class="n">OUTPUT</span><span class="o">**</span>

</pre></div>
</div>
<p>torch.Size([47335, 784])
torch.Size([7885, 784])
torch.Size([7885])</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="n">missing_a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">missing_b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># input train data</span>
<span class="n">my_input_train</span> <span class="o">=</span> <span class="n">input_train</span><span class="p">[(</span><span class="n">y_train</span> <span class="o">!=</span> <span class="n">missing_a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_train</span> <span class="o">!=</span> <span class="n">missing_b</span><span class="p">)]</span>
<span class="c1"># input test data</span>
<span class="n">my_input_test</span> <span class="o">=</span> <span class="n">input_test</span><span class="p">[(</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing_a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing_b</span><span class="p">)]</span>
<span class="c1"># model</span>
<span class="n">my_y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[(</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing_a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_test</span> <span class="o">!=</span> <span class="n">missing_b</span><span class="p">)]</span>

<span class="c1"># Uncomment to test your code</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_input_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_input_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([47335, 784])
torch.Size([7885, 784])
torch.Size([7885])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">my_input_train</span><span class="p">,</span> <span class="n">my_input_test</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">output_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test</span><span class="p">)</span>
  <span class="n">my_latent_test</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">my_input_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1971		 0.1973
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1909		 0.1916
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1879		 0.1885
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_60_4.png" src="../../../_images/Bonus_Tutorial3_60_4.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_a</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_a</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_b</span><span class="p">],</span> <span class="n">output_test</span><span class="p">[</span><span class="n">y_test</span> <span class="o">==</span> <span class="n">missing_b</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">my_latent_test</span><span class="p">,</span> <span class="n">my_y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_61_0.png" src="../../../_images/Bonus_Tutorial3_61_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_61_1.png" src="../../../_images/Bonus_Tutorial3_61_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_61_2.png" src="../../../_images/Bonus_Tutorial3_61_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_61_3.png" src="../../../_images/Bonus_Tutorial3_61_3.png"/>
<img alt="../../../_images/Bonus_Tutorial3_61_4.png" src="../../../_images/Bonus_Tutorial3_61_4.png"/>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-4-anns-same-but-different">
<h1>Section 4: ANNs? Same but different!<a class="headerlink" href="#section-4-anns-same-but-different" title="Permalink to this headline">¶</a></h1>
<p>“Same same but different” is an expression used in some parts of Asia to express differences between supposedly similar subjects. In this exercise, we investigate a fundamental difference in how fully-connected ANNs process visual information compared to human vision.</p>
<p>The previous exercises showed ANN autoencoder performing cognitive tasks with relative ease. However, there is a crucial aspect of ANN processing already encoded in the vectorization of images. This network architecture completely ignores the relative position of pixels. To illustrate this, we show that learning proceeds just as well with shuffled pixel locations.</p>
<p>First, we obtain a reversible shuffle map stored in <code class="docutils literal notranslate"><span class="pre">shuffle_image_idx</span></code> used to shuffle image pixels randomly.</p>
<br/>
<p><img alt="mnist_pixel_shuffle" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/mnist_pixel_shuffle.png"/></p>
<br/>
<p>The unshuffled image set <code class="docutils literal notranslate"><span class="pre">input_shuffle</span></code> is recovered as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_shuffle</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">]]</span>
</pre></div>
</div>
<p>First, we set up the reversible shuffle map and visualize a few images with shuffled and unshuffled pixels, followed by their noisy versions.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell(s) below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create forward and reverse indexes for pixel shuffling</span>
<span class="n">shuffle_image_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">input_size</span><span class="p">)</span>
<span class="n">shuffle_rev_image_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">)</span>

<span class="c1"># shuffle pixel location</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">)</span>

<span class="c1"># store reverse locations</span>
<span class="k">for</span> <span class="n">pos_idx</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shuffle_image_idx</span><span class="p">):</span>
  <span class="n">shuffle_rev_image_idx</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_idx</span>

<span class="c1"># shuffle train and test sets</span>
<span class="n">input_train_shuffle</span> <span class="o">=</span> <span class="n">input_train</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>
<span class="n">input_test_shuffle</span> <span class="o">=</span> <span class="n">input_test</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>

<span class="n">input_train_shuffle_noisy</span> <span class="o">=</span> <span class="n">input_train_noisy</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>
<span class="n">input_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">input_test_noisy</span><span class="p">[:,</span> <span class="n">shuffle_image_idx</span><span class="p">]</span>

<span class="c1"># show samples with shuffled pixels</span>
<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_shuffle</span><span class="p">,</span>
          <span class="n">input_test_shuffle</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_63_0.png" src="../../../_images/Bonus_Tutorial3_63_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_63_1.png" src="../../../_images/Bonus_Tutorial3_63_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show noisy samples with shuffled pixels</span>
<span class="n">plot_row</span><span class="p">([</span><span class="n">input_train_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">input_train_shuffle_noisy</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">][</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_64_0.png" src="../../../_images/Bonus_Tutorial3_64_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_64_1.png" src="../../../_images/Bonus_Tutorial3_64_1.png"/>
</div>
</div>
<p>We initialize and train the network in the denoising task with shuffled pixels.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoencoderClass</span><span class="p">(</span><span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encoder</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decoder</span>

<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="c1"># train the model to denoise shuffled images</span>
<span class="n">runSGD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_train_shuffle_noisy</span><span class="p">,</span> <span class="n">input_test_shuffle_noisy</span><span class="p">,</span>
       <span class="n">out_train</span><span class="o">=</span><span class="n">input_train_shuffle</span><span class="p">,</span> <span class="n">out_test</span><span class="o">=</span><span class="n">input_test_shuffle</span><span class="p">,</span>
       <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 	 Loss train 	 Loss test
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3	 0.1984		 0.1988
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/3	 0.1911		 0.1913
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/3	 0.1886		 0.1891
</pre></div>
</div>
<img alt="../../../_images/Bonus_Tutorial3_66_4.png" src="../../../_images/Bonus_Tutorial3_66_4.png"/>
</div>
</div>
<p>Finally, visualize reconstructions and latent space representation with the trained model.</p>
<p>We visualize reconstructions by plotting three rows:</p>
<ul class="simple">
<li><p>Top row with shuffled noisy images</p></li>
<li><p>Middle row with reconstructions of shuffled denoised images</p></li>
<li><p>Bottom row with unshuffled reconstructions of denoised images</p></li>
</ul>
<p><img alt="mnist_pixel_shuffle denoised" src="https://github.com/mpbrigham/colaboratory-figures/raw/master/nma/autoencoders/applications_ann_denoise.png"/></p>
<p>We obtain the same organization in the encoder map as before. Sharing similar internal representations confirms the network to ignore the relative position of pixels. The decoder grid is different than before since it generates shuffled images.</p>
<p><strong>Instructions:</strong></p>
<ul class="simple">
<li><p>Please execute the cell below</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">latent_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_test_shuffle_noisy</span><span class="p">)</span>
  <span class="n">output_test_shuffle_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_test_shuffle_noisy</span><span class="p">)</span>

<span class="n">plot_row</span><span class="p">([</span><span class="n">input_test_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_shuffle_noisy</span><span class="p">[</span><span class="n">test_selected_idx</span><span class="p">],</span>
          <span class="n">output_test_shuffle_noisy</span><span class="p">[:,</span> <span class="n">shuffle_rev_image_idx</span><span class="p">][</span><span class="n">test_selected_idx</span><span class="p">]],</span>
         <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">)</span>

<span class="n">plot_latent_generative</span><span class="p">(</span><span class="n">latent_test_shuffle_noisy</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span>
                       <span class="n">image_shape</span><span class="o">=</span><span class="n">image_shape</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Bonus_Tutorial3_68_0.png" src="../../../_images/Bonus_Tutorial3_68_0.png"/>
<img alt="../../../_images/Bonus_Tutorial3_68_1.png" src="../../../_images/Bonus_Tutorial3_68_1.png"/>
<img alt="../../../_images/Bonus_Tutorial3_68_2.png" src="../../../_images/Bonus_Tutorial3_68_2.png"/>
<img alt="../../../_images/Bonus_Tutorial3_68_3.png" src="../../../_images/Bonus_Tutorial3_68_3.png"/>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>Hooray! You have finished the last Tutorial of NMA 2020!</p>
<p>We hope you’ve enjoyed these tutorials and learned about the usefulness of autoencoders to model rich and non-linear representations of data. We hope you may find them useful in your research, perhaps to model certain aspects of cognition or even extend them to biologically plausible architectures - autoencoders of spiking neurons, anyone?</p>
<p>These are the key take away messages from these tutorials:</p>
<p><strong>Autoencoders trained in <em>learning by doing</em> tasks such as compression/decompression, removing noise, etc. can uncover rich lower-dimensional structure embedded in structured images and other cognitively relevant data.</strong></p>
<p><strong>The data domain seen during training imprints a “cognitive bias” - you only see what you expect to see, which can only be similar to what you saw before.</strong></p>
<p>Such bias is related to the concept <a class="reference external" href="https://en.wikipedia.org/wiki/Thinking,_Fast_and_Slow"><em>What you see is all there is</em></a> coined by Daniel Kahneman in psychology.</p>
<p>For additional applications of autoencoders to neuroscience, check the spike sorting application in the outro video, and also see <a class="reference external" href="https://www.nature.com/articles/s41592-018-0109-9">here</a> how to replicate the input-output relationship of real networks of neurons with autoencoders.</p>
<div class="section" id="video-2-wrap-up">
<h2>Video 2: Wrap-up<a class="headerlink" href="#video-2-wrap-up" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "7012ef8f9fbb4989b6ce1a9a16ba46df"}
</script></div>
</div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"61624e798b1a4c84896568bbf78be78e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bac0dde28a9e43c7aa3fe5a9eb919a60": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_61624e798b1a4c84896568bbf78be78e", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=_bzW_jkH6l0\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f381009b690>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/_bzW_jkH6l0?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "0ba20eb9f1d64b70b7ebca1725ab98bf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "25cf190f90714575bac40ce141ec52b0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0ba20eb9f1d64b70b7ebca1725ab98bf", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV12v411q7nS\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f3818bd9e50>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV12v411q7nS&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "3e70b27890c74d35b5044be1ffb20403": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f37e317d830447a8988db4a9d5b79cb6": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_bac0dde28a9e43c7aa3fe5a9eb919a60", "IPY_MODEL_25cf190f90714575bac40ce141ec52b0"], "layout": "IPY_MODEL_3e70b27890c74d35b5044be1ffb20403", "selected_index": 0}}, "fd5ecf14a8744acdb22693f95f9ef007": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "efa614835e9e40b192f2f4ddd35fffc1": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_fd5ecf14a8744acdb22693f95f9ef007", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=ziiZK9P6AXQ\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f37cfc9fed0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/ziiZK9P6AXQ?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "98c826fec51742fc9a10a650511f88f3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3b45b849367542279820bc04c2a719ec": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_98c826fec51742fc9a10a650511f88f3", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1ph411Z7uh\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f37cfd7da90>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1ph411Z7uh&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "e35b32069d794658a3d65b91a364cb1c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7012ef8f9fbb4989b6ce1a9a16ba46df": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_efa614835e9e40b192f2f4ddd35fffc1", "IPY_MODEL_3b45b849367542279820bc04c2a719ec"], "layout": "IPY_MODEL_e35b32069d794658a3d65b91a364cb1c", "selected_index": 0}}}, "version_major": 2, "version_minor": 0}
</script>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/Bonus_Autoencoders/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="Bonus_Tutorial2.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 2: Autoencoder extensions</p>
</div>
</a>
<a class="right-next" href="Bonus_Outro.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Outro</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>