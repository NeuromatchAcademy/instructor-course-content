
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 1: LIF Neuron Part II — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="../../W0D3_LinearAlgebra/chapter_title.html" rel="next" title="Linear Algebra"/>
<link href="../chapter_title.html" rel="prev" title="Python Workshop 2"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training - Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: LIF Neuron Part II
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
     Tutorial objectives
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-histograms">
   Section 1: Histograms
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-histograms">
     Video 1: Histograms
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-nano-recap-of-histograms">
     Video 2: Nano recap of histograms
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-plotting-a-histogram">
     Coding Exercise 1: Plotting a histogram
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-dictionaries-introducing-spikes">
   Section 2: Dictionaries &amp; introducing spikes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-dictionaries-introducing-spikes">
     Video 3: Dictionaries &amp; introducing spikes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-nano-recap-of-dictionaries">
     Video 4: Nano recap of dictionaries
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-adding-spiking-to-the-lif-neuron">
     Coding Exercise 2: Adding spiking to the LIF neuron
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-boolean-indexes">
   Section 3: Boolean indexes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-boolean-indexes">
     Video 5: Boolean indexes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-nano-recap-of-boolean-indexes">
     Video 6: Nano recap of Boolean indexes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-using-boolean-indexing">
     Coding Exercise 3: Using Boolean indexing
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-making-a-binary-raster-plot">
     Coding Exercise 4: Making a binary raster plot
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-refractory-period">
   Section 4: Refractory period
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-refractory-period">
     Video 7: Refractory period
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-nano-recap-of-refractory-period">
     Video 8: Nano recap of refractory period
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-5-investigating-refactory-periods">
     Coding Exercise 5: Investigating refactory periods
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-random-refractory-period">
     Interactive Demo 1: Random refractory period
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-using-functions">
   Section 5: Using functions
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-functions">
     Video 9: Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-10-nano-recap-of-functions">
     Video 10: Nano recap of functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-6-rewriting-code-with-functions">
     Coding Exercise 6: Rewriting code with functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-using-classes">
   Section 6: Using classes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-11-classes">
     Video 11: Classes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-nano-recap-of-classes">
     Video 12: Nano recap of classes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-7-making-a-lif-class">
     Coding Exercise 7: Making a LIF class
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-last-concepts-recap">
     Video 12: Last concepts &amp; recap
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 1: LIF Neuron Part II</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: LIF Neuron Part II
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
     Tutorial objectives
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-histograms">
   Section 1: Histograms
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-histograms">
     Video 1: Histograms
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-nano-recap-of-histograms">
     Video 2: Nano recap of histograms
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-plotting-a-histogram">
     Coding Exercise 1: Plotting a histogram
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-dictionaries-introducing-spikes">
   Section 2: Dictionaries &amp; introducing spikes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-dictionaries-introducing-spikes">
     Video 3: Dictionaries &amp; introducing spikes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-nano-recap-of-dictionaries">
     Video 4: Nano recap of dictionaries
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-adding-spiking-to-the-lif-neuron">
     Coding Exercise 2: Adding spiking to the LIF neuron
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-boolean-indexes">
   Section 3: Boolean indexes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-boolean-indexes">
     Video 5: Boolean indexes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-nano-recap-of-boolean-indexes">
     Video 6: Nano recap of Boolean indexes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-using-boolean-indexing">
     Coding Exercise 3: Using Boolean indexing
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-making-a-binary-raster-plot">
     Coding Exercise 4: Making a binary raster plot
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-refractory-period">
   Section 4: Refractory period
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-refractory-period">
     Video 7: Refractory period
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-nano-recap-of-refractory-period">
     Video 8: Nano recap of refractory period
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-5-investigating-refactory-periods">
     Coding Exercise 5: Investigating refactory periods
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-random-refractory-period">
     Interactive Demo 1: Random refractory period
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-using-functions">
   Section 5: Using functions
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-functions">
     Video 9: Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-10-nano-recap-of-functions">
     Video 10: Nano recap of functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-6-rewriting-code-with-functions">
     Coding Exercise 6: Rewriting code with functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-using-classes">
   Section 6: Using classes
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-11-classes">
     Video 11: Classes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-nano-recap-of-classes">
     Video 12: Nano recap of classes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-7-making-a-lif-class">
     Coding Exercise 7: Making a LIF class
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-last-concepts-recap">
     Video 12: Last concepts &amp; recap
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/precourse/blob/main/tutorials/W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-1-lif-neuron-part-ii">
<h1>Tutorial 1: LIF Neuron Part II<a class="headerlink" href="#tutorial-1-lif-neuron-part-ii" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 0, Day 2: Python Workshop 2</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Marco Brigham and the <a class="reference external" href="https://www.ccnss.org/">CCNSS</a> team</p>
<p><strong>Content reviewers:</strong> Michael Waskom, Karolina Stosio, Spiros Chavlis</p>
<p><strong>Production Editor:</strong> Ella Batty</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p><hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h2>Tutorial objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h2>
<p>We learned basic Python and NumPy concepts in the previous tutorial. These new and efficient coding techniques can be applied repeatedly in tutorials from the NMA course, and elsewhere.</p>
<p>In this tutorial, we’ll introduce spikes in our LIF neuron and evaluate the refractory period’s effect in spiking dynamics!</p>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/content-creation/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>

<span class="n">t_max</span> <span class="o">=</span> <span class="mf">150e-3</span>   <span class="c1"># second</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1e-3</span>        <span class="c1"># second</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">20e-3</span>      <span class="c1"># second</span>
<span class="n">el</span> <span class="o">=</span> <span class="o">-</span><span class="mf">60e-3</span>      <span class="c1"># milivolt</span>
<span class="n">vr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">70e-3</span>      <span class="c1"># milivolt</span>
<span class="n">vth</span> <span class="o">=</span> <span class="o">-</span><span class="mf">50e-3</span>     <span class="c1"># milivolt</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">100e6</span>        <span class="c1"># ohm</span>
<span class="n">i_mean</span> <span class="o">=</span> <span class="mf">25e-11</span>  <span class="c1"># ampere</span>


<span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">raster</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spikes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots Time evolution for</span>
<span class="sd">  (1) multiple realizations of membrane potential</span>
<span class="sd">  (2) spikes</span>
<span class="sd">  (3) mean spike rate (optional)</span>

<span class="sd">  Args:</span>
<span class="sd">    t_range (numpy array of floats)</span>
<span class="sd">        range of time steps for the plots of shape (time steps)</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">        membrane potential values of shape (neurons, time steps)</span>

<span class="sd">    raster (numpy array of floats)</span>
<span class="sd">        spike raster of shape (neurons, time steps)</span>

<span class="sd">    spikes (dictionary of lists)</span>
<span class="sd">        list with spike times indexed by neuron number</span>

<span class="sd">    spikes_mean (numpy array of floats)</span>
<span class="sd">        Mean spike rate for spikes as dictionary</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>

  <span class="n">v_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">fig_w</span><span class="p">,</span> <span class="n">fig_h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.figsize'</span><span class="p">]</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_w</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">))</span>

  <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_mean</span><span class="p">,</span> <span class="s1">'C1'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$V_m$ (V)'</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">raster</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">spikes_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys'</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron'</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">spikes_mean</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (s)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'rate (Hz)'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-histograms">
<h1>Section 1: Histograms<a class="headerlink" href="#section-1-histograms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-1-histograms">
<h2>Video 1: Histograms<a class="headerlink" href="#video-1-histograms" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D2_PythonWorkshop2/static/histogram_statistics.png"/>
</figure>
<br/>
<p>Another important statistic is the sample <a class="reference external" href="https://en.wikipedia.org/wiki/Histogram">histogram</a>. For our LIF neuron it provides an approximate representation of the distribution of membrane potential <span class="math notranslate nohighlight">\(V_m(t)\)</span> at time <span class="math notranslate nohighlight">\(t=t_k\in[0,t_{max}]\)</span>. For <span class="math notranslate nohighlight">\(N\)</span> realizations <span class="math notranslate nohighlight">\(V\left(t_k\right)\)</span> and <span class="math notranslate nohighlight">\(J\)</span> bins is given by:</p>
<br/>
\begin{equation}
N = \sum_{j=1}^{J} m_j
\end{equation}
<br/>
<p>where <span class="math notranslate nohighlight">\(m_j\)</span> is a function that counts the number of samples <span class="math notranslate nohighlight">\(V\left(t_k\right)\)</span> that fall into bin <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">plt.hist(data,</span> <span class="pre">nbins)</span></code> plots an histogram of <code class="docutils literal notranslate"><span class="pre">data</span></code> in <code class="docutils literal notranslate"><span class="pre">nbins</span></code> bins. The argument <code class="docutils literal notranslate"><span class="pre">label</span></code> defines a label for <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> adds all labels to the plot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'my data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">histtype='stepfilled'</span></code> and <code class="docutils literal notranslate"><span class="pre">linewidth=0</span></code> may improve histogram appearance (depending on taste). You can read more about <a class="reference external" href="https://matplotlib.org/gallery/statistics/histogram_histtypes.html">different histtype settings</a>.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">plt.hist</span></code> returns the <code class="docutils literal notranslate"><span class="pre">pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">bins</span></code>, and <code class="docutils literal notranslate"><span class="pre">patches</span></code> with the histogram bins, the edges of the bins, and the individual patches used to create the histogram.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pdf</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="video-2-nano-recap-of-histograms">
<h2>Video 2: Nano recap of histograms<a class="headerlink" href="#video-2-nano-recap-of-histograms" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-1-plotting-a-histogram">
<h2>Coding Exercise 1: Plotting a histogram<a class="headerlink" href="#coding-exercise-1-plotting-a-histogram" title="Permalink to this headline">¶</a></h2>
<p>Plot an histogram of <span class="math notranslate nohighlight">\(J=50\)</span> bins of <span class="math notranslate nohighlight">\(N=10000\)</span> realizations of <span class="math notranslate nohighlight">\(V(t)\)</span> for <span class="math notranslate nohighlight">\(t=t_{max}/10\)</span> and <span class="math notranslate nohighlight">\(t=t_{max}\)</span>.</p>
<p>We’ll make a small correction in the definition of <code class="docutils literal notranslate"><span class="pre">t_range</span></code> to ensure increments of <code class="docutils literal notranslate"><span class="pre">dt</span></code> by using <code class="docutils literal notranslate"><span class="pre">np.arange</span></code> instead of <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>numpy.arange(start, stop, step)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################</span>
<span class="c1">## TODO for students: fill out code to plot histogram ##</span>
<span class="c1"># Fill out code and comment or remove the next line</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: You need to plot histogram"</span><span class="p">)</span>
<span class="c1">#################################################</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize t_range, step_end, n, v_n, i and nbins</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">32</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span>  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

<span class="c1"># Initialize the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$V_m$ (V)'</span><span class="p">)</span>

<span class="c1"># Plot a histogram at t_max/10 (add labels and parameters histtype='stepfilled' and linewidth=0)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="c1"># Plot a histogram at t_max (add labels and parameters histtype='stepfilled' and linewidth=0)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="c1"># Add legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize t_range, step_end, n, v_n, i and nbins</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">32</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span>  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

<span class="c1"># Initialize the figure</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$V_m$ (V)'</span><span class="p">)</span>

  <span class="c1"># Plot a histogram at t_max/10 (add labels and parameters histtype='stepfilled' and linewidth=0)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="nb">int</span><span class="p">(</span><span class="n">step_end</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)],</span> <span class="n">nbins</span><span class="p">,</span>
            <span class="n">histtype</span><span class="o">=</span><span class="s1">'stepfilled'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">'t='</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'s'</span><span class="p">)</span>

  <span class="c1"># Plot a histogram at t_max (add labels and parameters histtype='stepfilled' and linewidth=0)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nbins</span><span class="p">,</span>
            <span class="n">histtype</span><span class="o">=</span><span class="s1">'stepfilled'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">'t='</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t_max</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'s'</span><span class="p">)</span>
  <span class="c1"># Add legend</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-dictionaries-introducing-spikes">
<h1>Section 2: Dictionaries &amp; introducing spikes<a class="headerlink" href="#section-2-dictionaries-introducing-spikes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-3-dictionaries-introducing-spikes">
<h2>Video 3: Dictionaries &amp; introducing spikes<a class="headerlink" href="#video-3-dictionaries-introducing-spikes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>A spike takes place whenever <span class="math notranslate nohighlight">\(V(t)\)</span> crosses <span class="math notranslate nohighlight">\(V_{th}\)</span>. In that case, a spike is recorded and <span class="math notranslate nohighlight">\(V(t)\)</span> resets to <span class="math notranslate nohighlight">\(V_{reset}\)</span> value. This is summarized in the <em>reset condition</em>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-144f323c-9efa-4e23-937b-4cc6949967ee">
<span class="eqno">(7)<a class="headerlink" href="#equation-144f323c-9efa-4e23-937b-4cc6949967ee" title="Permalink to this equation">¶</a></span>\[\begin{equation}
V(t) = V_{reset}\quad \text{ if } V(t)\geq V_{th}
\end{equation}\]</div>
<p>For more information about spikes or action potentials see <a class="reference external" href="https://en.wikipedia.org/wiki/Action_potential">here</a> and <a class="reference external" href="https://www.khanacademy.org/test-prep/mcat/organ-systems/neuron-membrane-potentials/a/neuron-action-potentials-the-creation-of-a-brain-signal">here</a>.</p>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D2_PythonWorkshop2/static/spikes_carton.png"/>
</figure></div>
<div class="section" id="video-4-nano-recap-of-dictionaries">
<h2>Video 4: Nano recap of dictionaries<a class="headerlink" href="#video-4-nano-recap-of-dictionaries" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-2-adding-spiking-to-the-lif-neuron">
<h2>Coding Exercise 2: Adding spiking to the LIF neuron<a class="headerlink" href="#coding-exercise-2-adding-spiking-to-the-lif-neuron" title="Permalink to this headline">¶</a></h2>
<p>Insert the reset condition, and collect the spike times of each realization in a dictionary variable <code class="docutils literal notranslate"><span class="pre">spikes</span></code>, with <span class="math notranslate nohighlight">\(N=500\)</span>.</p>
<p>We’ve used <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> for plotting lines and also for plotting dots at <code class="docutils literal notranslate"><span class="pre">(x,y)</span></code> coordinates, which is a <a class="reference external" href="https://en.wikipedia.org/wiki/Scatter_plot">scatter plot</a>. From here on, we’ll use use <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> for plotting lines and for scatter plots: <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">)</span>
</pre></div>
</div>
<p>A <em>raster plot</em> represents spikes from multiple neurons by plotting dots at spike times from neuron <code class="docutils literal notranslate"><span class="pre">j</span></code> at plot height <code class="docutils literal notranslate"><span class="pre">j</span></code>, i.e.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spike_times</span><span class="p">,</span> <span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">spike_times</span><span class="p">))</span>
</pre></div>
</div>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D2_PythonWorkshop2/static/spikes_plot.png"/>
</figure>
<p>In this exercise, we use <code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code> for multiple plots in the same figure. These plots can share the same <code class="docutils literal notranslate"><span class="pre">x</span></code> or <code class="docutils literal notranslate"><span class="pre">y</span></code> axis by specifying the parameter <code class="docutils literal notranslate"><span class="pre">sharex</span></code> or <code class="docutils literal notranslate"><span class="pre">sharey</span></code>. Add <code class="docutils literal notranslate"><span class="pre">plt.tight_layout()</span></code> at the end to automatically adjust subplot parameters to fit the figure area better. Please see the example below for a row of two plots sharing axis <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># collect axis of 1st figure in ax1</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">my_data_left</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'ylabel'</span><span class="p">)</span>

<span class="c1"># share axis x with 1st figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">my_data_right</span><span class="p">)</span>

<span class="c1"># automatically adjust subplot parameters to figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize spikes and spikes_n</span>
<span class="n">spikes</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)}</span>
<span class="n">spikes_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1">#################################################</span>
<span class="c1">## TODO for students: add spikes to LIF neuron ##</span>
<span class="c1"># Fill out function and remove</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: add spikes to LIF neuron"</span><span class="p">)</span>
<span class="c1">#################################################</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Loop over simulations</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>

    <span class="c1"># Check if voltage above threshold</span>
    <span class="k">if</span> <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">:</span>

      <span class="c1"># Reset to reset voltage</span>
      <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

      <span class="c1"># Add this spike time</span>
      <span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">...</span>

      <span class="c1"># Add spike count to this step</span>
      <span class="n">spikes_n</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">+=</span> <span class="o">...</span>

<span class="c1"># Collect mean Vm and mean spiking rate</span>
<span class="n">v_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">v_n</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">spikes_mean</span> <span class="o">=</span>  <span class="n">spikes_n</span> <span class="o">/</span> <span class="n">n</span>

<span class="c1"># Initialize the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># Plot simulations and sample mean</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_mean</span><span class="p">,</span> <span class="s1">'C1'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$V_m$ (V)'</span><span class="p">)</span>

<span class="c1"># Plot spikes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="c1"># for each neuron j: collect spike times and plot them at height j</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="n">times</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron'</span><span class="p">)</span>

<span class="c1"># Plot firing rate</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (s)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'rate (Hz)'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize spikes and spikes_n</span>
<span class="n">spikes</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)}</span>
<span class="n">spikes_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Loop over simulations</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>

    <span class="c1"># Check if voltage above threshold</span>
    <span class="k">if</span> <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">:</span>

      <span class="c1"># Reset to reset voltage</span>
      <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

      <span class="c1"># Add this spike time</span>
      <span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>

      <span class="c1"># Add spike count to this step</span>
      <span class="n">spikes_n</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Collect mean Vm and mean spiking rate</span>
<span class="n">v_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">v_n</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">spikes_mean</span> <span class="o">=</span>  <span class="n">spikes_n</span> <span class="o">/</span> <span class="n">n</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="c1"># Initialize the figure</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

  <span class="c1"># Plot simulations and sample mean</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_mean</span><span class="p">,</span> <span class="s1">'C1'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$V_m$ (V)'</span><span class="p">)</span>

  <span class="c1"># Plot spikes</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="c1"># for each neuron j: collect spike times and plot them at height j</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron'</span><span class="p">)</span>

  <span class="c1"># Plot firing rate</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (s)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'rate (Hz)'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-boolean-indexes">
<h1>Section 3: Boolean indexes<a class="headerlink" href="#section-3-boolean-indexes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-5-boolean-indexes">
<h2>Video 5: Boolean indexes<a class="headerlink" href="#video-5-boolean-indexes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>Numpy arrays can be indexed by boolean arrays to select a subset of elements (also works with lists of booleans).</p>
<p>The boolean array itself can be initiated by a condition, as shown in the example below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">--&gt;</span> <span class="p">[</span><span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
<span class="o">--&gt;</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">])</span>
<span class="o">--&gt;</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="video-6-nano-recap-of-boolean-indexes">
<h2>Video 6: Nano recap of Boolean indexes<a class="headerlink" href="#video-6-nano-recap-of-boolean-indexes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-3-using-boolean-indexing">
<h2>Coding Exercise 3: Using Boolean indexing<a class="headerlink" href="#coding-exercise-3-using-boolean-indexing" title="Permalink to this headline">¶</a></h2>
<p>We can avoid looping all neurons in each time step by identifying with boolean arrays the indexes of neurons that spiked in the previous step.</p>
<p>In the example below, <code class="docutils literal notranslate"><span class="pre">v_rest</span></code> is a boolean numpy array with <code class="docutils literal notranslate"><span class="pre">True</span></code> in each index of <code class="docutils literal notranslate"><span class="pre">v_n</span></code> with value <code class="docutils literal notranslate"><span class="pre">vr</span></code> at time index <code class="docutils literal notranslate"><span class="pre">step</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v_rest</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">==</span> <span class="n">vr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v_n</span><span class="p">[</span><span class="n">v_rest</span><span class="p">,</span><span class="n">step</span><span class="p">])</span>
  <span class="o">--&gt;</span> <span class="p">[</span><span class="n">vr</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">vr</span><span class="p">]</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">np.where</span></code> returns indexes of boolean arrays with <code class="docutils literal notranslate"><span class="pre">True</span></code> values.</p>
<p>You may use the helper function <code class="docutils literal notranslate"><span class="pre">plot_all</span></code> that implements the figure from the previous exercise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">plot_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize spikes and spikes_n</span>
<span class="n">spikes</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)}</span>
<span class="n">spikes_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1">#################################################</span>
<span class="c1">## TODO for students: use Boolean indexing ##</span>
<span class="c1"># Fill out function and remove</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: using Boolean indexing"</span><span class="p">)</span>
<span class="c1">#################################################</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Set relevant values of v_n to resting potential using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Collect spike times</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spiked</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">spikes_n</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Collect mean spiking rate</span>
<span class="n">spikes_mean</span> <span class="o">=</span> <span class="n">spikes_n</span> <span class="o">/</span> <span class="n">n</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">spikes</span><span class="o">=</span><span class="n">spikes</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="o">=</span><span class="n">spikes_mean</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solutions</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize spikes and spikes_n</span>
<span class="n">spikes</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)}</span>
<span class="n">spikes_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>

  <span class="c1"># Set relevant values of v_n to resting potential using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Collect spike times</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spiked</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">spikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">spikes_n</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Collect mean spiking rate</span>
<span class="n">spikes_mean</span> <span class="o">=</span> <span class="n">spikes_n</span> <span class="o">/</span> <span class="n">n</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">spikes</span><span class="o">=</span><span class="n">spikes</span><span class="p">,</span> <span class="n">spikes_mean</span><span class="o">=</span><span class="n">spikes_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-4-making-a-binary-raster-plot">
<h2>Coding Exercise 4: Making a binary raster plot<a class="headerlink" href="#coding-exercise-4-making-a-binary-raster-plot" title="Permalink to this headline">¶</a></h2>
<p>A <em>binary raster plot</em> represents spike times as <code class="docutils literal notranslate"><span class="pre">1</span></code>s in a binary grid initialized with <code class="docutils literal notranslate"><span class="pre">0</span></code>s. We start with a numpy array <code class="docutils literal notranslate"><span class="pre">raster</span></code> of zeros with shape <code class="docutils literal notranslate"><span class="pre">(neurons,</span> <span class="pre">time</span> <span class="pre">steps)</span></code>, and represent a spike from neuron <code class="docutils literal notranslate"><span class="pre">5</span></code> at time step <code class="docutils literal notranslate"><span class="pre">20</span></code> as <code class="docutils literal notranslate"><span class="pre">raster(5,20)=1</span></code>, for example.</p>
<p>The <em>binary raster plot</em> is much more efficient than the previous method by plotting the numpy array <code class="docutils literal notranslate"><span class="pre">raster</span></code> as an image:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys'</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Suggestions</strong></p>
<ul class="simple">
<li><p>At each time step:</p>
<ul>
<li><p>Initialize boolean numpy array <code class="docutils literal notranslate"><span class="pre">spiked</span></code> with <span class="math notranslate nohighlight">\(V_n(t)\geq V_{th}\)</span></p></li>
<li><p>Set to <code class="docutils literal notranslate"><span class="pre">vr</span></code> indexes of <code class="docutils literal notranslate"><span class="pre">v_n</span></code> using <code class="docutils literal notranslate"><span class="pre">spiked</span></code></p></li>
<li><p>Set to <code class="docutils literal notranslate"><span class="pre">1</span></code> indexes of numpy array <code class="docutils literal notranslate"><span class="pre">raster</span></code> using <code class="docutils literal notranslate"><span class="pre">spiked</span></code></p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################</span>
<span class="c1">## TODO for students: make a raster ##</span>
<span class="c1"># Fill out function and remove</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: make a raster "</span><span class="p">)</span>
<span class="c1">#################################################</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>

  <span class="c1"># Set relevant values of v_n to v_reset using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Set relevant elements in raster to 1 using spiked</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>

  <span class="c1"># Set relevant values of v_n to v_reset using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Set relevant elements in raster to 1 using spiked</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-4-refractory-period">
<h1>Section 4: Refractory period<a class="headerlink" href="#section-4-refractory-period" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-7-refractory-period">
<h2>Video 7: Refractory period<a class="headerlink" href="#video-7-refractory-period" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>The absolute refractory period is a time interval in the order of a few milliseconds during which synaptic input will not lead to a 2nd spike, no matter how strong. This effect is due to the biophysics of the neuron membrane channels, and you can read more about absolute and relative refractory period <a class="reference external" href="https://content.byui.edu/file/a236934c-3c60-4fe9-90aa-d343b3e3a640/1/module5/readings/refractory_periods.html">here</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Refractory_period_(physiology)">here</a>.</p>
<figure>
<img src="https://raw.githubusercontent.com/NeuromatchAcademy/precourse/main/tutorials/W0D2_PythonWorkshop2/static/refractory_period.png"/>
</figure></div>
<div class="section" id="video-8-nano-recap-of-refractory-period">
<h2>Video 8: Nano recap of refractory period<a class="headerlink" href="#video-8-nano-recap-of-refractory-period" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-5-investigating-refactory-periods">
<h2>Coding Exercise 5: Investigating refactory periods<a class="headerlink" href="#coding-exercise-5-investigating-refactory-periods" title="Permalink to this headline">¶</a></h2>
<p>Investigate the effect of (absolute) refractory period <span class="math notranslate nohighlight">\(t_{ref}\)</span> on the evolution of output rate <span class="math notranslate nohighlight">\(\lambda(t)\)</span>. Add refractory period <span class="math notranslate nohighlight">\(t_{ref}=10\)</span> ms after each spike, during which <span class="math notranslate nohighlight">\(V(t)\)</span> is clamped to <span class="math notranslate nohighlight">\(V_{reset}\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################</span>
<span class="c1">## TODO for students: add refactory period ##</span>
<span class="c1"># Fill out function and remove</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: add refactory period "</span><span class="p">)</span>
<span class="c1">#################################################</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize t_ref and last_spike</span>
<span class="n">t_ref</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>

  <span class="c1"># Set relevant values of v_n to v_reset using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Set relevant elements in raster to 1 using spiked</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

  <span class="c1"># Initialize boolean numpy array clamped using last_spike, t and t_ref</span>
  <span class="n">clamped</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Reset clamped neurons to vr using clamped</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">clamped</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Update numpy array last_spike with time t for spiking neurons</span>
  <span class="n">last_spike</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize t_ref and last_spike</span>
<span class="n">t_ref</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">[:,</span> <span class="n">step</span><span class="p">])</span>

  <span class="c1"># Initialize boolean numpy array `spiked` with v_n &gt; v_thr</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>

  <span class="c1"># Set relevant values of v_n to v_reset using spiked</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Set relevant elements in raster to 1 using spiked</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

  <span class="c1"># Initialize boolean numpy array clamped using last_spike, t and t_ref</span>
  <span class="n">clamped</span> <span class="o">=</span> <span class="p">(</span><span class="n">last_spike</span> <span class="o">+</span> <span class="n">t_ref</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">)</span>

  <span class="c1"># Reset clamped neurons to vr using clamped</span>
  <span class="n">v_n</span><span class="p">[</span><span class="n">clamped</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Update numpy array last_spike with time t for spiking neurons</span>
  <span class="n">last_spike</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-1-random-refractory-period">
<h2>Interactive Demo 1: Random refractory period<a class="headerlink" href="#interactive-demo-1-random-refractory-period" title="Permalink to this headline">¶</a></h2>
<p>In the following interactive demo, we will investigate the effect of random refractory periods. We will use random refactory periods <span class="math notranslate nohighlight">\(t_{ref}\)</span> with
<span class="math notranslate nohighlight">\(t_{ref} = \mu + \sigma\,\mathcal{N}\)</span>, where <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>, <span class="math notranslate nohighlight">\(\mu=0.01\)</span> and <span class="math notranslate nohighlight">\(\sigma=0.007\)</span>.</p>
<p>Refractory period samples <code class="docutils literal notranslate"><span class="pre">t_ref</span></code> of size <code class="docutils literal notranslate"><span class="pre">n</span></code> is initialized with <code class="docutils literal notranslate"><span class="pre">np.random.normal</span></code>. We clip negative values to <code class="docutils literal notranslate"><span class="pre">0</span></code> with boolean indexes. (Why?) You can double click the cell to see the hidden code.</p>
<p>You can play with the parameters mu and sigma and visualize the resulting simulation.
What is the effect of different <span class="math notranslate nohighlight">\(\sigma\)</span> values?</p>
<p>Execute this cell to enable the demo</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to enable the demo</span>

<span class="k">def</span> <span class="nf">random_ref_period</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
  <span class="c1"># set random number generator</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

  <span class="c1"># initialize step_end, t_range, n, v_n, syn and raster</span>
  <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
  <span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>
  <span class="n">syn</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">t_max</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

  <span class="c1"># initialize t_ref and last_spike</span>
  <span class="n">t_ref</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
  <span class="n">t_ref</span><span class="p">[</span><span class="n">t_ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">])</span>

  <span class="c1"># loop time steps</span>
  <span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
      <span class="k">continue</span>

    <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">syn</span><span class="p">[:,</span><span class="n">step</span><span class="p">])</span>

    <span class="c1"># boolean array spiked indexes neurons with v&gt;=vth</span>
    <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>
    <span class="n">v_n</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>
    <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

    <span class="c1"># boolean array clamped indexes refractory neurons</span>
    <span class="n">clamped</span> <span class="o">=</span> <span class="p">(</span><span class="n">last_spike</span> <span class="o">+</span> <span class="n">t_ref</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">v_n</span><span class="p">[</span><span class="n">clamped</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>
    <span class="n">last_spike</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

  <span class="c1"># plot multiple realizations of Vm, spikes and mean spike rate</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>

  <span class="c1"># plot histogram of t_ref</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t_ref</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">'stepfilled'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'C1'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$t_</span><span class="si">{ref}</span><span class="s1">$ (s)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'count'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">random_ref_period</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> \
                              <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-5-using-functions">
<h1>Section 5: Using functions<a class="headerlink" href="#section-5-using-functions" title="Permalink to this headline">¶</a></h1>
<p>Running key parts of your code inside functions improves your coding narrative by making it clearer and more flexible to future changes.</p>
<div class="section" id="video-9-functions">
<h2>Video 9: Functions<a class="headerlink" href="#video-9-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="video-10-nano-recap-of-functions">
<h2>Video 10: Nano recap of functions<a class="headerlink" href="#video-10-nano-recap-of-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-6-rewriting-code-with-functions">
<h2>Coding Exercise 6: Rewriting code with functions<a class="headerlink" href="#coding-exercise-6-rewriting-code-with-functions" title="Permalink to this headline">¶</a></h2>
<p>We will now re-organize parts of the code from the previous exercise with functions. You need to complete the function <code class="docutils literal notranslate"><span class="pre">spike_clamp()</span></code> to update <span class="math notranslate nohighlight">\(V(t)\)</span> and deal with spiking and refractoriness</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ode_step</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evolves membrane potential by one step of discrete time integration</span>

<span class="sd">  Args:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential at previous time step of shape (neurons)</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      synaptic input at current time step of shape (neurons)</span>

<span class="sd">    dt (float)</span>
<span class="sd">      time step increment</span>

<span class="sd">  Returns:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential at current time step of shape (neurons)</span>
<span class="sd">  """</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">spike_clamp</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">delta_spike</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Resets membrane potential of neurons if v&gt;= vth</span>
<span class="sd">  and clamps to vr if interval of time since last spike &lt; t_ref</span>

<span class="sd">  Args:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential of shape (neurons)</span>

<span class="sd">    delta_spike (numpy array of floats)</span>
<span class="sd">      interval of time since last spike of shape (neurons)</span>

<span class="sd">  Returns:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential of shape (neurons)</span>
<span class="sd">    spiked (numpy array of floats)</span>
<span class="sd">      boolean array of neurons that spiked  of shape (neurons)</span>
<span class="sd">  """</span>

  <span class="c1">####################################################</span>
  <span class="c1">## TODO for students: complete spike_clamp</span>
  <span class="c1"># Fill out function and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: complete spike_clamp"</span><span class="p">)</span>
  <span class="c1">####################################################</span>
  <span class="c1"># Boolean array spiked indexes neurons with v&gt;=vth</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">v</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Boolean array clamped indexes refractory neurons</span>
  <span class="n">clamped</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">v</span><span class="p">[</span><span class="n">clamped</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">spiked</span>


<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize t_ref and last_spike</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.007</span>
<span class="n">t_ref</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">t_ref</span><span class="p">[</span><span class="n">t_ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">ode_step</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>

  <span class="c1"># Reset membrane potential and clamp</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">spiked</span> <span class="o">=</span> <span class="n">spike_clamp</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">t</span> <span class="o">-</span> <span class="n">last_spike</span><span class="p">)</span>

  <span class="c1"># Update raster and last_spike</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
  <span class="n">last_spike</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ode_step</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Evolves membrane potential by one step of discrete time integration</span>

<span class="sd">  Args:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential at previous time step of shape (neurons)</span>

<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      synaptic input at current time step of shape (neurons)</span>

<span class="sd">    dt (float)</span>
<span class="sd">      time step increment</span>

<span class="sd">  Returns:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential at current time step of shape (neurons)</span>
<span class="sd">  """</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">v</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">v</span>

<span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">spike_clamp</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">delta_spike</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Resets membrane potential of neurons if v&gt;= vth</span>
<span class="sd">  and clamps to vr if interval of time since last spike &lt; t_ref</span>

<span class="sd">  Args:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential of shape (neurons)</span>

<span class="sd">    delta_spike (numpy array of floats)</span>
<span class="sd">      interval of time since last spike of shape (neurons)</span>

<span class="sd">  Returns:</span>
<span class="sd">    v (numpy array of floats)</span>
<span class="sd">      membrane potential of shape (neurons)</span>
<span class="sd">    spiked (numpy array of floats)</span>
<span class="sd">      boolean array of neurons that spiked  of shape (neurons)</span>
<span class="sd">  """</span>

  <span class="c1"># Boolean array spiked indexes neurons with v&gt;=vth</span>
  <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="n">vth</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="c1"># Boolean array clamped indexes refractory neurons</span>
  <span class="n">clamped</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_ref</span> <span class="o">&gt;</span> <span class="n">delta_spike</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="n">clamped</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">spiked</span>


<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize t_ref and last_spike</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.007</span>
<span class="n">t_ref</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">t_ref</span><span class="p">[</span><span class="n">t_ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">])</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Skip first iteration</span>
  <span class="k">if</span> <span class="n">step</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">continue</span>

  <span class="c1"># Compute v_n</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">ode_step</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>

  <span class="c1"># Reset membrane potential and clamp</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">spiked</span> <span class="o">=</span> <span class="n">spike_clamp</span><span class="p">(</span><span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">],</span> <span class="n">t</span> <span class="o">-</span> <span class="n">last_spike</span><span class="p">)</span>

  <span class="c1"># Update raster and last_spike</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">spiked</span><span class="p">,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
  <span class="n">last_spike</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-6-using-classes">
<h1>Section 6: Using classes<a class="headerlink" href="#section-6-using-classes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-11-classes">
<h2>Video 11: Classes<a class="headerlink" href="#video-11-classes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>Using classes helps with code reuse and reliability. Well-designed classes are like black boxes in that they receive inputs and provide expected outputs. The details of how the class processes inputs and produces outputs are unimportant.</p>
<p>See additional details here: <a class="reference external" href="https://en.wikibooks.org/wiki/A_Beginner%27s_Python_Tutorial/Classes">A Beginner’s Python Tutorial/Classes</a></p>
<p><em>Attributes</em> are variables internal to the class, and <em>methods</em> are functions internal to the class.</p>
</div>
<div class="section" id="video-12-nano-recap-of-classes">
<h2>Video 12: Nano recap of classes<a class="headerlink" href="#video-12-nano-recap-of-classes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="coding-exercise-7-making-a-lif-class">
<h2>Coding Exercise 7: Making a LIF class<a class="headerlink" href="#coding-exercise-7-making-a-lif-class" title="Permalink to this headline">¶</a></h2>
<p>In this exercise we’ll practice with Python classes by implementing <code class="docutils literal notranslate"><span class="pre">LIFNeurons</span></code>, a class that evolves and keeps state of multiple realizations of LIF neurons.</p>
<p>Several attributes are used to keep state of our neurons:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">v</span>             <span class="n">current</span> <span class="n">membrane</span> <span class="n">potential</span>
<span class="bp">self</span><span class="o">.</span><span class="n">spiked</span>        <span class="n">neurons</span> <span class="n">that</span> <span class="n">spiked</span>
<span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span>    <span class="n">last</span> <span class="n">spike</span> <span class="n">time</span> <span class="n">of</span> <span class="n">each</span> <span class="n">neuron</span>
<span class="bp">self</span><span class="o">.</span><span class="n">t</span>             <span class="n">running</span> <span class="n">time</span> <span class="n">of</span> <span class="n">the</span> <span class="n">simulation</span>
<span class="bp">self</span><span class="o">.</span><span class="n">steps</span>         <span class="n">simulation</span> <span class="n">step</span>
</pre></div>
</div>
<p>There is a single method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">ode_step</span><span class="p">()</span>    <span class="n">performs</span> <span class="n">single</span> <span class="n">step</span> <span class="n">discrete</span> <span class="n">time</span> <span class="n">integration</span>
                   <span class="k">for</span> <span class="n">provided</span> <span class="n">synaptic</span> <span class="n">current</span> <span class="ow">and</span> <span class="n">dt</span>
</pre></div>
</div>
<p>Complete the spike and clamp part of method <code class="docutils literal notranslate"><span class="pre">self.ode_step</span></code> (should be similar to function <code class="docutils literal notranslate"><span class="pre">spike_and_clamp</span></code> seen before).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulation class</span>
<span class="k">class</span> <span class="nc">LIFNeurons</span><span class="p">:</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Keeps track of membrane potential for multiple realizations of LIF neuron,</span>
<span class="sd">  and performs single step discrete time integration.</span>
<span class="sd">  """</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t_ref_mu</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t_ref_sigma</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
               <span class="n">tau</span><span class="o">=</span><span class="mf">20e-3</span><span class="p">,</span> <span class="n">el</span><span class="o">=-</span><span class="mf">60e-3</span><span class="p">,</span> <span class="n">vr</span><span class="o">=-</span><span class="mf">70e-3</span><span class="p">,</span> <span class="n">vth</span><span class="o">=-</span><span class="mf">50e-3</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">100e6</span><span class="p">):</span>

    <span class="c1"># Neuron count</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="c1"># Neuron parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span>        <span class="c1"># second</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">=</span> <span class="n">el</span>          <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vr</span> <span class="o">=</span> <span class="n">vr</span>          <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vth</span> <span class="o">=</span> <span class="n">vth</span>        <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>            <span class="c1"># ohm</span>

    <span class="c1"># Initializes refractory period distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_mu</span> <span class="o">=</span> <span class="n">t_ref_mu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_sigma</span> <span class="o">=</span> <span class="n">t_ref_sigma</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># State variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spiked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vth</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>


  <span class="k">def</span> <span class="nf">ode_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>

    <span class="c1"># Update running time and steps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># One step of discrete time integration of dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1">####################################################</span>
    <span class="c1">## TODO for students: complete the `ode_step` method</span>
    <span class="c1"># Fill out function and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: complete the ode_step method"</span><span class="p">)</span>
    <span class="c1">####################################################</span>

    <span class="c1"># Spike and clamp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spiked</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">clamped</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">clamped</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize neurons</span>
<span class="n">neurons</span> <span class="o">=</span> <span class="n">LIFNeurons</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Call ode_step method</span>
  <span class="n">neurons</span><span class="o">.</span><span class="n">ode_step</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">i</span><span class="p">[:,</span><span class="n">step</span><span class="p">])</span>

  <span class="c1"># Log v_n and spike history</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">neurons</span><span class="o">.</span><span class="n">v</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">neurons</span><span class="o">.</span><span class="n">spiked</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="c1"># Report running time and steps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Ran for </span><span class="si">{</span><span class="n">neurons</span><span class="o">.</span><span class="n">t</span><span class="si">:</span><span class="s1">.3</span><span class="si">}</span><span class="s1">s in </span><span class="si">{</span><span class="n">neurons</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s1"> steps.'</span><span class="p">)</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Simulation class</span>
<span class="k">class</span> <span class="nc">LIFNeurons</span><span class="p">:</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Keeps track of membrane potential for multiple realizations of LIF neuron,</span>
<span class="sd">  and performs single step discrete time integration.</span>
<span class="sd">  """</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t_ref_mu</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t_ref_sigma</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
               <span class="n">tau</span><span class="o">=</span><span class="mf">20e-3</span><span class="p">,</span> <span class="n">el</span><span class="o">=-</span><span class="mf">60e-3</span><span class="p">,</span> <span class="n">vr</span><span class="o">=-</span><span class="mf">70e-3</span><span class="p">,</span> <span class="n">vth</span><span class="o">=-</span><span class="mf">50e-3</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">100e6</span><span class="p">):</span>

    <span class="c1"># Neuron count</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="c1"># Neuron parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span>        <span class="c1"># second</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">=</span> <span class="n">el</span>          <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vr</span> <span class="o">=</span> <span class="n">vr</span>          <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vth</span> <span class="o">=</span> <span class="n">vth</span>        <span class="c1"># milivolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>            <span class="c1"># ohm</span>

    <span class="c1"># Initializes refractory period distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_mu</span> <span class="o">=</span> <span class="n">t_ref_mu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_sigma</span> <span class="o">=</span> <span class="n">t_ref_sigma</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_ref_sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># State variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spiked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vth</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>


  <span class="k">def</span> <span class="nf">ode_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>

    <span class="c1"># Update running time and steps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># One step of discrete time integration of dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">el</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># Spike and clamp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vth</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
    <span class="n">clamped</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_ref</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">clamped</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vr</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">last_spike</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>

<span class="c1"># Set random number generator</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Initialize step_end, t_range, n, v_n and i</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">step_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_range</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">v_n</span> <span class="o">=</span> <span class="n">el</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">i_mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_max</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">step_end</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize binary numpy array for raster plot</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">step_end</span><span class="p">])</span>

<span class="c1"># Initialize neurons</span>
<span class="n">neurons</span> <span class="o">=</span> <span class="n">LIFNeurons</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Loop over time steps</span>
<span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_range</span><span class="p">):</span>

  <span class="c1"># Call ode_step method</span>
  <span class="n">neurons</span><span class="o">.</span><span class="n">ode_step</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">i</span><span class="p">[:,</span><span class="n">step</span><span class="p">])</span>

  <span class="c1"># Log v_n and spike history</span>
  <span class="n">v_n</span><span class="p">[:,</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">neurons</span><span class="o">.</span><span class="n">v</span>
  <span class="n">raster</span><span class="p">[</span><span class="n">neurons</span><span class="o">.</span><span class="n">spiked</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="c1"># Report running time and steps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Ran for </span><span class="si">{</span><span class="n">neurons</span><span class="o">.</span><span class="n">t</span><span class="si">:</span><span class="s1">.3</span><span class="si">}</span><span class="s1">s in </span><span class="si">{</span><span class="n">neurons</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s1"> steps.'</span><span class="p">)</span>

<span class="c1"># Plot multiple realizations of Vm, spikes and mean spike rate</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_all</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">v_n</span><span class="p">,</span> <span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-12-last-concepts-recap">
<h2>Video 12: Last concepts &amp; recap<a class="headerlink" href="#video-12-last-concepts-recap" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W0D2_PythonWorkshop2/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="../chapter_title.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Python Workshop 2</p>
</div>
</a>
<a class="right-next" href="../../W0D3_LinearAlgebra/chapter_title.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Linear Algebra</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>