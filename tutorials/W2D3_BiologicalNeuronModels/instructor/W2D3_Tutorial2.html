
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 2: Effects of Input Correlation — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.jpg" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D3_Tutorial3.html" rel="next" title="Tutorial 3: Synaptic transmission - Models of static and dynamic synapses"/>
<link href="W2D3_Tutorial1.html" rel="prev" title="Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.jpg"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../instructor/intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelingPractice/chapter_title.html">
   Modeling Practice (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_ModelFitting/chapter_title.html">
   Model Fitting (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/instructor/W1D4_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_DeepLearning/chapter_title.html">
   Deep Learning (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: From Reinforcement Learning to Planning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction to projects
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: Effects of Input Correlation
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-correlations-synchrony">
   Section 1: Correlations (Synchrony)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#origin-of-synchronous-neuronal-activity">
     Origin of synchronous neuronal activity:
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#implications-of-synchrony">
     Implications of synchrony
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-input-output-correlations">
     Video 1: Input &amp; output correlations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1a-compute-the-correlation">
     Coding Exercise 1A: Compute the correlation
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1b-measure-the-correlation-between-spike-trains">
     Coding Exercise 1B: Measure the correlation between spike trains
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation">
   Section 2: Investigate the effect of input correlation on the output correlation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-input-and-output-correlations">
     Think! 2: Input and Output Correlations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-correlation-transfer-function">
   Section 3: Correlation transfer function
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-how-do-the-mean-and-standard-deviation-of-the-gaussian-white-noise-gwn-affect-the-correlation-transfer-function">
     Section 3.1: How do the mean and standard deviation of the Gaussian white noise (GWN) affect the correlation transfer function?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-gwn-and-the-correlation-transfer-function">
       Think! 3.1: GWN and the Correlation Transfer Function
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma">
     Section 3.2: What is the rationale behind varying
     <span class="math notranslate nohighlight">
      \(\mu\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     ?
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-correlations-and-network-activity">
   Think!: Correlations and Network Activity
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-ensemble-response">
     Bonus Section 1: Ensemble Response
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-response-of-ensemble-of-neurons-to-time-varying-input">
       Video 2: Response of ensemble of neurons to time-varying input
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 2: Effects of Input Correlation</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: Effects of Input Correlation
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-correlations-synchrony">
   Section 1: Correlations (Synchrony)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#origin-of-synchronous-neuronal-activity">
     Origin of synchronous neuronal activity:
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#implications-of-synchrony">
     Implications of synchrony
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-input-output-correlations">
     Video 1: Input &amp; output correlations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1a-compute-the-correlation">
     Coding Exercise 1A: Compute the correlation
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1b-measure-the-correlation-between-spike-trains">
     Coding Exercise 1B: Measure the correlation between spike trains
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation">
   Section 2: Investigate the effect of input correlation on the output correlation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-input-and-output-correlations">
     Think! 2: Input and Output Correlations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-correlation-transfer-function">
   Section 3: Correlation transfer function
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-how-do-the-mean-and-standard-deviation-of-the-gaussian-white-noise-gwn-affect-the-correlation-transfer-function">
     Section 3.1: How do the mean and standard deviation of the Gaussian white noise (GWN) affect the correlation transfer function?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-gwn-and-the-correlation-transfer-function">
       Think! 3.1: GWN and the Correlation Transfer Function
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma">
     Section 3.2: What is the rationale behind varying
     <span class="math notranslate nohighlight">
      \(\mu\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     ?
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-correlations-and-network-activity">
   Think!: Correlations and Network Activity
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-ensemble-response">
     Bonus Section 1: Ensemble Response
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-response-of-ensemble-of-neurons-to-time-varying-input">
       Video 2: Response of ensemble of neurons to time-varying input
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-2-effects-of-input-correlation">
<h1>Tutorial 2: Effects of Input Correlation<a class="headerlink" href="#tutorial-2-effects-of-input-correlation" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 3: Biological Neuron Models</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, John Murray, Richard Naud, Arvind Kumar</p>
<p><strong>Content reviewers:</strong> Maryam Vaziri-Pashkam, Ella Batty, Lorenzo Fontolan, Richard Gao, Matthew Krause, Spiros Chavlis, Michael Waskom</p>
<p><strong>Post-Production team:</strong> Gagana B, Spiros Chavlis</p>
<p><strong>Our 2021 Sponsors, including Presenting Sponsor Facebook Reality Labs</strong></p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 50 minutes</em></p>
<p>In this tutorial, we will use the leaky integrate-and-fire (LIF) neuron model (see Tutorial 1) to study how they transform input correlations to output properties (transfer of correlations). In particular, we are going to write a few lines of code to:</p>
<ul class="simple">
<li><p>inject correlated GWN in a pair of neurons</p></li>
<li><p>measure correlations between the spiking activity of the two neurons</p></li>
<li><p>study how the transfer of correlation depends on the statistics of the input, i.e. mean and standard deviation.</p></li>
</ul>
<div class="section" id="tutorial-slides">
<h2>Tutorial slides<a class="headerlink" href="#tutorial-slides" title="Permalink to this headline">¶</a></h2>
<p>These are the slides for the videos in all tutorials today</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<iframe allowfullscreen="" frameborder="0" height="480" src="https://mfr.ca-1.osf.io/render?url=https://osf.io/8djsm/?direct%26mode=render%26action=download%26mode=render" width="854"></iframe>
</div></div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle"</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting Functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>

<span class="k">def</span> <span class="nf">example_plot_myCC</span><span class="p">():</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

  <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span> <span class="o">=</span> <span class="n">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">r12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r12</span><span class="p">,</span> <span class="s1">'bo'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Simulation'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="s1">'k--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">,</span>
           <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'True CC'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Sample CC'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>



<span class="c1"># the function plot the raster of the Poisson spike train</span>
<span class="k">def</span> <span class="nf">my_raster_Poisson</span><span class="p">(</span><span class="n">range_t</span><span class="p">,</span> <span class="n">spike_train</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generates poisson trains</span>

<span class="sd">  Args:</span>
<span class="sd">    range_t     : time sequence</span>
<span class="sd">    spike_train : binary spike trains, with shape (N, Lt)</span>
<span class="sd">    n           : number of Poisson trains plot</span>

<span class="sd">  Returns:</span>
<span class="sd">    Raster plot of the spike train</span>
<span class="sd">  """</span>

  <span class="c1"># find the number of all the spike trains</span>
  <span class="n">N</span> <span class="o">=</span> <span class="n">spike_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># n should smaller than N:</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The number n exceeds the size of spike trains'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The number n is set to be the size of spike trains'</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span>

  <span class="c1"># plot rater</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spike_train</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
      <span class="n">t_sp</span> <span class="o">=</span> <span class="n">range_t</span><span class="p">[</span><span class="n">spike_train</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>  <span class="c1"># spike times</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sp</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_sp</span><span class="p">)),</span> <span class="s1">'k|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">range_t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">range_t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Neuron ID'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_c_r_LIF</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">mycolor</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">c_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_range</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_range</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper Functions</span>
<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1">### typical neuron parameters###</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>       <span class="c1"># leak conductance [nS]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>   <span class="c1"># initial potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span>       <span class="c1"># refractory time (ms)</span>

  <span class="c1">### simulation parameters ###</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">400.</span> <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>  <span class="c1"># Simulation time step [ms]</span>

  <span class="c1">### external parameters if any ###</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">])</span>  <span class="c1"># Vector of discretized</span>
                                                         <span class="c1"># time points [ms]</span>
  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Simulate the LIF dynamics with external input current</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    Iinj       : input current [pA]. The injected current here can be a value or an array</span>

<span class="sd">  Returns:</span>
<span class="sd">    rec_spikes : spike times</span>
<span class="sd">    rec_v      : mebrane potential</span>
<span class="sd">  """</span>

  <span class="c1"># Set parameters</span>
  <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span>
  <span class="n">tau_m</span><span class="p">,</span> <span class="n">g_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span>
  <span class="n">V_init</span><span class="p">,</span> <span class="n">V_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span>

  <span class="c1"># Initialize voltage and current</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>
  <span class="n">Iinj</span> <span class="o">=</span> <span class="n">Iinj</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>

  <span class="c1"># simulate the LIF dynamics</span>
  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># record spike times</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>  <span class="c1"># reset voltage and record spike event</span>
      <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>

    <span class="c1"># calculate the increment of the membrane potential</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">V_L</span><span class="p">)</span> <span class="o">+</span> <span class="n">Iinj</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">/</span> <span class="n">g_L</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_m</span><span class="p">)</span>

    <span class="c1"># update the membrane potential</span>
    <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span>


<span class="k">def</span> <span class="nf">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Function that calculates Gaussian white noise inputs</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    mu         : noise baseline (mean)</span>
<span class="sd">    sig        : noise amplitute (standard deviation)</span>
<span class="sd">    myseed     : random seed. int or boolean</span>
<span class="sd">                 the same seed will give the same random number sequence</span>

<span class="sd">  Returns:</span>
<span class="sd">    I          : Gaussian white noise input</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Set random seed. You can fix the seed of the random number generator so</span>
  <span class="c1"># that the results are reliable however, when you want to generate multiple</span>
  <span class="c1"># realization make sure that you change the seed for each new realization</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># generate GWN</span>
  <span class="c1"># we divide here by 1000 to convert units to sec.</span>
  <span class="n">I_GWN</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">I_GWN</span>


<span class="k">def</span> <span class="nf">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">bin_size</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
  <span class="sd">""" Simulates two LIF neurons with correlated input and computes output correlation</span>

<span class="sd">  Args:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  mu         : noise baseline (mean)</span>
<span class="sd">  sig        : noise amplitute (standard deviation)</span>
<span class="sd">  c          : correlation coefficient ~[0, 1]</span>
<span class="sd">  bin_size   : bin size used for time series</span>
<span class="sd">  n_trials   : total simulation trials</span>

<span class="sd">  Returns:</span>
<span class="sd">  r          : output corr. coe.</span>
<span class="sd">  sp_rate    : spike rate</span>
<span class="sd">  sp1        : spike times of neuron 1 in the last trial</span>
<span class="sd">  sp2        : spike times of neuron 2 in the last trial</span>
<span class="sd">  """</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
  <span class="n">sp_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i_trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span> <span class="o">=</span> <span class="n">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">sp1</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I1gL</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I2gL</span><span class="p">)</span>

    <span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>

    <span class="n">sp1_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
    <span class="n">sp2_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>

    <span class="n">r12</span><span class="p">[</span><span class="n">i_trial</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">sp1_count</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">sp2_count</span><span class="p">[::</span><span class="mi">20</span><span class="p">])</span>
    <span class="n">sp_rate</span><span class="p">[</span><span class="n">i_trial</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">)</span> <span class="o">/</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1000.</span>

  <span class="k">return</span> <span class="n">r12</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sp_rate</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span>
</pre></div>
</div>
</div>
</div>
<p>The helper function contains the:</p>
<ul class="simple">
<li><p>Parameter dictionary: <code class="docutils literal notranslate"><span class="pre">default_pars(</span> <span class="pre">**kwargs)</span></code> from Tutorial 1</p></li>
<li><p>LIF simulator: <code class="docutils literal notranslate"><span class="pre">run_LIF</span></code> from Tutorial 1</p></li>
<li><p>Gaussian white noise generator: <code class="docutils literal notranslate"><span class="pre">my_GWN(pars,</span> <span class="pre">sig,</span> <span class="pre">myseed=False)</span></code> from Tutorial 1</p></li>
<li><p>Poisson type spike train generator: <code class="docutils literal notranslate"><span class="pre">Poisson_generator(pars,</span> <span class="pre">rate,</span> <span class="pre">n,</span> <span class="pre">myseed=False)</span></code></p></li>
<li><p>Two LIF neurons with correlated inputs simulator: <code class="docutils literal notranslate"><span class="pre">LIF_output_cc(pars,</span> <span class="pre">mu,</span> <span class="pre">sig,</span> <span class="pre">c,</span> <span class="pre">bin_size,</span> <span class="pre">n_trials=20)</span></code></p></li>
</ul>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-correlations-synchrony">
<h1>Section 1: Correlations (Synchrony)<a class="headerlink" href="#section-1-correlations-synchrony" title="Permalink to this headline">¶</a></h1>
<p>Correlation or synchrony in neuronal activity can be described for any readout of brain activity. Here, we are concerned with the spiking activity of neurons.</p>
<p>In the simplest way, correlation/synchrony refers to coincident spiking of neurons, i.e., when two neurons spike together, they are firing in <strong>synchrony</strong> or are <strong>correlated</strong>. Neurons can be synchronous in their instantaneous activity, i.e., they spike together with some probability. However, it is also possible that spiking of a neuron at time <span class="math notranslate nohighlight">\(t\)</span> is correlated with the spikes of another neuron with a delay (time-delayed synchrony).</p>
<div class="section" id="origin-of-synchronous-neuronal-activity">
<h2>Origin of synchronous neuronal activity:<a class="headerlink" href="#origin-of-synchronous-neuronal-activity" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Common inputs, i.e., two neurons are receiving input from the same sources. The degree of correlation of the shared inputs is proportional to their output correlation.</p></li>
<li><p>Pooling from the same sources. Neurons do not share the same input neurons but are receiving inputs from neurons which themselves are correlated.</p></li>
<li><p>Neurons are connected to each other (uni- or bi-directionally): This will only give rise to time-delayed synchrony. Neurons could also be connected via gap-junctions.</p></li>
<li><p>Neurons have similar parameters and initial conditions.</p></li>
</ul>
</div>
<div class="section" id="implications-of-synchrony">
<h2>Implications of synchrony<a class="headerlink" href="#implications-of-synchrony" title="Permalink to this headline">¶</a></h2>
<p>When neurons spike together, they can have a stronger impact on downstream neurons. Synapses in the brain are sensitive to the temporal correlations (i.e., delay) between pre- and postsynaptic activity, and this, in turn, can lead to the formation of functional neuronal networks - the basis of unsupervised learning (we will study some of these concepts in a forthcoming tutorial).</p>
<p>Synchrony implies a reduction in the dimensionality of the system. In addition, correlations, in many cases, can impair the decoding of neuronal activity.</p>
</div>
<div class="section" id="video-1-input-output-correlations">
<h2>Video 1: Input &amp; output correlations<a class="headerlink" href="#video-1-input-output-correlations" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9c4ffe7dbb6d4871a9e5beffb3821a15"}
</script></div>
</div>
<p>A simple model to study the emergence of correlations is to inject common inputs to a pair of neurons and measure the output correlation as a function of the fraction of common inputs.</p>
<p>Here, we are going to investigate the transfer of correlations by computing the correlation coefficient of spike trains recorded from two unconnected LIF neurons, which received correlated inputs.</p>
<p>The input current to LIF neuron <span class="math notranslate nohighlight">\(i\)</span> <span class="math notranslate nohighlight">\((i=1,2)\)</span> is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-99fb63ff-b3b1-431a-80a5-fff0b8828be7">
<span class="eqno">(163)<a class="headerlink" href="#equation-99fb63ff-b3b1-431a-80a5-fff0b8828be7" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{I_i}{g_L} = \mu_i + \sigma_i (\sqrt{1-c}\xi_i + \sqrt{c}\xi_c) \quad (1)
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the temporal average of the current. The Gaussian white noise <span class="math notranslate nohighlight">\(\xi_i\)</span> is independent for each neuron, while <span class="math notranslate nohighlight">\(\xi_c\)</span> is common to all neurons. The variable <span class="math notranslate nohighlight">\(c\)</span> (<span class="math notranslate nohighlight">\(0\le c\le1\)</span>) controls the fraction of common and independent inputs. <span class="math notranslate nohighlight">\(\sigma_i\)</span> shows the variance of the total input.</p>
<p>So, first, we will generate correlated inputs.</p>
<p>Execute this cell to get a function <code class="docutils literal notranslate"><span class="pre">correlate_input</span></code> for generating correlated GWN inputs</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to get a function `correlate_input` for generating correlated GWN inputs</span>
<span class="k">def</span> <span class="nf">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    mu         : noise baseline (mean)</span>
<span class="sd">    sig        : noise amplitute (standard deviation)</span>
<span class="sd">    c.         : correlation coefficient ~[0, 1]</span>

<span class="sd">  Returns:</span>
<span class="sd">    I1gL, I2gL : two correlated inputs with corr. coe. c</span>
<span class="sd">  """</span>

  <span class="c1"># generate Gaussian whute noise xi_1, xi_2, xi_c</span>
  <span class="n">xi_1</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
  <span class="n">xi_2</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
  <span class="n">xi_c</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>

  <span class="c1"># Generate two correlated inputs by Equation. (1)</span>
  <span class="n">I1gL</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_c</span>
  <span class="n">I2gL</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_c</span>

  <span class="k">return</span> <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span>

<span class="n">help</span><span class="p">(</span><span class="n">correlate_input</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function correlate_input in module __main__:

correlate_input(pars, mu=20.0, sig=7.5, c=0.3)
    Args:
      pars       : parameter dictionary
      mu         : noise baseline (mean)
      sig        : noise amplitute (standard deviation)
      c.         : correlation coefficient ~[0, 1]
    
    Returns:
      I1gL, I2gL : two correlated inputs with corr. coe. c
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-1a-compute-the-correlation">
<h2>Coding Exercise 1A: Compute the correlation<a class="headerlink" href="#coding-exercise-1a-compute-the-correlation" title="Permalink to this headline">¶</a></h2>
<p>The <em>sample correlation coefficient</em> between two input currents <span class="math notranslate nohighlight">\(I_i\)</span> and <span class="math notranslate nohighlight">\(I_j\)</span> is defined as the sample covariance of <span class="math notranslate nohighlight">\(I_i\)</span> and <span class="math notranslate nohighlight">\(I_j\)</span> divided by the square root of the sample variance of <span class="math notranslate nohighlight">\(I_i\)</span> multiplied with the square root of the sample variance of <span class="math notranslate nohighlight">\(I_j\)</span>. In equation form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-199fe93f-28ef-43ef-b713-57a87ccce41f">
<span class="eqno">(164)<a class="headerlink" href="#equation-199fe93f-28ef-43ef-b713-57a87ccce41f" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_{ij} &amp;= \frac{cov(I_i, I_j)}{\sqrt{var(I_i)} \sqrt{var(I_j)}}\\
cov(I_i, I_j) &amp;= \sum_{k=1}^L (I_i^k -\bar{I}_i)(I_j^k -\bar{I}_j) \\
var(I_i) &amp;= \sum_{k=1}^L (I_i^k -\bar{I}_i)^2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{I}_i\)</span> is the sample mean, k is the time bin, and L is the length of <span class="math notranslate nohighlight">\(I\)</span>.  This means that <span class="math notranslate nohighlight">\(I_i^k\)</span> is current i at time <span class="math notranslate nohighlight">\(k\cdot dt\)</span>. Note that the equations above are not accurate for sample covariances and variances as they should be additionally divided by L-1 - we have dropped this term because it cancels out in the sample correlation coefficient formula.</p>
<p>The <em>sample correlation coefficient</em> may also be referred to as the <em>sample Pearson correlation coefficient</em>. Here, is a beautiful paper that explains multiple ways to calculate and understand correlations <a class="reference external" href="https://www.stat.berkeley.edu/~rabbee/correlation.pdf">Rodgers and Nicewander 1988</a>.</p>
<p>In this exercise, we will create a function, <code class="docutils literal notranslate"><span class="pre">my_CC</span></code> to compute the sample correlation coefficient between two time series. Note that while we introduced this computation here in the context of input currents, the sample correlation coefficient is used to compute the correlation between any two time series - we will use it later on binned spike trains.</p>
<p>We then check our method is accurate by generating currents with a certain correlation (using <code class="docutils literal notranslate"><span class="pre">correlate_input</span></code>), computing the correlation coefficient using <code class="docutils literal notranslate"><span class="pre">my_CC</span></code>, and plotting the true vs sample correlation coefficients.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">my_CC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    i, j  : two time series with the same length</span>

<span class="sd">  Returns:</span>
<span class="sd">    rij   : correlation coefficient</span>
<span class="sd">  """</span>
  <span class="c1">########################################################################</span>
  <span class="c1">## TODO for students: compute rxy, then remove the NotImplementedError #</span>
  <span class="c1"># Tip1: array([a1, a2, a3])*array([b1, b2, b3]) = array([a1*b1, a2*b2, a3*b3])</span>
  <span class="c1"># Tip2: np.sum(array([a1, a2, a3])) = a1+a2+a3</span>
  <span class="c1"># Tip3: square root, np.sqrt()</span>
  <span class="c1"># Fill out function and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the sample correlation coefficient"</span><span class="p">)</span>
  <span class="c1">########################################################################</span>

  <span class="c1"># Calculate the covariance of i and j</span>
  <span class="n">cov</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Calculate the variance of i</span>
  <span class="n">var_i</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Calculate the variance of j</span>
  <span class="n">var_j</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Calculate the correlation coefficient</span>
  <span class="n">rij</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rij</span>

<span class="n">example_plot_myCC</span><span class="p">()</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">my_CC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    i, j  : two time series with the same length</span>

<span class="sd">  Returns:</span>
<span class="sd">    rij   : correlation coefficient</span>
<span class="sd">  """</span>

  <span class="c1"># Calculate the covariance of i and j</span>
  <span class="n">cov</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">i</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">j</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

  <span class="c1"># Calculate the variance of i</span>
  <span class="n">var_i</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">i</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">i</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

  <span class="c1"># Calculate the variance of j</span>
  <span class="n">var_j</span> <span class="o">=</span> <span class="p">((</span><span class="n">j</span> <span class="o">-</span> <span class="n">j</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">j</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

  <span class="c1"># Calculate the correlation coefficient</span>
  <span class="n">rij</span> <span class="o">=</span> <span class="n">cov</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_i</span><span class="o">*</span><span class="n">var_j</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">rij</span>


<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">example_plot_myCC</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/W2D3_Tutorial2_24_0.png" src="../../../_images/W2D3_Tutorial2_24_0.png"/>
</div>
</div>
<p>The sample correlation coefficients (computed using <code class="docutils literal notranslate"><span class="pre">my_CC</span></code>) match the ground truth correlation coefficient!</p>
<p>In the next exercise, we will use the Poisson distribution to model spike trains. Remember that you have seen the Poisson distribution used in this way in the <a class="reference external" href="https://compneuro.neuromatch.io/tutorials/W0D5_Statistics/student/W0D5_Tutorial1.html#section-2-2-poisson-distribution">pre-reqs math day on Statistics</a>. Remember that a Poisson spike train has the following properties:</p>
<ul class="simple">
<li><p>The ratio of the mean and variance of spike count is 1</p></li>
<li><p>Inter-spike-intervals are exponentially distributed</p></li>
<li><p>Spike times are irregular i.e. 𝐶𝑉ISI=1</p></li>
<li><p>Adjacent spike intervals are independent of each other.</p></li>
</ul>
<p>In the following cell, we provide a helper function <code class="docutils literal notranslate"><span class="pre">Poisson_generator</span></code> and then use it to produce a Poisson spike train.</p>
<p>Execute this cell to get helper function <code class="docutils literal notranslate"><span class="pre">Poisson_generator</span></code></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to get helper function `Poisson_generator`</span>
<span class="k">def</span> <span class="nf">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generates poisson trains</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    rate       : noise amplitute [Hz]</span>
<span class="sd">    n          : number of Poisson trains</span>
<span class="sd">    myseed     : random seed. int or boolean</span>

<span class="sd">  Returns:</span>
<span class="sd">    pre_spike_train : spike train matrix, ith row represents whether</span>
<span class="sd">                      there is a spike in ith spike train over time</span>
<span class="sd">                      (1 if spike, 0 otherwise)</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># set random seed</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># generate uniformly distributed random variables</span>
  <span class="n">u_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># generate Poisson train</span>
  <span class="n">poisson_train</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="p">(</span><span class="n">u_rand</span> <span class="o">&lt;</span> <span class="n">rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">poisson_train</span>

<span class="n">help</span><span class="p">(</span><span class="n">Poisson_generator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function Poisson_generator in module __main__:

Poisson_generator(pars, rate, n, myseed=False)
    Generates poisson trains
    
    Args:
      pars       : parameter dictionary
      rate       : noise amplitute [Hz]
      n          : number of Poisson trains
      myseed     : random seed. int or boolean
    
    Returns:
      pre_spike_train : spike train matrix, ith row represents whether
                        there is a spike in ith spike train over time
                        (1 if spike, 0 otherwise)
</pre></div>
</div>
</div>
</div>
<p>Execute this cell to visualize Poisson spike train</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to visualize Poisson spike train</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">pre_spike_train</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">my_raster_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">pre_spike_train</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/W2D3_Tutorial2_30_0.png" src="../../../_images/W2D3_Tutorial2_30_0.png"/>
</div>
</div>
</div>
<div class="section" id="coding-exercise-1b-measure-the-correlation-between-spike-trains">
<h2>Coding Exercise 1B: Measure the correlation between spike trains<a class="headerlink" href="#coding-exercise-1b-measure-the-correlation-between-spike-trains" title="Permalink to this headline">¶</a></h2>
<p>After recording the spike times of the two neurons, how can we estimate their correlation coefficient?</p>
<p>In order to find this, we need to bin the spike times and obtain two time series. Each data point in the time series is the number of spikes in the corresponding time bin. You can use <code class="docutils literal notranslate"><span class="pre">np.histogram()</span></code> to bin the spike times.</p>
<p>Complete the code below to bin the spike times and calculate the correlation coefficient for two Poisson spike trains. Note that <code class="docutils literal notranslate"><span class="pre">c</span></code> here is the ground-truth correlation coefficient that we define.</p>
<p>Execute this cell to get a function for generating correlated Poisson inputs (<code class="docutils literal notranslate"><span class="pre">generate_corr_Poisson</span></code>)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to get a function for generating correlated Poisson inputs (`generate_corr_Poisson`)</span>


<span class="k">def</span> <span class="nf">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">poi_rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  function to generate correlated Poisson type spike trains</span>
<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    poi_rate   : rate of the Poisson train</span>
<span class="sd">    c.         : correlation coefficient ~[0, 1]</span>

<span class="sd">  Returns:</span>
<span class="sd">    sp1, sp2   : two correlated spike time trains with corr. coe. c</span>
<span class="sd">  """</span>

  <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>

  <span class="n">mother_rate</span> <span class="o">=</span> <span class="n">poi_rate</span> <span class="o">/</span> <span class="n">c</span>
  <span class="n">mother_spike_train</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">mother_rate</span><span class="p">,</span>
                                         <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">sp_mother</span> <span class="o">=</span> <span class="n">range_t</span><span class="p">[</span><span class="n">mother_spike_train</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

  <span class="n">L_sp_mother</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">)</span>
  <span class="n">sp_mother_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L_sp_mother</span><span class="p">)</span>
  <span class="n">L_sp_corr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">L_sp_mother</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sp_mother_id</span><span class="p">)</span>
  <span class="n">sp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">[</span><span class="n">sp_mother_id</span><span class="p">[:</span><span class="n">L_sp_corr</span><span class="p">]])</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sp_mother_id</span><span class="p">)</span>
  <span class="n">sp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">[</span><span class="n">sp_mother_id</span><span class="p">[:</span><span class="n">L_sp_corr</span><span class="p">]])</span>

  <span class="k">return</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">generate_corr_Poisson</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function generate_corr_Poisson in module __main__:

generate_corr_Poisson(pars, poi_rate, c, myseed=False)
    function to generate correlated Poisson type spike trains
    Args:
      pars       : parameter dictionary
      poi_rate   : rate of the Poisson train
      c.         : correlation coefficient ~[0, 1]
    
    Returns:
      sp1, sp2   : two correlated spike time trains with corr. coe. c

None
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">corr_coeff_pairs</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">trials</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Calculate the correlation coefficient of two spike trains, for different</span>
<span class="sd">  realizations</span>

<span class="sd">  Args:</span>
<span class="sd">      pars   : parameter dictionary</span>
<span class="sd">      rate   : rate of poisson inputs</span>
<span class="sd">      c      : correlation coefficient ~ [0, 1]</span>
<span class="sd">      trials  : number of realizations</span>
<span class="sd">      bins   : vector with bins for time discretization</span>

<span class="sd">  Returns:</span>
<span class="sd">    r12      : correlation coefficient of a pair of inputs</span>
<span class="sd">  """</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="c1">##############################################################</span>
    <span class="c1">## TODO for students</span>
    <span class="c1"># Note that you can run multiple realizations and compute their r_12(diff_trials)</span>
    <span class="c1"># with the defined function above. The average r_12 over trials can get close to c.</span>
    <span class="c1"># Note: change seed to generate different input per trial</span>
    <span class="c1"># Fill out function and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the correlation coefficient"</span><span class="p">)</span>
    <span class="c1">##############################################################</span>

    <span class="c1"># Generate correlated Poisson inputs</span>
    <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the first input</span>
    <span class="n">sp1_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bins</span><span class="o">=...</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the second input</span>
    <span class="n">sp2_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bins</span><span class="o">=...</span><span class="p">)</span>

    <span class="c1"># Calculate the correlation coefficient</span>
    <span class="n">r12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">r12</span>


<span class="n">poi_rate</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># set true correlation</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># bin the spike time</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># [ms]</span>
<span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100 realizations</span>

<span class="n">r12</span> <span class="o">=</span> <span class="n">corr_coeff_pairs</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">poi_rate</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'True corr coe = </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Simu corr coe = </span><span class="si">{</span><span class="n">r12</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">corr_coeff_pairs</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">trials</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Calculate the correlation coefficient of two spike trains, for different</span>
<span class="sd">  realizations</span>

<span class="sd">  Args:</span>
<span class="sd">      pars   : parameter dictionary</span>
<span class="sd">      rate   : rate of poisson inputs</span>
<span class="sd">      c      : correlation coefficient ~ [0, 1]</span>
<span class="sd">      trials  : number of realizations</span>
<span class="sd">      bins   : vector with bins for time discretization</span>

<span class="sd">  Returns:</span>
<span class="sd">    r12      : correlation coefficient of a pair of inputs</span>
<span class="sd">  """</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="c1"># Generate correlated Poisson inputs</span>
    <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">poi_rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the first input</span>
    <span class="n">sp1_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the second input</span>
    <span class="n">sp2_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

    <span class="c1"># Calculate the correlation coefficient</span>
    <span class="n">r12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">sp1_count</span><span class="p">,</span> <span class="n">sp2_count</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">r12</span>


<span class="n">poi_rate</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># set true correlation</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># bin the spike time</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># [ms]</span>
<span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100 realizations</span>

<span class="n">r12</span> <span class="o">=</span> <span class="n">corr_coeff_pairs</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">poi_rate</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'True corr coe = </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Simu corr coe = </span><span class="si">{</span><span class="n">r12</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True corr coe = 0.200
Simu corr coe = 0.197
</pre></div>
</div>
</div>
</div>
<p>Sample output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span> <span class="n">corr</span> <span class="n">coe</span> <span class="o">=</span> <span class="mf">0.200</span>
<span class="n">Simu</span> <span class="n">corr</span> <span class="n">coe</span> <span class="o">=</span> <span class="mf">0.197</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation">
<h1>Section 2: Investigate the effect of input correlation on the output correlation<a class="headerlink" href="#section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 20 min</em></p>
<p>Now let’s combine the aforementioned two procedures. We first generate the correlated inputs. Then we inject the correlated inputs <span class="math notranslate nohighlight">\(I_1, I_2\)</span> into a pair of neurons and record their output spike times. We continue measuring the correlation between the output and
investigate the relationship between the input correlation and the output correlation.</p>
<p>In the following, you will inject correlated GWN in two neurons. You need to define the mean (<code class="docutils literal notranslate"><span class="pre">gwn_mean</span></code>), standard deviation (<code class="docutils literal notranslate"><span class="pre">gwn_std</span></code>), and input correlations (<code class="docutils literal notranslate"><span class="pre">c_in</span></code>).</p>
<p>We will simulate <span class="math notranslate nohighlight">\(10\)</span> trials to get a better estimate of the output correlation. Change the values in the following cell for the above variables (and then run the next cell) to explore how they impact the output correlation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Play around with these parameters</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># get the parameters</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># set input correlation value</span>
<span class="n">gwn_mean</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">gwn_std</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Do not forget to execute this cell to simulate the LIF</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Do not forget to execute this cell to simulate the LIF</span>


<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>  <span class="c1"># ms</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># time clock</span>

<span class="n">r12_ss</span><span class="p">,</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">gwn_mean</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">gwn_std</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">,</span>
                                        <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># just the time counter</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Input correlation = </span><span class="si">{</span><span class="n">c_in</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Output correlation = </span><span class="si">{</span><span class="n">r12_ss</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 1'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 2'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron id.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulation time = 0.04 min
Input correlation = 0.3
Output correlation = 0.12232593975880897
</pre></div>
</div>
<img alt="../../../_images/W2D3_Tutorial2_42_1.png" src="../../../_images/W2D3_Tutorial2_42_1.png"/>
</div>
</div>
</div>
<div class="section" id="think-2-input-and-output-correlations">
<h2>Think! 2: Input and Output Correlations<a class="headerlink" href="#think-2-input-and-output-correlations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Is the output correlation always smaller than the input correlation? If yes, why?</p></li>
<li><p>Should there be a systematic relationship between input and output correlations?</p></li>
</ul>
<p>You will explore these questions in the next figure but try to develop your own intuitions first!</p>
<p>Let’s vary <code class="docutils literal notranslate"><span class="pre">c_in</span></code> and plot the relationship between the <code class="docutils literal notranslate"><span class="pre">c_in</span></code> and output correlation. This might take some time depending on the number of trials.</p>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Don’t forget to execute this cell!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>

<span class="c1">#@markdown Don't forget to execute this cell!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># get the parameters</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># set the range for input CC</span>
<span class="n">r12_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>  <span class="c1"># small mu, small sigma</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="c1"># time clock</span>
<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">)):</span>
  <span class="n">r12_ss</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ss</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="p">[</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="s1">'k--'</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Input CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulation time = 0.45 min
</pre></div>
</div>
<img alt="../../../_images/W2D3_Tutorial2_47_1.png" src="../../../_images/W2D3_Tutorial2_47_1.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Discussion: The results above show that</span>
<span class="sd">- output correlation is smaller than input correlation</span>
<span class="sd">- output correlation varies linearly as a function of input correlation.</span>

<span class="sd">While the general result holds, this relationship might change depending on the neuron type.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-correlation-transfer-function">
<h1>Section 3: Correlation transfer function<a class="headerlink" href="#section-3-correlation-transfer-function" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 30 min</em></p>
<p>The above plot of input correlation vs. output correlation is called the <strong>correlation transfer function</strong> of the neurons.</p>
<div class="section" id="section-3-1-how-do-the-mean-and-standard-deviation-of-the-gaussian-white-noise-gwn-affect-the-correlation-transfer-function">
<h2>Section 3.1: How do the mean and standard deviation of the Gaussian white noise (GWN) affect the correlation transfer function?<a class="headerlink" href="#section-3-1-how-do-the-mean-and-standard-deviation-of-the-gaussian-white-noise-gwn-affect-the-correlation-transfer-function" title="Permalink to this headline">¶</a></h2>
<p>The correlations transfer function appears to be linear. The above can be taken as the input/output transfer function of LIF neurons for correlations, instead of the transfer function for input/output firing rates as we had discussed in the previous tutorial (i.e., F-I curve).</p>
<p>What would you expect to happen to the slope of the correlation transfer function if you vary the mean and/or the standard deviation of the GWN of the inputs ?</p>
<p>Execute this cell to visualize correlation transfer functions</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to visualize correlation transfer functions</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span> <span class="c1"># get the parameters</span>
<span class="n">no_trial</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># set the range for input CC</span>
<span class="n">r12_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># small mu, small sigma</span>
<span class="n">r12_ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># large mu, small sigma</span>
<span class="n">r12_sl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># small mu, large sigma</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># time clock</span>
<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">)):</span>
  <span class="n">r12_ss</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
  <span class="n">r12_ls</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ls</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
  <span class="n">r12_sl</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_sl</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ss</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Small $\mu$, small $\sigma$'</span><span class="p">)</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ls</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Large $\mu$, small $\sigma$'</span><span class="p">)</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_sl</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Small $\mu$, large $\sigma$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="p">[</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="s1">'k--'</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Input CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_13732</span><span class="o">/</span><span class="mf">1647026019.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>                                               <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>                                               <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">19</span>   <span class="n">r12_sl</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_sl</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span>                                               <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>                                               <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>

<span class="nn">/tmp/ipykernel_13732/3952591084.py</span> in <span class="ni">LIF_output_cc</span><span class="nt">(pars, mu, sig, c, bin_size, n_trials)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span> <span class="o">=</span> <span class="n">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span>     <span class="n">_</span><span class="p">,</span> <span class="n">sp1</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I1gL</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">133</span>     <span class="n">_</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I2gL</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span> 
<span class="g g-Whitespace">    </span><span class="mi">135</span>     <span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>

<span class="nn">/tmp/ipykernel_13732/3952591084.py</span> in <span class="ni">run_LIF</span><span class="nt">(pars, Iinj)</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> 
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="c1"># update the membrane potential</span>
<span class="ne">---&gt; </span><span class="mi">69</span>     <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> 
<span class="g g-Whitespace">     </span><span class="mi">71</span>   <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="section" id="think-3-1-gwn-and-the-correlation-transfer-function">
<h3>Think! 3.1: GWN and the Correlation Transfer Function<a class="headerlink" href="#think-3-1-gwn-and-the-correlation-transfer-function" title="Permalink to this headline">¶</a></h3>
<p>Why do both the mean and the standard deviation of the GWN affect the slope of the correlation transfer function?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Discussion: This has got to do with which part of the input current distribution</span>
<span class="sd">is transferred to the spiking activity.</span>

<span class="sd">Intuitive understanding is difficult but this relationship arises due to non-linearities</span>
<span class="sd">in the neuron F-I curve.  When F-I curve is linear, output correlation is independent</span>
<span class="sd">of the mean and standard deviation. But this relationship arises even in neurons with</span>
<span class="sd">threshold-linear F-I curve.</span>

<span class="sd">Please see:</span>
<span class="sd">De La Rocha J, Doiron B, Shea-Brown E, Josić K, Reyes A. Correlation between</span>
<span class="sd">neural spike trains increases with firing rate. Nature. 2007 Aug;448(7155):802-6.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma">
<h2>Section 3.2: What is the rationale behind varying <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>?<a class="headerlink" href="#section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma" title="Permalink to this headline">¶</a></h2>
<p>The mean and the variance of the synaptic current depends on the spike rate of a Poisson process. We can use something called <a class="reference external" href="https://en.wikipedia.org/wiki/Campbell%27s_theorem_(probability)">Campbell’s theorem</a> to estimate the mean and the variance of the synaptic current:</p>
<div class="amsmath math notranslate nohighlight" id="equation-fa9e80ea-2c85-4130-9aee-a949d267d215">
<span class="eqno">(165)<a class="headerlink" href="#equation-fa9e80ea-2c85-4130-9aee-a949d267d215" title="Permalink to this equation">¶</a></span>\[\begin{align}
\mu_{\rm syn} = \lambda J \int P(t) \\
\sigma_{\rm syn} = \lambda J \int P(t)^2 dt
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is the firing rate of the Poisson input, <span class="math notranslate nohighlight">\(J\)</span> the amplitude of the postsynaptic current and <span class="math notranslate nohighlight">\(P(t)\)</span> is the shape of the postsynaptic current as a function of time.</p>
<p>Therefore, when we varied <span class="math notranslate nohighlight">\(\mu\)</span> and/or <span class="math notranslate nohighlight">\(\sigma\)</span> of the GWN, we mimicked a change in the input firing rate. Note that, if we change the firing rate, both <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> will change simultaneously, not independently.</p>
<p>Here, since we observe an effect of <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> on correlation transfer, this implies that the input rate has an impact on the correlation transfer function.</p>
</div>
</div>
<div class="section" id="think-correlations-and-network-activity">
<h1>Think!: Correlations and Network Activity<a class="headerlink" href="#think-correlations-and-network-activity" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>What are the factors that would make output correlations smaller than input correlations? (Notice that the colored lines are below the black dashed line)</p></li>
<li><p>What does the fact that output correlations are smaller mean for the correlations throughout a network?</p></li>
<li><p>Here we have studied the transfer of correlations by injecting GWN. But in the previous tutorial, we mentioned that GWN is unphysiological. Indeed, neurons receive colored noise (i.e., Shot noise or OU process). How do these results obtained from injection of GWN apply to the case where correlated spiking inputs are injected in the two LIFs? Will the results be the same or different?</p></li>
</ul>
<br/>
<p>References:</p>
<ul class="simple">
<li><p>De La Rocha, Jaime, et al. “Correlation between neural spike trains increases with firing rate.” Nature (2007) (https://www.nature.com/articles/nature06028/)</p></li>
<li><p>Bujan AF, Aertsen A, Kumar A. Role of input correlations in shaping the variability and noise correlations of evoked activity in the neocortex. Journal of Neuroscience. 2015 Jun 3;35(22):8611-25. (https://www.jneurosci.org/content/35/22/8611)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Discussion:</span>

<span class="sd">1. Anything that tries to reduce the mean or variance of the input e.g. mean can</span>
<span class="sd">be reduced by inhibition, sigma can be reduced by the membrane time constant.</span>
<span class="sd">Obviously, if the two neurons have different parameters that will decorrelate them.</span>
<span class="sd">But more importantly, it is the slope of neuron transfer function that will affect the</span>
<span class="sd">output correlation.</span>

<span class="sd">2. These observations pose an interesting problem at the network level. If the</span>
<span class="sd">output correlation are smaller than the input correlation, then the network activity</span>
<span class="sd">should eventually converge to zero correlation. But that does not happen. So there</span>
<span class="sd">is something missing in this model to understand the origin of synchrony in the network.</span>

<span class="sd">3. For spike trains, we do not have explicit control over mu and sigma but these</span>
<span class="sd">two variables will be tied to the firing rate of the inputs. So the</span>
<span class="sd">results will be qualitatively similar. But when we think of multiple spike inputs</span>
<span class="sd">two different types of correlations arise (see Bujan et al. 2015 for more info)</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 50 minutes</em></p>
<p>In this tutorial, we studied how the input correlation of two LIF neurons is mapped to their output correlation. Specifically, we:</p>
<ul class="simple">
<li><p>injected correlated GWN in a pair of neurons,</p></li>
<li><p>measured correlations between the spiking activity of the two neurons, and</p></li>
<li><p>studied how the transfer of correlation depends on the statistics of the input, i.e., mean and standard deviation.</p></li>
</ul>
<p>Here, we were concerned with zero time lag correlation. For this reason, we restricted estimation of correlation to instantaneous correlations. If you are interested in time-lagged correlation, then we should estimate the cross-correlogram of the spike trains and find out the dominant peak and area under the peak to get an estimate of output correlations.</p>
<p>We leave this as a future to-do for you if you are interested.</p>
<p>If you have time, check out the bonus video to think about responses of ensembles of neurons to time-varying input.</p>
</div>
<hr class="docutils"/>
<div class="section" id="bonus">
<h1>Bonus<a class="headerlink" href="#bonus" title="Permalink to this headline">¶</a></h1>
<hr class="docutils"/>
<div class="section" id="bonus-section-1-ensemble-response">
<h2>Bonus Section 1: Ensemble Response<a class="headerlink" href="#bonus-section-1-ensemble-response" title="Permalink to this headline">¶</a></h2>
<p>Finally, there is a short BONUS lecture video on the firing response of an ensemble of neurons to time-varying input. There are no associated coding exercises - just enjoy.</p>
<div class="section" id="video-2-response-of-ensemble-of-neurons-to-time-varying-input">
<h3>Video 2: Response of ensemble of neurons to time-varying input<a class="headerlink" href="#video-2-response-of-ensemble-of-neurons-to-time-varying-input" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D3_BiologicalNeuronModels/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W2D3_Tutorial1.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model</p>
</div>
</a>
<a class="right-next" href="W2D3_Tutorial3.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Tutorial 3: Synaptic transmission - Models of static and dynamic synapses</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
  
      © Copyright 2021.<br/>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>