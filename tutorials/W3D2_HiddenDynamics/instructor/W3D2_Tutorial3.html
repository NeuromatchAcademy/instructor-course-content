
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 3: The Kalman Filter — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W3D2_Tutorial4.html" rel="next" title="Bonus Tutorial 4: The Kalman Filter, part 2"/>
<link href="W3D2_Tutorial2.html" rel="prev" title="Tutorial 2: Hidden Markov Model"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training - Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: The Kalman Filter
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-astrocat-dynamics">
   Section 1: Astrocat Dynamics
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-astrocat-through-time">
     Video 1: Astrocat through time
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-quantifying-astrocat-dynamics">
     Video 2: Quantifying Astrocat dynamics
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-simulating-astrocat-s-movements">
     Section 1.1: Simulating Astrocat’s movements
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-simulating-astrocat-s-movements">
       Coding Exercise 1.1: Simulating Astrocat’s movements
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-playing-with-astrocat-movement">
       Interactive Demo 1.1: Playing with Astrocat movement
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-exercise-1-1-discussion">
         Video 3: Exercise 1.1 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-measuring-astrocat-s-movements">
     Section 1.2: Measuring Astrocat’s movements
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-1-reading-measurements-from-astrocat-s-collar">
       Coding Exercise 1.2.1: Reading measurements from Astrocat’s collar
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-reading-measurements-from-astrocat-s-collar">
         Video 4: Reading measurements from Astrocat’s collar
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-exercise-1-2-1-discussion">
         Video 5: Exercise 1.2.1 Discussion
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-2-compare-true-states-to-measured-states">
       Coding Exercise 1.2.2: Compare true states to measured states
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-comparing-true-states-to-measured-states">
         Video 6: Comparing true states to measured states
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-exercise-1-2-2-discussion">
         Video 7: Exercise 1.2.2 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-the-kalman-filter">
   Section 2: The Kalman filter
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-using-the-kalman-filter">
     Section 2.1: Using the Kalman filter
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-the-kalman-filter">
       Video 8: The Kalman filter
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-1-the-kalman-filter-in-action">
       Interactive Demo 2.1: The Kalman filter in action
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-interactive-demo-2-1-discussion">
         Video 9: Interactive Demo 2.1 Discussion
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-implement-your-own-kalman-filter">
       Coding Exercise 2.1: Implement your own Kalman filter
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-10-implementing-a-kalman-filter">
         Video 10: Implementing a Kalman filter
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-11-exercise-2-1-discussion">
         Video 11: Exercise 2.1 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-estimation-accuracy">
     Section 2.2: Estimation accuracy
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-compare-states-estimates-and-measurements">
       Interactive Demo 2.2: Compare states, estimates, and measurements
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-compare-states-estimates-and-measurements">
         Video 12: Compare states, estimates, and measurements
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-13-interactive-demo-2-2-discussion">
         Video 13: Interactive Demo 2.2 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-3-searching-for-astrocat">
     Section 2.3: Searching for Astrocat
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-3-how-long-does-it-take-to-find-astrocat">
       Interactive Demo 2.3: How long does it take to find astrocat?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-14-how-long-does-it-take-to-find-astrocat">
         Video 14: How long does it take to find astrocat?
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-15-interactive-demo-2-3-discussion">
         Video 15: Interactive Demo 2.3 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 3: The Kalman Filter</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 3: The Kalman Filter
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-astrocat-dynamics">
   Section 1: Astrocat Dynamics
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-astrocat-through-time">
     Video 1: Astrocat through time
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-quantifying-astrocat-dynamics">
     Video 2: Quantifying Astrocat dynamics
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-simulating-astrocat-s-movements">
     Section 1.1: Simulating Astrocat’s movements
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-simulating-astrocat-s-movements">
       Coding Exercise 1.1: Simulating Astrocat’s movements
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-playing-with-astrocat-movement">
       Interactive Demo 1.1: Playing with Astrocat movement
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-exercise-1-1-discussion">
         Video 3: Exercise 1.1 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-measuring-astrocat-s-movements">
     Section 1.2: Measuring Astrocat’s movements
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-1-reading-measurements-from-astrocat-s-collar">
       Coding Exercise 1.2.1: Reading measurements from Astrocat’s collar
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-reading-measurements-from-astrocat-s-collar">
         Video 4: Reading measurements from Astrocat’s collar
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-exercise-1-2-1-discussion">
         Video 5: Exercise 1.2.1 Discussion
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-2-compare-true-states-to-measured-states">
       Coding Exercise 1.2.2: Compare true states to measured states
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-comparing-true-states-to-measured-states">
         Video 6: Comparing true states to measured states
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-exercise-1-2-2-discussion">
         Video 7: Exercise 1.2.2 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-the-kalman-filter">
   Section 2: The Kalman filter
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-using-the-kalman-filter">
     Section 2.1: Using the Kalman filter
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-the-kalman-filter">
       Video 8: The Kalman filter
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-1-the-kalman-filter-in-action">
       Interactive Demo 2.1: The Kalman filter in action
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-interactive-demo-2-1-discussion">
         Video 9: Interactive Demo 2.1 Discussion
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-implement-your-own-kalman-filter">
       Coding Exercise 2.1: Implement your own Kalman filter
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-10-implementing-a-kalman-filter">
         Video 10: Implementing a Kalman filter
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-11-exercise-2-1-discussion">
         Video 11: Exercise 2.1 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-estimation-accuracy">
     Section 2.2: Estimation accuracy
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-compare-states-estimates-and-measurements">
       Interactive Demo 2.2: Compare states, estimates, and measurements
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-12-compare-states-estimates-and-measurements">
         Video 12: Compare states, estimates, and measurements
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-13-interactive-demo-2-2-discussion">
         Video 13: Interactive Demo 2.2 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-3-searching-for-astrocat">
     Section 2.3: Searching for Astrocat
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-3-how-long-does-it-take-to-find-astrocat">
       Interactive Demo 2.3: How long does it take to find astrocat?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-14-how-long-does-it-take-to-find-astrocat">
         Video 14: How long does it take to find astrocat?
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-15-interactive-demo-2-3-discussion">
         Video 15: Interactive Demo 2.3 Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-3-the-kalman-filter">
<h1>Tutorial 3: The Kalman Filter<a class="headerlink" href="#tutorial-3-the-kalman-filter" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 3, Day 2: Hidden Dynamics</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Itzel Olivos Castillo and Xaq Pitkow</p>
<p><strong>Post-production team:</strong> Gagana B, Spiros Chavlis</p>
<p><strong>Useful reference:</strong></p>
<ul class="simple">
<li><p>Roweis, Ghahramani (1998): A unifying review of linear Gaussian Models</p></li>
<li><p>Bishop (2006): Pattern Recognition and Machine Learning</p></li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 1 hour, 15 minutes</em></p>
<p>In previous tutorials we used Hidden Markov Models (HMM) to infer <em>discrete</em> latent states from a sequence of measurements. In this tutorial, we will learn how to infer a <em>continuous</em> latent variable using the Kalman filter, which is one version of an HMM.</p>
<br/>
<p>In this tutorial, you will:</p>
<ul class="simple">
<li><p>Review linear dynamical systems</p></li>
<li><p>Learn about the Kalman filter in one dimension</p></li>
<li><p>Manipulate parameters of a process to see how the Kalman filter behaves</p></li>
<li><p>Think about some core properties of the Kalman filter.</p></li>
</ul>
<p>You can imagine this inference process happening as Mission Control tries to locate and track Astrocat. But you can also imagine that the brain is using an analogous Hidden Markov Model to track objects in the world, or to estimate the consequences of its own actions. And you could use this technique to estimate brain activity from noisy measurements, for understanding or for building a brain-machine interface.</p>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">interact</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span><span class="n">VBox</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting Functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>

<span class="k">def</span> <span class="nf">visualize_Astrocat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">T</span><span class="p">],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time t'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'s(t)'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_measurement</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'true position'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">T</span><span class="p">],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'measurement'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time t'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'s(t)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_function</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Y1"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span><span class="s2">"y2"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span><span class="s2">"y3"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                    <span class="s2">"y4"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span><span class="s2">"y5"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span><span class="s2">"y6"</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)})</span>
    <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper Functions</span>

<span class="n">gaussian</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Gaussian'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'cov'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">todays_prior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span> <span class="o">+</span> <span class="n">process_noise</span><span class="p">)</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">)</span>

    <span class="n">info_prior</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">todays_prior</span><span class="o">.</span><span class="n">cov</span>
    <span class="n">info_likelihood</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">likelihood</span><span class="o">.</span><span class="n">cov</span>
    <span class="n">info_posterior</span> <span class="o">=</span> <span class="n">info_prior</span> <span class="o">+</span> <span class="n">info_likelihood</span>

    <span class="n">prior_weight</span> <span class="o">=</span> <span class="n">info_prior</span> <span class="o">/</span> <span class="n">info_posterior</span>
    <span class="n">likelihood_weight</span> <span class="o">=</span> <span class="n">info_likelihood</span> <span class="o">/</span> <span class="n">info_posterior</span>
    <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">prior_weight</span> <span class="o">*</span> <span class="n">todays_prior</span><span class="o">.</span><span class="n">mean</span>  <span class="o">+</span>  <span class="n">likelihood_weight</span> <span class="o">*</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">mean</span>

    <span class="n">posterior_cov</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">info_posterior</span>
    <span class="n">todays_posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="n">posterior_cov</span><span class="p">)</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    prior = gaussian(belief.mean, belief.cov)</span>

<span class="sd">    predicted_estimate = D * belief.mean</span>
<span class="sd">    predicted_covariance = D**2 * belief.cov + process_noise</span>

<span class="sd">    likelihood = gaussian(m, measurement_noise)</span>
<span class="sd">    innovation_estimate = m - predicted_estimate</span>
<span class="sd">    innovation_covariance = predicted_covariance + measurement_noise</span>

<span class="sd">    K = predicted_covariance / innovation_covariance  # Kalman gain, i.e. the weight given to the difference between the measurement and predicted measurement</span>
<span class="sd">    updated_mean = predicted_estimate + K * innovation_estimate</span>
<span class="sd">    updated_cov = (1 - K) * predicted_covariance</span>
<span class="sd">    todays_posterior = gaussian(updated_mean, updated_cov)</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">todays_prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">todays_posterior</span>


<span class="k">def</span> <span class="nf">paintMyFilter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">cov_</span><span class="p">):</span>
    <span class="c1"># Compare solution with filter function</span>

    <span class="n">filter_s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># estimate (posterior mean)</span>
    <span class="n">filter_cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># uncertainty (posterior covariance)</span>

    <span class="n">posterior</span> <span class="o">=</span> <span class="n">initial_guess</span>
    <span class="n">filter_s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
    <span class="n">filter_cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

    <span class="n">process_noise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">process_noise</span><span class="p">)</span>
    <span class="n">measurement_noise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">measurement_noise</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">posterior</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">filter_s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
        <span class="n">filter_cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

    <span class="n">smin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span><span class="nb">min</span><span class="p">(</span><span class="n">s_</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">smax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span><span class="nb">max</span><span class="p">(</span><span class="n">s_</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">pscale</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># scaling factor for displaying pdfs</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'state'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">pscale</span><span class="p">)])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Astrocat´s trajectory'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'measurements'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filter_s_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'correct estimated trajectory'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">filter_s_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="s1">'! :)'</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">s_</span> <span class="o">-</span> <span class="n">filter_s_</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="k">else</span> <span class="s1">' :('</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'lightgray'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'your estimated trajectory'</span> <span class="o">+</span> <span class="n">res</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">s_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'lightgray'</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-astrocat-dynamics">
<h1>Section 1: Astrocat Dynamics<a class="headerlink" href="#section-1-astrocat-dynamics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-1-astrocat-through-time">
<h2>Video 1: Astrocat through time<a class="headerlink" href="#video-1-astrocat-through-time" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="video-2-quantifying-astrocat-dynamics">
<h2>Video 2: Quantifying Astrocat dynamics<a class="headerlink" href="#video-2-quantifying-astrocat-dynamics" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="section-1-1-simulating-astrocat-s-movements">
<h2>Section 1.1: Simulating Astrocat’s movements<a class="headerlink" href="#section-1-1-simulating-astrocat-s-movements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coding-exercise-1-1-simulating-astrocat-s-movements">
<h3>Coding Exercise 1.1: Simulating Astrocat’s movements<a class="headerlink" href="#coding-exercise-1-1-simulating-astrocat-s-movements" title="Permalink to this headline">¶</a></h3>
<p>First, you will simulate how Astrocat moves based on stochastic linear dynamics.</p>
<p>The linear dynamical system <span class="math notranslate nohighlight">\(s_t = Ds_{t-1} + w_{t-1}\)</span> determines Astrocat’s position <span class="math notranslate nohighlight">\(s_t\)</span>. <span class="math notranslate nohighlight">\(D\)</span> is a scalar that models how Astrocat would like to change its position over time, and <span class="math notranslate nohighlight">\(w_t \sim \mathcal{N}(0, \sigma_p^2)\)</span> is white Gaussian noise caused by unreliable actuators in Astrocat’s propulsion unit.</p>
<p>Complete the code below to simulate possible trajectories.</p>
<p>First, execute the following cell to enable the default parameters we will use in this tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fixed params</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">T_max</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tau_min</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tau_max</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">process_noise_min</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">process_noise_max</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">measurement_noise_min</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">measurement_noise_max</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">unit_process_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>  <span class="c1"># compute all N(0, 1) in advance to speed up time slider</span>
<span class="n">unit_measurement_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>  <span class="c1"># compute all N(0, 1) in advance to speed up time slider</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute the response of the linear dynamical system.</span>

<span class="sd">  Args:</span>
<span class="sd">    D (scalar): dynamics multiplier</span>
<span class="sd">    s0 (scalar): initial position</span>
<span class="sd">    sigma_p (scalar): amount of noise in the system (standard deviation)</span>
<span class="sd">    T (scalar): total duration of the simulation</span>

<span class="sd">  Returns:</span>
<span class="sd">    ndarray: `s`: astrocat's trajectory up to time T</span>
<span class="sd">  """</span>

  <span class="c1"># Initialize variables</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s0</span>

  <span class="c1"># Compute the position at time t given the position at time t-1 for all t</span>
  <span class="c1"># Consider that np.random.normal(mu, sigma) generates a random sample from</span>
  <span class="c1"># a gaussian with mean = mu and standard deviation = sigma</span>

  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

    <span class="c1">###################################################################</span>
    <span class="c1">## Fill out the following then remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: need to implement simulation"</span><span class="p">)</span>
    <span class="c1">###################################################################</span>

    <span class="c1"># Update position</span>
    <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">s</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set parameters</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">visualize_Astrocat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute the response of the linear dynamical system.</span>

<span class="sd">  Args:</span>
<span class="sd">    D (scalar): dynamics multiplier</span>
<span class="sd">    s0 (scalar): initial position</span>
<span class="sd">    sigma_p (scalar): amount of noise in the system (standard deviation)</span>
<span class="sd">    T (scalar): total duration of the simulation</span>

<span class="sd">  Returns:</span>
<span class="sd">    ndarray: `s`: astrocat's trajectory up to time T</span>
<span class="sd">  """</span>

  <span class="c1"># Initialize variables</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s0</span>

  <span class="c1"># Compute the position at time t given the position at time t-1 for all t</span>
  <span class="c1"># Consider that np.random.normal(mu, sigma) generates a random sample from</span>
  <span class="c1"># a gaussian with mean = mu and standard deviation = sigma</span>

  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

    <span class="c1"># Update position</span>
    <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">s</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set parameters</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">visualize_Astrocat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-1-1-playing-with-astrocat-movement">
<h3>Interactive Demo 1.1: Playing with Astrocat movement<a class="headerlink" href="#interactive-demo-1-1-playing-with-astrocat-movement" title="Permalink to this headline">¶</a></h3>
<p>We will use the function you just implemented in a demo, where you can change the value of <span class="math notranslate nohighlight">\(D\)</span> and see what happens.</p>
<ol class="simple">
<li><p>What happens when D is large (&gt;1)? Why?</p></li>
<li><p>What happens when D is a large negative number (&lt;-1)? Why?</p></li>
<li><p>What about when D is zero?</p></li>
</ol>
<p>Execute this cell to enable the demo</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to enable the demo</span>


<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=-</span><span class="mf">.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">):</span>

    <span class="c1"># Set parameters</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
    <span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>

    <span class="c1"># Simulate Astrocat</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

    <span class="c1"># Visualize</span>
    <span class="n">visualize_Astrocat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1) When D is large, the state at time step t will depend heavily on the state at time</span>
<span class="sd">   step t_1. If we forget about the noise term, D = 2 would mean that the state at each</span>
<span class="sd">   time step is double the one before! So the state becomes huge and basically explodes towards</span>
<span class="sd">   infinity.</span>

<span class="sd">2) If D is a large negative number, the state at time t will be a different sign than the</span>
<span class="sd">   state at time step t_1. So the state will oscillate over the x axis.</span>

<span class="sd">3) When D is zero, the state at time t will not depend on the previous state, it will just</span>
<span class="sd">   be drawn from the noise distribution.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="video-3-exercise-1-1-discussion">
<h4>Video 3: Exercise 1.1 Discussion<a class="headerlink" href="#video-3-exercise-1-1-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<div class="section" id="section-1-2-measuring-astrocat-s-movements">
<h2>Section 1.2: Measuring Astrocat’s movements<a class="headerlink" href="#section-1-2-measuring-astrocat-s-movements" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 10 min</em></p>
<div class="section" id="coding-exercise-1-2-1-reading-measurements-from-astrocat-s-collar">
<h3>Coding Exercise 1.2.1: Reading measurements from Astrocat’s collar<a class="headerlink" href="#coding-exercise-1-2-1-reading-measurements-from-astrocat-s-collar" title="Permalink to this headline">¶</a></h3>
<div class="section" id="video-4-reading-measurements-from-astrocat-s-collar">
<h4>Video 4: Reading measurements from Astrocat’s collar<a class="headerlink" href="#video-4-reading-measurements-from-astrocat-s-collar" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p>We will estimate Astrocat’s actual position using measurements of a noisy sensor attached to its collar.</p>
<p>Complete the function below to read measurements from Astrocat’s collar. These measurements are correct except for additive Gaussian noise whose standard deviation is given by the input argument <code class="docutils literal notranslate"><span class="pre">sigma_measurements</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute the measurements of the noisy sensor attached to astrocat's collar</span>

<span class="sd">  Args:</span>
<span class="sd">    s (ndarray): astrocat's true position over time</span>
<span class="sd">    sigma_measurements (scalar): amount of noise in the sensor (standard deviation)</span>

<span class="sd">  Returns:</span>
<span class="sd">    ndarray: `m`: astrocat's position over time according to the sensor</span>
<span class="sd">  """</span>

  <span class="c1"># Initialize variables</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

  <span class="c1"># For all time t, add white Gaussian noise with magnitude sigma_measurements</span>
  <span class="c1"># Consider that np.random.normal(mu, sigma) generates a random sample from</span>
  <span class="c1"># a gaussian with mean = mu and standard deviation = sigma</span>

  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

    <span class="c1">###################################################################</span>
    <span class="c1">## Fill out the following then remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: need to implement read_collar function"</span><span class="p">)</span>
    <span class="c1">###################################################################</span>

    <span class="c1"># Read measurement</span>
    <span class="n">m</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">m</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>
<span class="n">sigma_measurements</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># amount of noise in astrocat's collar</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Take measurement from collar</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">plot_measurement</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute the measurements of the noisy sensor attached to astrocat's collar</span>

<span class="sd">  Args:</span>
<span class="sd">    s (ndarray): astrocat's true position over time</span>
<span class="sd">    sigma_measurements (scalar): amount of noise in the sensor (standard deviation)</span>

<span class="sd">  Returns:</span>
<span class="sd">    ndarray: `m`: astrocat's position over time according to the sensor</span>
<span class="sd">  """</span>

  <span class="c1"># Initialize variables</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

  <span class="c1"># For all time t, add white Gaussian noise with magnitude sigma_measurements</span>
  <span class="c1"># Consider that np.random.normal(mu, sigma) generates a random sample from</span>
  <span class="c1"># a gaussian with mean = mu and standard deviation = sigma</span>

  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

    <span class="c1"># Read measurement</span>
    <span class="n">m</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">m</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>
<span class="n">sigma_measurements</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># amount of noise in astrocat's collar</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Take measurement from collar</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_measurement</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-5-exercise-1-2-1-discussion">
<h4>Video 5: Exercise 1.2.1 Discussion<a class="headerlink" href="#video-5-exercise-1-2-1-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
<div class="section" id="coding-exercise-1-2-2-compare-true-states-to-measured-states">
<h3>Coding Exercise 1.2.2: Compare true states to measured states<a class="headerlink" href="#coding-exercise-1-2-2-compare-true-states-to-measured-states" title="Permalink to this headline">¶</a></h3>
<div class="section" id="video-6-comparing-true-states-to-measured-states">
<h4>Video 6: Comparing true states to measured states<a class="headerlink" href="#video-6-comparing-true-states-to-measured-states" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p>Make a scatter plot to see how bad the measurements of Astrocat’s collar are. This exercise will show why using only the measures to track Astrocat can be catastrophic.</p>
<p>A Kalman filter will solve this problem!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute a scatter plot</span>

<span class="sd">  Args:</span>
<span class="sd">    s (ndarray): astrocat's true position over time</span>
<span class="sd">    m (ndarray): astrocat's measured position over time according to the sensor</span>

<span class="sd">  """</span>
  <span class="c1">###################################################################</span>
  <span class="c1">## Fill out the following then remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: need to implement compare function"</span><span class="p">)</span>
  <span class="c1">###################################################################</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">sbounds</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>    <span class="c1"># plot line of equality</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'state'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'measurement'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

  <span class="c1"># Complete a scatter plot: true state versus measurements</span>
  <span class="o">...</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>
<span class="n">sigma_measurements</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># amount of noise in astrocat's collar</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Take measurement from collar</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">)</span>

<span class="c1"># Visualize true vs measured states</span>
<span class="n">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">  </span><span class="sd">""" Compute a scatter plot</span>

<span class="sd">  Args:</span>
<span class="sd">    s (ndarray): astrocat's true position over time</span>
<span class="sd">    m (ndarray): astrocat's measured position over time according to the sensor</span>

<span class="sd">  """</span>
  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">sbounds</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>    <span class="c1"># plot line of equality</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'state'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'measurement'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

  <span class="c1"># Complete a scatter plot: true state versus measurements</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.9</span>    <span class="c1"># parameter in s(t)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># total time duration</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">5.</span>     <span class="c1"># initial condition of s at time 0</span>
<span class="n">sigma_p</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># amount of noise in the actuators of astrocat's propulsion unit</span>
<span class="n">sigma_measurements</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># amount of noise in astrocat's collar</span>

<span class="c1"># Simulate Astrocat</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">sigma_p</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># Take measurement from collar</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">read_collar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">sigma_measurements</span><span class="p">)</span>

<span class="c1"># Visualize true vs measured states</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">compare</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-7-exercise-1-2-2-discussion">
<h4>Video 7: Exercise 1.2.2 Discussion<a class="headerlink" href="#video-7-exercise-1-2-2-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-the-kalman-filter">
<h1>Section 2: The Kalman filter<a class="headerlink" href="#section-2-the-kalman-filter" title="Permalink to this headline">¶</a></h1>
<div class="section" id="section-2-1-using-the-kalman-filter">
<h2>Section 2.1: Using the Kalman filter<a class="headerlink" href="#section-2-1-using-the-kalman-filter" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 20 min</em></p>
<div class="section" id="video-8-the-kalman-filter">
<h3>Video 8: The Kalman filter<a class="headerlink" href="#video-8-the-kalman-filter" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="interactive-demo-2-1-the-kalman-filter-in-action">
<h3>Interactive Demo 2.1: The Kalman filter in action<a class="headerlink" href="#interactive-demo-2-1-the-kalman-filter-in-action" title="Permalink to this headline">¶</a></h3>
<p>Next we provide you with an interactive visualization to understand how the Kalman filter works. Play with the sliders to gain an intuition for how the different factors affect the Kalman filter’s inferences. You will code the Kalman filter yourself in the next exercise.</p>
<p>The sliders:</p>
<ul class="simple">
<li><p>current time: Kalman filter synthesizes measurements up until this time.</p></li>
<li><p>dynamics time constant <span class="math notranslate nohighlight">\(\tau\)</span>: this determines the dynamics value, <span class="math notranslate nohighlight">\(D=\exp^{-\Delta t/\tau}\)</span> where <span class="math notranslate nohighlight">\(\Delta t\)</span> is the discrete time step (here 1).</p></li>
<li><p>process noise: amount of noise in the actuators of astrocat’s propulsion unit</p></li>
<li><p>observation noise: the noise levels of our measurements (when we read the collar)</p></li>
</ul>
<p>Some questions to consider:</p>
<ul class="simple">
<li><p>What affects the predictability of Astrocat?</p></li>
<li><p>How does confidence change over time?</p></li>
<li><p>What affects the relative weight of the new measurement?</p></li>
<li><p>How is the error related to the posterior variance?</p></li>
</ul>
<p>Execute this cell to enable the demo. It takes a few seconds to update so please be patient.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to enable the demo. It takes a few seconds to update so please be patient.</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'''&lt;style&gt;.widget-label { min-width: 15ex !important; }&lt;/style&gt;'''</span><span class="p">))</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">T_max</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"current time"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">tau</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">tau_max</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'dynamics time constant'</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">tau_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">tau_max</span><span class="p">),</span>
                  <span class="n">process_noise</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"process noise"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">process_noise_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">process_noise_max</span><span class="p">),</span>
                  <span class="n">measurement_noise</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"observation noise"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">measurement_noise_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">measurement_noise_max</span><span class="p">),</span>
                  <span class="n">flag_s</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'state'</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                  <span class="n">flag_m</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'measurement'</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                  <span class="n">flag_s_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'estimate'</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                  <span class="n">flag_err_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'estimator confidence intervals'</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">stochastic_system</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">flag_m</span><span class="p">,</span> <span class="n">flag_s_</span><span class="p">,</span> <span class="n">flag_err_</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>              <span class="c1"># timeline</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>                     <span class="c1"># states</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>                      <span class="c1"># dynamics multiplier (matrix if s is vector)</span>
    <span class="n">process_noise_cov</span> <span class="o">=</span> <span class="n">process_noise</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">measurement_noise_cov</span> <span class="o">=</span> <span class="n">measurement_noise</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">prior_mean</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prior_cov</span> <span class="o">=</span> <span class="n">process_noise_cov</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prior_cov</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_process_noise</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># Sample initial condition from equilibrium distribution</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># measurement</span>
    <span class="n">s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># estimate (posterior mean)</span>
    <span class="n">cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># uncertainty (posterior covariance)</span>

    <span class="n">s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_mean</span>
    <span class="n">cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_cov</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_cov</span><span class="p">)</span>

    <span class="n">captured_prior</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">captured_likelihood</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">captured_posterior</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">onfilter</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T_max</span><span class="p">):</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">process_noise</span> <span class="o">*</span> <span class="n">unit_process_noise</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">onfilter</span><span class="p">:</span>
          <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">measurement_noise</span> <span class="o">*</span> <span class="n">unit_measurement_noise</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

          <span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">posterior</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="p">,</span> <span class="n">measurement_noise_cov</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

          <span class="n">s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
          <span class="n">cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">T</span><span class="p">:</span>
          <span class="n">onfilter</span> <span class="o">=</span> <span class="kc">False</span>
          <span class="n">captured_prior</span> <span class="o">=</span> <span class="n">prior</span>
          <span class="n">captured_likelihood</span> <span class="o">=</span> <span class="n">likelihood</span>
          <span class="n">captured_posterior</span> <span class="o">=</span> <span class="n">posterior</span>

    <span class="n">smin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span><span class="nb">min</span><span class="p">(</span><span class="n">s_</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">smax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span><span class="nb">max</span><span class="p">(</span><span class="n">s_</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">pscale</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># scaling factor for displaying pdfs</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'state'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_max</span><span class="o">+</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">)])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">])</span>

    <span class="n">show_pdf</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">T</span><span class="p">:],</span> <span class="n">s</span><span class="p">[</span><span class="n">T</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'limegreen'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flag_m</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">)</span>

        <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">pdf_likelihood</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">captured_likelihood</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">captured_likelihood</span><span class="o">.</span><span class="n">cov</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="n">pdf_likelihood</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'likelihood'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"crimson"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">pdf_likelihood</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'crimson'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>
        <span class="n">show_pdf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">flag_s_</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">s_</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">s_</span><span class="p">[</span><span class="n">T</span><span class="p">:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
        <span class="n">show_pdf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">flag_err_</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">s_</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">)[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">s_</span><span class="p">[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">)[:</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">show_pdf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">show_pdf</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">pdf_post</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">captured_posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">captured_posterior</span><span class="o">.</span><span class="n">cov</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="n">pdf_post</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'posterior'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">pdf_post</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_pdf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">show_pdf</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">pdf_prior</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">captured_prior</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">captured_prior</span><span class="o">.</span><span class="n">cov</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="n">pdf_prior</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'dodgerblue'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'prior'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"dodgerblue"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">pdf_prior</span><span class="o">*</span><span class="p">(</span><span class="n">T_max</span><span class="o">*</span><span class="n">pscale</span><span class="p">),</span> <span class="n">domain</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'dodgerblue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="video-9-interactive-demo-2-1-discussion">
<h4>Video 9: Interactive Demo 2.1 Discussion<a class="headerlink" href="#video-9-interactive-demo-2-1-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
<div class="section" id="coding-exercise-2-1-implement-your-own-kalman-filter">
<h3>Coding Exercise 2.1: Implement your own Kalman filter<a class="headerlink" href="#coding-exercise-2-1-implement-your-own-kalman-filter" title="Permalink to this headline">¶</a></h3>
<div class="section" id="video-10-implementing-a-kalman-filter">
<h4>Video 10: Implementing a Kalman filter<a class="headerlink" href="#video-10-implementing-a-kalman-filter" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p>As you saw in the video and the previous exercise, a Kalman filter estimates a posterior probability distribution <em>recursively</em> over time using a mathematical model of the process and incoming measurements. This dynamic posterior allows us to improve our guess about Astrocat’s position as new measures arrive; besides, its mean is the best estimate one can compute of Astrocat’s actual position at each time step.</p>
<p>Now it’s your turn! Follow this recipe to complete the code below and implement your own Kalman filter:</p>
<p><strong>Step 1: Change yesterday’s posterior into today’s prior</strong></p>
<p>Use the mathematical model to calculate how deterministic changes in the process shift yesterday’s posterior, <span class="math notranslate nohighlight">\(\mathcal{N}(\mu_{s_{t-1}}, \sigma_{s_{t-1}}^2)\)</span>, and how random changes in the process broaden the shifted distribution:</p>
<blockquote>
<div><div class="amsmath math notranslate nohighlight" id="equation-87db530b-898f-4d22-96f4-98200dafba02">
<span class="eqno">(380)<a class="headerlink" href="#equation-87db530b-898f-4d22-96f4-98200dafba02" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p(s_t|m_{1:t-1}) = p(Ds_{t-1}+w_{t-1} | m_{1:t-1}) = \mathcal{N}(D\mu_{s_{t-1}} + 0, D^2\sigma_{s_{t-1}}^2 +\sigma_p^2)
\end{equation}\]</div>
</div></blockquote>
<p>Note that we use <span class="math notranslate nohighlight">\(\sigma_p\)</span> here to denote the process noise, while the video used <span class="math notranslate nohighlight">\(\sigma_w\)</span> (a change in notation to sync with the prior sections).</p>
<p><strong>Step 2: Multiply today’s prior by likelihood</strong></p>
<p>Use the latest measurement of Astrocat’s collar (fresh evidence) to form a new estimate somewhere between this measurement and what we predicted in Step 1. The next posterior is the result of multiplying the Gaussian computed in Step 1 (a.k.a. today’s prior) and the likelihood, which is also modeled as a Gaussian <span class="math notranslate nohighlight">\(\mathcal{N}(m_t, \sigma_m^2)\)</span>:</p>
<p><strong>2a: add information from prior and likelihood</strong></p>
<p>To find the posterior variance, we first compute the posterior information (which is the inverse of the variance) by adding the information provided by the prior and the likelihood:</p>
<blockquote>
<div><div class="amsmath math notranslate nohighlight" id="equation-7cc0896c-1cdd-4156-87f8-6535008d47d5">
<span class="eqno">(381)<a class="headerlink" href="#equation-7cc0896c-1cdd-4156-87f8-6535008d47d5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{1}{\sigma_{s_t}^2} = \frac{1}{D^2\sigma_{s_{t-1}}^2 +\sigma_p^2} + \frac{1}{\sigma_m^2}
\end{equation}\]</div>
</div></blockquote>
<p>Now we can take the inverse of the posterior information to get back the posterior variance.</p>
<p><strong>2b: add means from prior and likelihood</strong></p>
<p>To find the posterior mean, we calculate a weighted average of means from prior and likelihood, where each weight, <span class="math notranslate nohighlight">\(g\)</span>, is just the fraction of information that each Gaussian provides!</p>
<blockquote>
<div><div class="amsmath math notranslate nohighlight" id="equation-2b59a944-02f2-42aa-80fb-aa1b1ea9d84b">
<span class="eqno">(382)<a class="headerlink" href="#equation-2b59a944-02f2-42aa-80fb-aa1b1ea9d84b" title="Permalink to this equation">¶</a></span>\[\begin{align}
g_{\rm{prior}} &amp;= \frac{\rm{information}_{\textit{ }\rm{prior}}}{\rm{information}_{\textit{ }\rm{posterior}}} \\
g_{\rm{likelihood}} &amp;= \frac{\rm{information}_{\textit{ }\rm{likelihood}}}{\rm{information}_{\textit{ }\rm{posterior}}} \\
\bar{\mu}_t &amp;= g_{\rm{prior}} D\mu_{s_{t-1}} + g_{\rm{likelihood}} m_t
\end{align}\]</div>
</div></blockquote>
<p>Congrats!</p>
<p><strong>Implementation detail:</strong> You can access the statistics of a Gaussian by typing, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span><span class="o">.</span><span class="n">mean</span>
<span class="n">prior</span><span class="o">.</span><span class="n">cov</span>
</pre></div>
</div>
<p><strong>Optional: Relationship to classic description of Kalman filter:</strong></p>
<p>We’re teaching this recipe because it is interpretable and connects to past lessons about the sum rule and product rule for Gaussians. But the classic description of the Kalman filter is a little different. The above weights, <span class="math notranslate nohighlight">\(g_{\rm{prior}}\)</span> and <span class="math notranslate nohighlight">\(g_{\rm{likelihood}}\)</span>, add up to <span class="math notranslate nohighlight">\(1\)</span> and can be written one in terms of the other; then, if we let <span class="math notranslate nohighlight">\(K = g_{\rm{likelihood}}\)</span>, the posterior mean can be expressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2e149dba-e797-4d73-b911-6c529688e6fb">
<span class="eqno">(383)<a class="headerlink" href="#equation-2e149dba-e797-4d73-b911-6c529688e6fb" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\bar{\mu}_t = (1-K) D\bar{\mu}_{t-1} + K m_t = D\bar{\mu}_{t-1} + K (m_t - D\bar{\mu}_{t-1})
\end{equation}\]</div>
<p>In classic textbooks, you will often find this expression for the posterior mean; <span class="math notranslate nohighlight">\(K\)</span> is known as the Kalman gain and its function is to choose a value partway between the current measurement <span class="math notranslate nohighlight">\(m_t\)</span> and the prediction from Step 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>                  <span class="c1"># Time duration</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">25</span>                <span class="c1"># dynamics time constant</span>
<span class="n">process_noise</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># process noise in Astrocat's propulsion unit (standard deviation)</span>
<span class="n">measurement_noise</span> <span class="o">=</span> <span class="mi">9</span>   <span class="c1"># measurement noise in Astrocat's collar (standard deviation)</span>

<span class="c1"># Auxiliary variables</span>
<span class="n">process_noise_cov</span> <span class="o">=</span> <span class="n">process_noise</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># process noise in Astrocat's propulsion unit (variance)</span>
<span class="n">measurement_noise_cov</span> <span class="o">=</span> <span class="n">measurement_noise</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># measurement noise in Astrocat's collar (variance)</span>

<span class="c1"># Initialize arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># timeline</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>          <span class="c1"># states</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>       <span class="c1"># dynamics multiplier (matrix if s is vector)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>          <span class="c1"># measurement</span>
<span class="n">s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>         <span class="c1"># estimate (posterior mean)</span>
<span class="n">cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>       <span class="c1"># uncertainty (posterior covariance)</span>

<span class="c1"># Initial guess of the posterior at time 0</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>    <span class="c1"># In this case, the initial guess (posterior distribution</span>
                                                           <span class="c1"># at time 0) is the equilibrium distribution, but feel free to</span>
                                                           <span class="c1"># experiment with other gaussians</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">initial_guess</span>

<span class="c1"># Sample initial conditions</span>
<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">cov</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>   <span class="c1"># Sample initial condition from posterior distribution at time 0</span>
<span class="n">s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
<span class="n">cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

<span class="c1"># Loop over steps</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>

  <span class="c1"># Sample true states and corresponding measurements</span>
  <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">)</span>    <span class="c1"># variable `s` records the true position of Astrocat</span>
  <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">)</span>      <span class="c1"># variable `m` records the measurements of Astrocat's collar</span>

  <span class="c1">###################################################################</span>
  <span class="c1">## Fill out the following then remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: need to implement the Kalman filter"</span><span class="p">)</span>
  <span class="c1">###################################################################</span>

  <span class="c1"># Step 1. Shift yesterday's posterior to match the deterministic change of the system's dynamics,</span>
  <span class="c1">#         and broad it to account for the random change (i.e., add mean and variance of process noise).</span>
  <span class="n">todays_prior</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Step 2. Now that yesterday's posterior has become today's prior, integrate new evidence</span>
  <span class="c1">#         (i.e., multiply gaussians from today's prior and likelihood)</span>
  <span class="n">likelihood</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Step 2a:  To find the posterior variance, add informations (inverse variances) of prior and likelihood</span>
  <span class="n">info_prior</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">todays_prior</span><span class="o">.</span><span class="n">cov</span>
  <span class="n">info_likelihood</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">likelihood</span><span class="o">.</span><span class="n">cov</span>
  <span class="n">info_posterior</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Step 2b: To find the posterior mean, calculate a weighted average of means from prior and likelihood;</span>
  <span class="c1">#          the weights are just the fraction of information that each gaussian provides!</span>
  <span class="n">prior_weight</span> <span class="o">=</span> <span class="n">info_prior</span> <span class="o">/</span> <span class="n">info_posterior</span>
  <span class="n">likelihood_weight</span> <span class="o">=</span> <span class="n">info_likelihood</span> <span class="o">/</span> <span class="n">info_posterior</span>
  <span class="n">posterior_mean</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Don't forget to convert back posterior information to posterior variance!</span>
  <span class="n">posterior_cov</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">info_posterior</span>
  <span class="n">posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="n">posterior_cov</span><span class="p">)</span>

  <span class="n">s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
  <span class="n">cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

<span class="c1"># Visualize</span>
<span class="n">paintMyFilter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="p">,</span> <span class="n">measurement_noise_cov</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">cov_</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>                  <span class="c1"># Time duration</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">25</span>                <span class="c1"># dynamics time constant</span>
<span class="n">process_noise</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># process noise in Astrocat's propulsion unit (standard deviation)</span>
<span class="n">measurement_noise</span> <span class="o">=</span> <span class="mi">9</span>   <span class="c1"># measurement noise in Astrocat's collar (standard deviation)</span>

<span class="c1"># Auxiliary variables</span>
<span class="n">process_noise_cov</span> <span class="o">=</span> <span class="n">process_noise</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># process noise in Astrocat's propulsion unit (variance)</span>
<span class="n">measurement_noise_cov</span> <span class="o">=</span> <span class="n">measurement_noise</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># measurement noise in Astrocat's collar (variance)</span>

<span class="c1"># Initialize arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># timeline</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>          <span class="c1"># states</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>       <span class="c1"># dynamics multiplier (matrix if s is vector)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>          <span class="c1"># measurement</span>
<span class="n">s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>         <span class="c1"># estimate (posterior mean)</span>
<span class="n">cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>       <span class="c1"># uncertainty (posterior covariance)</span>

<span class="c1"># Initial guess of the posterior at time 0</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>    <span class="c1"># In this case, the initial guess (posterior distribution</span>
                                                           <span class="c1"># at time 0) is the equilibrium distribution, but feel free to</span>
                                                           <span class="c1"># experiment with other gaussians</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">initial_guess</span>

<span class="c1"># Sample initial conditions</span>
<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">cov</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>   <span class="c1"># Sample initial condition from posterior distribution at time 0</span>
<span class="n">s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
<span class="n">cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

<span class="c1"># Loop over steps</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>

  <span class="c1"># Sample true states and corresponding measurements</span>
  <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">)</span>    <span class="c1"># variable `s` records the true position of Astrocat</span>
  <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">)</span>      <span class="c1"># variable `m` records the measurements of Astrocat's collar</span>

  <span class="c1"># Step 1. Shift yesterday's posterior to match the deterministic change of the system's dynamics,</span>
  <span class="c1">#         and broad it to account for the random change (i.e., add mean and variance of process noise).</span>
  <span class="n">todays_prior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span> <span class="o">+</span> <span class="n">process_noise_cov</span><span class="p">)</span>

  <span class="c1"># Step 2. Now that yesterday's posterior has become today's prior, integrate new evidence</span>
  <span class="c1">#         (i.e., multiply gaussians from today's prior and likelihood)</span>
  <span class="n">likelihood</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">measurement_noise_cov</span><span class="p">)</span>

  <span class="c1"># Step 2a:  To find the posterior variance, add informations (inverse variances) of prior and likelihood</span>
  <span class="n">info_prior</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">todays_prior</span><span class="o">.</span><span class="n">cov</span>
  <span class="n">info_likelihood</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">likelihood</span><span class="o">.</span><span class="n">cov</span>
  <span class="n">info_posterior</span> <span class="o">=</span> <span class="n">info_prior</span> <span class="o">+</span> <span class="n">info_likelihood</span>

  <span class="c1"># Step 2b: To find the posterior mean, calculate a weighted average of means from prior and likelihood;</span>
  <span class="c1">#          the weights are just the fraction of information that each gaussian provides!</span>
  <span class="n">prior_weight</span> <span class="o">=</span> <span class="n">info_prior</span> <span class="o">/</span> <span class="n">info_posterior</span>
  <span class="n">likelihood_weight</span> <span class="o">=</span> <span class="n">info_likelihood</span> <span class="o">/</span> <span class="n">info_posterior</span>
  <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">prior_weight</span> <span class="o">*</span> <span class="n">todays_prior</span><span class="o">.</span><span class="n">mean</span>  <span class="o">+</span>  <span class="n">likelihood_weight</span> <span class="o">*</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">mean</span>

  <span class="c1"># Don't forget to convert back posterior information to posterior variance!</span>
  <span class="n">posterior_cov</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">info_posterior</span>
  <span class="n">posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="n">posterior_cov</span><span class="p">)</span>

  <span class="n">s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
  <span class="n">cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">paintMyFilter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="p">,</span> <span class="n">measurement_noise_cov</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">cov_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-11-exercise-2-1-discussion">
<h4>Video 11: Exercise 2.1 Discussion<a class="headerlink" href="#video-11-exercise-2-1-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<div class="section" id="section-2-2-estimation-accuracy">
<h2>Section 2.2: Estimation accuracy<a class="headerlink" href="#section-2-2-estimation-accuracy" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 50 min</em></p>
<div class="section" id="interactive-demo-2-2-compare-states-estimates-and-measurements">
<h3>Interactive Demo 2.2: Compare states, estimates, and measurements<a class="headerlink" href="#interactive-demo-2-2-compare-states-estimates-and-measurements" title="Permalink to this headline">¶</a></h3>
<div class="section" id="video-12-compare-states-estimates-and-measurements">
<h4>Video 12: Compare states, estimates, and measurements<a class="headerlink" href="#video-12-compare-states-estimates-and-measurements" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p>How well do the estimates <span class="math notranslate nohighlight">\(\hat{s}\)</span> match the actual values <span class="math notranslate nohighlight">\(s\)</span>? How does the distribution of errors <span class="math notranslate nohighlight">\(\hat{s}_t - s_t\)</span> compare to the posterior variance? Why? Try different parameters of the Hidden Markov Model and observe how the properties change.</p>
<p>How do the <em>measurements</em> <span class="math notranslate nohighlight">\(m\)</span> compare to the true states?</p>
<p>Execute cell to enable the demo</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute cell to enable the demo</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'''&lt;style&gt;.widget-label { min-width: 15ex !important; }&lt;/style&gt;'''</span><span class="p">))</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">tau_max</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'tau'</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">tau_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">tau_max</span><span class="p">),</span>
                  <span class="n">process_noise</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"process noise"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">process_noise_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">process_noise_max</span><span class="p">),</span>
                  <span class="n">measurement_noise</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"observation noise"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">measurement_noise_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">measurement_noise_max</span><span class="p">),</span>
                  <span class="n">flag_m</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'measurements'</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">stochastic_system</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">flag_m</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">T_max</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>              <span class="c1"># timeline</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>                     <span class="c1"># states</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>                      <span class="c1"># dynamics multiplier (matrix if s is vector)</span>

    <span class="n">process_noise_cov</span> <span class="o">=</span> <span class="n">process_noise</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># process noise in Astrocat's propulsion unit (variance)</span>
    <span class="n">measurement_noise_cov</span> <span class="o">=</span> <span class="n">measurement_noise</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># measurement noise in Astrocat's collar (variance)</span>

    <span class="n">prior_mean</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prior_cov</span> <span class="o">=</span> <span class="n">process_noise_cov</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prior_cov</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>   <span class="c1"># Sample initial condition from equilibrium distribution</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># measurement</span>
    <span class="n">s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># estimate (posterior mean)</span>
    <span class="n">cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T_max</span><span class="p">)</span>    <span class="c1"># uncertainty (posterior covariance)</span>

    <span class="n">s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_mean</span>
    <span class="n">cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_cov</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_cov</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">process_noise</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">measurement_noise</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>

        <span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">posterior</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">process_noise_cov</span><span class="p">,</span> <span class="n">measurement_noise_cov</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
        <span class="n">cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'s'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$\mu$'</span><span class="p">)</span>

    <span class="n">sbounds</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s_</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>    <span class="c1"># plot line of equality</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span>

    <span class="n">axhist</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">axhist</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'error $s-\hat</span><span class="si">{s}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">axhist</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'probability'</span><span class="p">)</span>
    <span class="n">axhist</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">s_</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'histogram of estimate errors'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'yellow'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flag_m</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
        <span class="n">axhist</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">m</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'histogram of measurement errors'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">)</span>

    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">sbounds</span><span class="p">,</span> <span class="n">sbounds</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">pdf_g</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">axhist</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">pdf_g</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'posterior shifted to mean'</span><span class="p">)</span>
    <span class="n">axhist</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-13-interactive-demo-2-2-discussion">
<h4>Video 13: Interactive Demo 2.2 Discussion<a class="headerlink" href="#video-13-interactive-demo-2-2-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<div class="section" id="section-2-3-searching-for-astrocat">
<h2>Section 2.3: Searching for Astrocat<a class="headerlink" href="#section-2-3-searching-for-astrocat" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 1 hour</em></p>
<div class="section" id="interactive-demo-2-3-how-long-does-it-take-to-find-astrocat">
<h3>Interactive Demo 2.3: How long does it take to find astrocat?<a class="headerlink" href="#interactive-demo-2-3-how-long-does-it-take-to-find-astrocat" title="Permalink to this headline">¶</a></h3>
<div class="section" id="video-14-how-long-does-it-take-to-find-astrocat">
<h4>Video 14: How long does it take to find astrocat?<a class="headerlink" href="#video-14-how-long-does-it-take-to-find-astrocat" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p>Here we plot the posterior variance as a function of time. Before mission control gets measurements, their only information about astrocat’s location is the prior. After some measurements, they hone in on astrocat.</p>
<ul class="simple">
<li><p>How does the variance shrink with time?</p></li>
<li><p>The speed depends on the process dynamics, but does it also depend on the signal-to-noise ratio (SNR)? (Here we measure SNR in decibels, a log scale where 1 dB means 0.1 log unit.)</p></li>
</ul>
<p>The red curve shows how rapidly the latent variance equilibrates exponentially from an initial condition, with a time constant of <span class="math notranslate nohighlight">\(\sim 1/(1-D^2)\)</span>. (<strong>Note:</strong> We adjusted the curve by shifting and scaling so it lines up visually with the posterior equilibrium variance. This makes it easier to compare timescales.) Does the latent process converge faster or slower than the posterior? Can you explain this based on how the Kalman filter integrates evidence?</p>
<p>Execute this cell to enable the demo</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to enable the demo</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'''&lt;style&gt;.widget-label { min-width: 15ex !important; }&lt;/style&gt;'''</span><span class="p">))</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">tau_max</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"max time"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">T_max</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">tau</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">tau_max</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'time constant'</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">tau_min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">tau_max</span><span class="p">),</span>
                  <span class="n">SNRdB</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="o">-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"SNR (decibels)"</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">40.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">10.</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">stochastic_system</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">SNRdB</span><span class="p">):</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>              <span class="c1"># timeline</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>                     <span class="c1"># states</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>                  <span class="c1"># dynamics matrix (scalar here)</span>
    <span class="n">prior_mean</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">process_noise</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">.1</span><span class="o">*</span><span class="n">SNRdB</span><span class="p">)</span>
    <span class="n">measurement_noise</span> <span class="o">=</span> <span class="n">process_noise</span> <span class="o">/</span> <span class="n">SNR</span>
    <span class="n">prior_cov</span> <span class="o">=</span> <span class="n">process_noise</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prior_cov</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_process_noise</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># Sample initial condition from equilibrium distribution</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># measurements</span>
    <span class="n">s_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># estimates (posterior mean)</span>
    <span class="n">cov_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># uncertainty (posterior covariance)</span>
    <span class="n">pcov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>    <span class="c1"># process covariance</span>

    <span class="n">s_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_mean</span>
    <span class="n">cov_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_cov</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_cov</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">process_noise</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_process_noise</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">measurement_noise</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_measurement_noise</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">posterior</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">process_noise</span><span class="p">,</span> <span class="n">measurement_noise</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">s_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">posterior</span><span class="o">.</span><span class="n">mean</span>
        <span class="n">cov_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">cov</span>
        <span class="n">pcov</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pcov</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">process_noise</span>

    <span class="n">equilibrium_posterior_var</span> <span class="o">=</span> <span class="n">process_noise</span> <span class="o">*</span> <span class="p">(</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SNR</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SNR</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">SNR</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">SNR</span><span class="p">)</span>

    <span class="n">equilibrium_process_var</span> <span class="o">=</span> <span class="n">process_noise</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">cov_</span><span class="p">)</span> <span class="o">-</span> <span class="n">equilibrium_posterior_var</span><span class="p">)</span> <span class="o">/</span> <span class="n">equilibrium_process_var</span>
    <span class="n">pcov</span> <span class="o">=</span> <span class="n">pcov</span> <span class="o">*</span> <span class="n">scale</span>   <span class="c1"># scale for better visual comparison of temporal structure</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cov_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">cov_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'posterior variance'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'posterior variance'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">cov_</span><span class="p">)])</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">pcov</span><span class="p">),</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'hidden process variance'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'hidden process variance (scaled)'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
    <span class="c1"># ax2.yaxis.set_major_formatter(plt.FuncFormatter(format_func))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">equilibrium_process_var</span> <span class="o">-</span> <span class="n">equilibrium_posterior_var</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">'0'</span><span class="p">,</span> <span class="s1">'equilibrium</span><span class="se">\n</span><span class="s1">process var'</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">cov_</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="video-15-interactive-demo-2-3-discussion">
<h4>Video 15: Interactive Demo 2.3 Discussion<a class="headerlink" href="#video-15-interactive-demo-2-3-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p><strong>Applications of Kalman filter in brain science</strong></p>
<ul class="simple">
<li><p>Brain-Computer Interface: estimate intended movements using neural activity as measurements.</p></li>
<li><p>Data analysis: estimate brain activity from noisy measurements (e.g., EEG)</p></li>
<li><p>Model of perception: prey tracking using noisy sensory measurements</p></li>
<li><p>Imagine your own! When are you trying to estimate something you cannot see directly?</p></li>
</ul>
<p>There are many variants that improve upon the limitations of the Kalman filter: non-Gaussian states and measurements, nonlinear dynamics, and more.</p>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 1 hour, 15 minutes</em></p>
<p>In this tutorial, you:</p>
<ul class="simple">
<li><p>simulated a 1D continuous linear dynamical system and took noisy measurements of the hidden state</p></li>
<li><p>used a Kalman filter to recover the hidden states more accurately than if you just used the noisy measurements and connected this to Bayesian ideas</p></li>
<li><p>played around with parameters of the process to better understand Kalman filter behavior</p></li>
</ul>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W3D2_HiddenDynamics/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W3D2_Tutorial2.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 2: Hidden Markov Model</p>
</div>
</a>
<a class="right-next" href="W3D2_Tutorial4.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Bonus Tutorial 4: The Kalman Filter, part 2</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>