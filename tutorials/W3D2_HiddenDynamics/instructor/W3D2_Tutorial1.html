
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 1: Sequential Probability Ratio Test — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W3D2_Tutorial2.html" rel="next" title="Tutorial 2: Hidden Markov Model"/>
<link href="W3D2_Intro.html" rel="prev" title="Intro"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training: Computational Neuroscience (CN)
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/instructor/W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Sequential Probability Ratio Test
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-overview-of-tutorials-on-hidden-dynamics">
     Video 1: Overview of Tutorials on Hidden Dynamics
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-sequential-probability-ratio-test-as-a-drift-diffusion-model">
   Section 1: Sequential Probability Ratio Test as a Drift Diffusion Model
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-sequential-probability-ratio-test">
     Video 2: Sequential Probability Ratio Test
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-simulating-an-sprt-model">
     Coding Exercise 1.1: Simulating an SPRT model
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-trajectories-under-the-fixed-time-stopping-rule">
     Interactive Demo 1.2: Trajectories under the fixed-time stopping rule
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-section-1-exercises-discussion">
       Video 3: Section 1 Exercises Discussion
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-analyzing-the-ddm-accuracy-vs-stopping-time">
   Section 2: Analyzing the DDM: accuracy vs stopping time
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-speed-vs-accuracy-tradeoff">
     Video 4: Speed vs Accuracy Tradeoff
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-the-speed-accuracy-tradeoff">
       Coding Exercise 2.1: The Speed/Accuracy Tradeoff
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-accuracy-versus-stop-time">
       Interactive Demo 2.2: Accuracy versus stop-time
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-section-2-exercises-discussion">
         Video 5: Section 2 Exercises Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-ddm-with-fixed-thresholds-on-confidence">
     Bonus Section 1: DDM with fixed thresholds on confidence
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-fixed-threshold-on-confidence">
       Video 6: Fixed threshold on confidence
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-1-1-coding-simulating-the-ddm-with-fixed-confidence-thresholds">
       Bonus Coding Exercise 1.1, Coding: Simulating the DDM with fixed confidence thresholds
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-2-ddm-with-fixed-confidence-threshold">
       Bonus Interactive Demo 1.2: DDM with fixed confidence threshold
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-1-3-speed-accuracy-tradeoff-revisited">
       Bonus Coding Exercise 1.3: Speed/Accuracy Tradeoff Revisited
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-4-speed-accuracy-with-a-threshold-rule">
       Bonus Interactive demo 1.4: Speed/Accuracy with a threshold rule
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 1: Sequential Probability Ratio Test</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Sequential Probability Ratio Test
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-overview-of-tutorials-on-hidden-dynamics">
     Video 1: Overview of Tutorials on Hidden Dynamics
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-sequential-probability-ratio-test-as-a-drift-diffusion-model">
   Section 1: Sequential Probability Ratio Test as a Drift Diffusion Model
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-sequential-probability-ratio-test">
     Video 2: Sequential Probability Ratio Test
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-simulating-an-sprt-model">
     Coding Exercise 1.1: Simulating an SPRT model
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-trajectories-under-the-fixed-time-stopping-rule">
     Interactive Demo 1.2: Trajectories under the fixed-time stopping rule
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-section-1-exercises-discussion">
       Video 3: Section 1 Exercises Discussion
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-analyzing-the-ddm-accuracy-vs-stopping-time">
   Section 2: Analyzing the DDM: accuracy vs stopping time
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-speed-vs-accuracy-tradeoff">
     Video 4: Speed vs Accuracy Tradeoff
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-the-speed-accuracy-tradeoff">
       Coding Exercise 2.1: The Speed/Accuracy Tradeoff
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-accuracy-versus-stop-time">
       Interactive Demo 2.2: Accuracy versus stop-time
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-section-2-exercises-discussion">
         Video 5: Section 2 Exercises Discussion
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus">
   Bonus
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-section-1-ddm-with-fixed-thresholds-on-confidence">
     Bonus Section 1: DDM with fixed thresholds on confidence
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-fixed-threshold-on-confidence">
       Video 6: Fixed threshold on confidence
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-1-1-coding-simulating-the-ddm-with-fixed-confidence-thresholds">
       Bonus Coding Exercise 1.1, Coding: Simulating the DDM with fixed confidence thresholds
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-2-ddm-with-fixed-confidence-threshold">
       Bonus Interactive Demo 1.2: DDM with fixed confidence threshold
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-1-3-speed-accuracy-tradeoff-revisited">
       Bonus Coding Exercise 1.3: Speed/Accuracy Tradeoff Revisited
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-4-speed-accuracy-with-a-threshold-rule">
       Bonus Interactive demo 1.4: Speed/Accuracy with a threshold rule
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-1-sequential-probability-ratio-test">
<h1>Tutorial 1: Sequential Probability Ratio Test<a class="headerlink" href="#tutorial-1-sequential-probability-ratio-test" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 3, Day 2: Hidden Dynamics</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Yicheng Fei and Xaq Pitkow</p>
<p><strong>Content reviewers:</strong> John Butler, Matt Krause, Spiros Chavlis, Melvin Selim Atay, Keith van Antwerp, Michael Waskom, Jesse Livezey, and Byron Galbraith</p>
<p><strong>Production Editor:</strong> Ella Batty</p>
<p><strong>Post-production team:</strong> Gagana B, Spiros Chavlis</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 45 minutes</em></p>
<p>On Bayes Day, we learned how to combine the sensory measurement <span class="math notranslate nohighlight">\(m\)</span> about a latent variable <span class="math notranslate nohighlight">\(s\)</span> with our prior knowledge, using Bayes’ Theorem. This produced a posterior probability distribution <span class="math notranslate nohighlight">\(p(s|m)\)</span>. Today we will allow for <em>dynamic</em> world states and measurements.</p>
<p>In Tutorial 1 we will assume that the world state is <em>binary</em> (<span class="math notranslate nohighlight">\(\pm 1\)</span>) and <em>constant</em> over time, but allow for multiple observations over time. We will use the <em>Sequential Probability Ratio Test</em> (SPRT) to infer which state is true. This leads to the <em>Drift Diffusion Model (DDM)</em> where evidence accumulates until reaching a stopping criterion.</p>
<p>By the end of this tutorial, you should be able to:</p>
<ul class="simple">
<li><p>Define and implement the Sequential Probability Ratio Test for a series of measurements</p></li>
<li><p>Define what drift and diffusion mean in a drift-diffusion model</p></li>
<li><p>Explain the speed-accuracy trade-off in a drift diffusion model</p></li>
</ul>
<p><strong>Summary of Exercises</strong></p>
<ol class="simple">
<li><p>Bonus (math): derive the Drift Diffusion Model mathematically from SPRT</p></li>
<li><p>Simulate the DDM</p>
<ol class="simple">
<li><p><em>Code</em>: Accumulate evidence and make a decision (DDM)</p></li>
<li><p><em>Interactive</em>: Manipulate parameters and interpret</p></li>
</ol>
</li>
<li><p>Analyze the DDM</p>
<ol class="simple">
<li><p><em>Code</em>: Quantify speed-accuracy tradeoff</p></li>
<li><p><em>Interactive</em>: Manipulate parameters and interpret</p></li>
</ol>
</li>
</ol>
<div class="section" id="video-1-overview-of-tutorials-on-hidden-dynamics">
<h2>Video 1: Overview of Tutorials on Hidden Dynamics<a class="headerlink" href="#video-1-overview-of-tutorials-on-hidden-dynamics" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/NMA2020/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper Functions</span>

<span class="k">def</span> <span class="nf">simulate_and_plot_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate and plot a SPRT for a fixed amount of time given a std.</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of the observations.</span>
<span class="sd">    stop_time (int): Number of steps to run before stopping.</span>
<span class="sd">    num_sample (int): The number of samples to plot.</span>
<span class="sd">    """</span>

  <span class="n">evidence_history_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"#Trial</span><span class="se">\t</span><span class="s2">Total_Evidence</span><span class="se">\t</span><span class="s2">Decision"</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>
    <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span> <span class="o">=</span> <span class="n">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="se">\t</span><span class="si">{:f}</span><span class="se">\t</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decision</span><span class="p">))</span>
    <span class="n">evidence_history_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">)</span>

  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">maxlen_evidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span><span class="n">evidence_history_list</span><span class="p">)))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">maxlen_evidence</span><span class="p">),</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">evidences</span> <span class="ow">in</span> <span class="n">evidence_history_list</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evidences</span><span class="p">)),</span> <span class="n">evidences</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Accumulated log likelihood ratio"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Log likelihood ratio trajectories under the fixed-time "</span> <span class="o">+</span>
                  <span class="s2">"stopping rule"</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracy_analytical_list</span><span class="p">,</span> <span class="n">accuracy_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate and plot a SPRT for a fixed amount of times given a std.</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of the observations.</span>
<span class="sd">    stop_time_list (int): List of number of steps to run before stopping.</span>
<span class="sd">    accuracy_analytical_list (int): List of analytical accuracies for each stop time</span>
<span class="sd">    accuracy_list (int (optional)): List of simulated accuracies for each stop time</span>
<span class="sd">  """</span>
  <span class="n">T</span> <span class="o">=</span> <span class="n">stop_time_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Stop Time'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Average Accuracy'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracy_analytical_list</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">accuracy_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracy_list</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'analytical'</span><span class="p">,</span><span class="s1">'simulated'</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper center'</span><span class="p">)</span>

  <span class="c1"># Show two gaussian</span>
  <span class="n">stop_time_list_plot</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="o">//</span><span class="mi">10</span><span class="p">),</span> <span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="o">//</span><span class="mi">3</span><span class="p">]</span>
  <span class="n">sigma_st_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stop_time_list_plot</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">sigma</span>
  <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma_st_max</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma_st_max</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">stop_time</span> <span class="ow">in</span> <span class="n">stop_time_list_plot</span><span class="p">:</span>
    <span class="n">ins</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="n">stop_time</span><span class="o">/</span><span class="n">T</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'right'</span><span class="p">,</span> <span class="s1">'top'</span><span class="p">,</span> <span class="s1">'bottom'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">]:</span>
      <span class="n">ins</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ins</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
    <span class="n">ins</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"stop_time=</span><span class="si">{</span><span class="n">stop_time</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
    <span class="n">mu_st</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">stop_time</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">sigma_st</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stop_time</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mu1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="n">mu_st</span><span class="p">,</span><span class="n">mu_st</span><span class="p">]):</span>
      <span class="n">rv</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span> <span class="n">sigma_st</span><span class="p">)</span>
      <span class="n">offset</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
      <span class="c1"># lbl = "measurement distribution" if i==0 else ""</span>
      <span class="n">lbl</span> <span class="o">=</span> <span class="s2">"summed evidence"</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s2">""</span>
      <span class="n">color</span> <span class="o">=</span> <span class="s2">"crimson"</span>
      <span class="n">ls</span> <span class="o">=</span> <span class="s2">"solid"</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="s2">"dashed"</span>
      <span class="n">ins</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">left</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lbl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu_st</span><span class="p">,</span> <span class="n">sigma_st</span><span class="p">)</span>
    <span class="n">domain0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma_st_max</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain0</span><span class="p">)</span>
    <span class="n">ins</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">domain0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">domain0</span><span class="p">),</span> <span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"crimson"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"error"</span><span class="p">)</span>
    <span class="n">ins</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>


    <span class="c1"># ins.legend(loc="upper right")</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">simulate_and_plot_SPRT_fixedthreshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span>
                                          <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate and plot a SPRT for a fixed amount of times given a std.</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of the observations.</span>
<span class="sd">    num_sample (int): The number of samples to plot.</span>
<span class="sd">    alpha (float): Threshold for making a decision.</span>
<span class="sd">  """</span>
  <span class="c1"># calculate evidence threshold from error rate</span>
  <span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold_from_errorrate</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

  <span class="c1"># run simulation</span>
  <span class="n">evidence_history_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"#Trial</span><span class="se">\t</span><span class="s2">Time</span><span class="se">\t</span><span class="s2">Accumulated Evidence</span><span class="se">\t</span><span class="s2">Decision"</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>
    <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span> <span class="o">=</span> <span class="n">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{:f}</span><span class="se">\t</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mvec</span><span class="p">),</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                      <span class="n">decision</span><span class="p">))</span>
    <span class="n">evidence_history_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">)</span>

  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">maxlen_evidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span><span class="n">evidence_history_list</span><span class="p">)))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span><span class="n">maxlen_evidence</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span><span class="n">maxlen_evidence</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">maxlen_evidence</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">evidences</span> <span class="ow">in</span> <span class="n">evidence_history_list</span><span class="p">:</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evidences</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">evidences</span><span class="p">]))</span>

  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Accumulated log likelihood ratio"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Log likelihood ratio trajectories under the threshold rule"</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">simulate_and_plot_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate and plot a SPRT for a set of thresholds given a std.</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of the observations.</span>
<span class="sd">    alpha_list (float): List of thresholds for making a decision.</span>
<span class="sd">    num_sample (int): The number of samples to plot.</span>
<span class="sd">  """</span>
  <span class="n">accuracies</span><span class="p">,</span> <span class="n">decision_speeds</span> <span class="o">=</span> <span class="n">simulate_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span>
                                                               <span class="n">threshold_list</span><span class="p">,</span>
                                                               <span class="n">num_sample</span><span class="p">)</span>

  <span class="c1"># Plotting</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decision_speeds</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">decision_speeds</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">decision_speeds</span><span class="p">)],</span>
          <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Average Decision speed"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Average Accuracy'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Speed/Accuracy Tradeoff"</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">threshold_from_errorrate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate log likelihood ratio threshold from desired error rate `alpha`</span>

<span class="sd">  Args:</span>
<span class="sd">    alpha (float): in (0,1), the desired error rate</span>

<span class="sd">  Return:</span>
<span class="sd">    threshold: corresponding evidence threshold</span>
<span class="sd">  """</span>
  <span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">threshold</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-sequential-probability-ratio-test-as-a-drift-diffusion-model">
<h1>Section 1: Sequential Probability Ratio Test as a Drift Diffusion Model<a class="headerlink" href="#section-1-sequential-probability-ratio-test-as-a-drift-diffusion-model" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 8 min</em></p>
<div class="section" id="video-2-sequential-probability-ratio-test">
<h2>Video 2: Sequential Probability Ratio Test<a class="headerlink" href="#video-2-sequential-probability-ratio-test" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>This video covers the definition of and math behind the sequential probability ratio test (SPRT), and introduces the idea of the SPRT as a drift diffusion model.</p>
<details>
<summary><font color="blue">Click here for text recap of video</font>
</summary>
<p><strong>Sequential Probability Ratio Test</strong></p>
<p>The Sequential Probability Ratio Test is a likelihood ratio test for determining which of two hypotheses is more likely. It is appropriate for sequential independent and identially distributed (iid) data. iid means that the data comes from the same distribution.</p>
<p>Let’s return to what we learned yesterday. We had probabilities of our measurement (<span class="math notranslate nohighlight">\(m\)</span>) given a state of the world (<span class="math notranslate nohighlight">\(s\)</span>). For example, we knew the probability of seeing someone catch a fish while fishing on the left side given that the fish were on the left side <span class="math notranslate nohighlight">\(P(m = \textrm{catch fish} | s = \textrm{left})\)</span>.</p>
<p>Now let’s extend this slightly to assume we take a series of measurements, from time 1 up to time t (<span class="math notranslate nohighlight">\(m_{1:t}\)</span>), and that our state is either +1 or -1. We want to figure out what the state is, given our measurements. To do this, we can compare the total evidence up to time <span class="math notranslate nohighlight">\(t\)</span> for our two hypotheses (that the state is +1 or that the state is -1). We do this by computing a likelihood ratio: the ratio of the likelihood of all these measurements given the state is +1, <span class="math notranslate nohighlight">\(p(m_{1:t}|s=+1)\)</span>, to the likelihood of the measurements given the state is -1, <span class="math notranslate nohighlight">\(p(m_{1:t}|s=-1)\)</span>. This is our likelihood ratio test. In fact, we want to take the log of this likelihood ratio to give us the log likelihood ratio <span class="math notranslate nohighlight">\(L_T\)</span>.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
L_T &amp;= log\frac{p(m_{1:t}|s=+1)}{p(m_{1:t}|s=-1)}
\end{align*}\]</div>
<p>Since our data is independent and identically distribution, the probability of all measurements given the state equals the product of the separate probabilities of each measurement given the state (<span class="math notranslate nohighlight">\(p(m_{1:t}|s) = \prod_{t=1}^T p(m_t | s) \)</span>). We can substitute this in and use log properties to convert to a sum.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
L_T &amp;= log\frac{p(m_{1:t}|s=+1)}{p(m_{1:t}|s=-1)}\\
&amp;= log\frac{\prod_{t=1}^Tp(m_{t}|s=+1)}{\prod_{t=1}^Tp(m_{t}|s=-1)}\\
&amp;= \sum_{t=1}^T log\frac{p(m_{t}|s=+1)}{p(m_{t}|s=-1)}\\
&amp;= \sum_{t=1}^T \Delta_t
\end{align*}\]</div>
<p>In the last line, we have used <span class="math notranslate nohighlight">\(\Delta_t = log\frac{p(m_{t}|s=+1)}{p(m_{t}|s=-1)}\)</span>.</p>
<p>To get the full log likelihood ratio, we are summing up the log likelihood ratios at each time step. The log likelihood ratio at a time step (<span class="math notranslate nohighlight">\(L_T\)</span>) will equal the ratio at the previous time step (<span class="math notranslate nohighlight">\(L_{T-1}\)</span>) plus the ratio for the measurement at that time step, given by <span class="math notranslate nohighlight">\(\Delta_T\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
L_T =  L_{T-1} + \Delta_T
\end{align*}\]</div>
<p>The SPRT states that if <span class="math notranslate nohighlight">\(L_T\)</span> is positive, then the state <span class="math notranslate nohighlight">\(s=+1\)</span> is more likely than <span class="math notranslate nohighlight">\(s=-1\)</span>!</p>
<p><strong>Sequential Probability Ratio Test as a Drift Diffusion Model</strong></p>
<p>Let’s assume that the probability of seeing a measurement given the state is a Gaussian (Normal) distribution where the mean (<span class="math notranslate nohighlight">\(\mu\)</span>) is different for the two states but the standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) is the same:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
p(m_t | s = +1) &amp;= \mathcal{N}(\mu, \sigma^2)\\
p(m_t | s = -1) &amp;= \mathcal{N}(-\mu, \sigma^2)\\
\end{align*}\]</div>
<p>We can write the new evidence (the log likelihood ratio for the measurement at time <span class="math notranslate nohighlight">\(t\)</span>) as</p>
<div class="math notranslate nohighlight">
\[\Delta_t=b+c\epsilon_t\]</div>
<p>The first term, <span class="math notranslate nohighlight">\(b\)</span>, is a consistant value and equals <span class="math notranslate nohighlight">\(b=2\mu^2/\sigma^2\)</span>. This term favors the actual hidden state. The second term, <span class="math notranslate nohighlight">\(c\epsilon_t\)</span> where <span class="math notranslate nohighlight">\(\epsilon_t\sim\mathcal{N}(0,1)\)</span>, is a standard random variable which is scaled by the diffusion <span class="math notranslate nohighlight">\(c=2\mu/\sigma\)</span>. You can work through proving this in the bonus exercise 0 below if you wish!</p>
<p>The accumulation of evidence will thus “drift” toward one outcome, while “diffusing” in random directions, hence the term “drift-diffusion model” (DDM). The process is most likely (but not guaranteed) to reach the correct outcome eventually.</p>
</details><details>
<summary><font color="blue">Bonus math exercise 0: derive Drift Diffusion Model from SPRT</font>
</summary>
<p>We can do a little math to find the SPRT update <span class="math notranslate nohighlight">\(\Delta_t\)</span> to the log-likelihood ratio. You can derive this yourself, filling in the steps below, or skip to the end result.</p>
<p>Assume measurements are Gaussian-distributed with different means depending on the discrete latent variable <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-00864ec4-6d6a-49e3-b706-c55016c93301">
<span class="eqno">(367)<a class="headerlink" href="#equation-00864ec4-6d6a-49e3-b706-c55016c93301" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p(m|s=\pm 1) = \mathcal{N}\left(\mu_\pm,\sigma^2\right)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp{\left[-\frac{(m-\mu_\pm)^2}{2\sigma^2}\right]}
\end{equation}\]</div>
<p>In the log likelihood ratio for a single data point <span class="math notranslate nohighlight">\(m_i\)</span>, the normalizations cancel to give</p>
<div class="amsmath math notranslate nohighlight" id="equation-a115f8e7-5d60-43f6-8a1f-cc3845a5da58">
<span class="eqno">(368)<a class="headerlink" href="#equation-a115f8e7-5d60-43f6-8a1f-cc3845a5da58" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\Delta_t=\log \frac{p(m_t|s=+1)}{p(m_t|s=-1)} = \frac{1}{2\sigma^2}\left[-\left(m_t-\mu_+\right)^2 + (m_t-\mu_-)^2\right] \tag{5}
\end{equation}\]</div>
<p>It’s convenient to rewrite <span class="math notranslate nohighlight">\(m=\mu_\pm + \sigma \epsilon\)</span>, where <span class="math notranslate nohighlight">\(\epsilon\sim \mathcal{N}(0,1)\)</span> is a standard Gaussian variable with zero mean and unit variance. (Why does this give the correct probability for <span class="math notranslate nohighlight">\(m\)</span>?). The preceding formula can then be rewritten as
$<span class="math notranslate nohighlight">\(\Delta_t = \frac{1}{2\sigma^2}\left( -((\mu_\pm+\sigma\epsilon)-\mu_+)^2 + ((\mu_\pm+\sigma\epsilon)-\mu_-)^2\right) \tag{5}\)</span><span class="math notranslate nohighlight">\(
Let's assume that \)</span>s=+1<span class="math notranslate nohighlight">\( so \)</span>\mu_\pm=\mu_+<span class="math notranslate nohighlight">\( (if \)</span>s=-1<span class="math notranslate nohighlight">\( then the result is the same with a reversed sign). In that case, the means in the first term \)</span>m_t-\mu_+$ cancel, leaving</p>
<div class="amsmath math notranslate nohighlight" id="equation-84138413-d5af-4c57-b42a-c13cb0886145">
<span class="eqno">(369)<a class="headerlink" href="#equation-84138413-d5af-4c57-b42a-c13cb0886145" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\Delta_t = \frac{\delta^2\mu^2}{2\sigma^2}+\frac{\delta\mu}{\sigma}\epsilon_t \tag{5}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\mu=\mu_+-\mu_-\)</span>. If we take <span class="math notranslate nohighlight">\(\mu_\pm=\pm\mu\)</span>, then <span class="math notranslate nohighlight">\(\delta\mu=2\mu\)</span>, and</p>
<div class="amsmath math notranslate nohighlight" id="equation-5ab2dbc8-1872-496f-a271-70770defd96f">
<span class="eqno">(370)<a class="headerlink" href="#equation-5ab2dbc8-1872-496f-a271-70770defd96f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\Delta_t=2\frac{\mu^2}{\sigma^2}+2\frac{\mu}{\sigma}\epsilon_t
\end{equation}\]</div>
<p>The first term is a constant <em>drift</em>, and the second term is a random <em>diffusion</em>.</p>
<p>The SPRT says that we should add up these evidences, <span class="math notranslate nohighlight">\(L_T=\sum_{t=1}^T \Delta_t\)</span>. Note that the <span class="math notranslate nohighlight">\(\Delta_t\)</span> are independent. Recall that for independent random variables, the mean of a sum is the sum of the means. And the variance of a sum is the sum of the variances.</p>
</details>
<p>Adding these <span class="math notranslate nohighlight">\(\Delta_t\)</span> over time gives</p>
<div class="amsmath math notranslate nohighlight" id="equation-b6ac49a5-617f-4b67-b232-8ec4d2977f71">
<span class="eqno">(371)<a class="headerlink" href="#equation-b6ac49a5-617f-4b67-b232-8ec4d2977f71" title="Permalink to this equation">¶</a></span>\[\begin{equation}
L_T\sim\mathcal{N}\left(2\frac{\mu^2}{\sigma^2}T,\ 4\frac{\mu^2}{\sigma^2}T\right)=\mathcal{N}(bT,c^2T)
\end{equation}\]</div>
<p>as claimed. The log-likelihood ratio <span class="math notranslate nohighlight">\(L_t\)</span> is a biased random walk — normally distributed with a time-dependent mean and variance. This is the <strong>Drift Diffusion Model</strong>.</p>
</div>
<div class="section" id="coding-exercise-1-1-simulating-an-sprt-model">
<h2>Coding Exercise 1.1: Simulating an SPRT model<a class="headerlink" href="#coding-exercise-1-1-simulating-an-sprt-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s now generate simulated data with <span class="math notranslate nohighlight">\(s=+1\)</span> and see if the SPRT can infer the state correctly.</p>
<p>We will implement a function <code class="docutils literal notranslate"><span class="pre">simulate_SPRT_fixedtime</span></code>, which will generate measurements based on <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span>, and the true state. It will then accumulate evidence over the time steps and output a decision on the state. The decision will be the state that is more likely according to the accumulated evidence. We will use the helper function <code class="docutils literal notranslate"><span class="pre">log_likelihood_ratio</span></code>, implemented in the next cell, which computes the log of the likelihood of the state being 1 divided by the likelihood of the state being -1.</p>
<p><strong>Your coding tasks are:</strong></p>
<p><strong>Step 1</strong>: accumulate evidence.</p>
<p><strong>Step 2</strong>: make a decision at the last time point.</p>
<p>We will then visualize 10 simulations of the DDM. In the next exercise you’ll see how the parameters affect performance.</p>
<p>Execute this cell to enable the helper function <code class="docutils literal notranslate"><span class="pre">log_likelihood_ratio</span></code></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to enable the helper function `log_likelihood_ratio`</span>

<span class="k">def</span> <span class="nf">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Given a sequence(vector) of observed data, calculate the log of</span>
<span class="sd">  likelihood ratio of p1 and p0</span>

<span class="sd">  Args:</span>
<span class="sd">    Mvec (numpy vector):           A vector of scalar measurements</span>
<span class="sd">    p0 (Gaussian random variable): A normal random variable with `logpdf'</span>
<span class="sd">                                    method</span>
<span class="sd">    p1 (Gaussian random variable): A normal random variable with `logpdf`</span>
<span class="sd">                                    method</span>

<span class="sd">  Returns:</span>
<span class="sd">    llvec: a vector of log likelihood ratios for each input data point</span>
<span class="sd">  """</span>
  <span class="k">return</span> <span class="n">p1</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with fixed time stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of observation models</span>
<span class="sd">    stop_time (int): Number of samples to take before stopping</span>
<span class="sd">    true_dist (1 or -1): Which state is the true state.</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for s = 1, -1 for s = -1</span>
<span class="sd">    Mvec (numpy vector): the generated sequences of measurement data in this trial</span>
<span class="sd">  """</span>

  <span class="c1">#################################################</span>
  <span class="c1">## TODO for students ##</span>
  <span class="c1"># Fill out function and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: complete simulate_SPRT_fixedtime"</span><span class="p">)</span>
  <span class="c1">#################################################</span>

  <span class="c1"># Set means of observation distributions</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt; 0"</span>
  <span class="n">mu_pos</span> <span class="o">=</span> <span class="n">mu</span>
  <span class="n">mu_neg</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>

  <span class="c1"># Make observation distributions</span>
  <span class="n">p_pos</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_pos</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">p_neg</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_neg</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="c1"># Generate a random sequence of measurements</span>
  <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_pos</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_neg</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>

  <span class="c1"># Calculate log likelihood ratio for each measurement (delta_t)</span>
  <span class="n">ll_ratio_vec</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">p_neg</span><span class="p">,</span> <span class="n">p_pos</span><span class="p">)</span>

  <span class="c1"># STEP 1: Calculate accumulated evidence (S) given a time series of evidence (hint: np.cumsum)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># STEP 2: Make decision based on the sign of the evidence at the final time.</span>
  <span class="n">decision</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set model parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.5</span>  <span class="c1"># standard deviation for p+ and p-</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of simulations to run</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># number of steps before stopping</span>

<span class="c1"># Simulate and visualize</span>
<span class="n">simulate_and_plot_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with fixed time stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of observation models</span>
<span class="sd">    stop_time (int): Number of samples to take before stopping</span>
<span class="sd">    true_dist (1 or -1): Which state is the true state.</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for s = 1, -1 for s = -1</span>
<span class="sd">    Mvec (numpy vector): the generated sequences of measurement data in this trial</span>
<span class="sd">  """</span>

  <span class="c1"># Set means of observation distributions</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt; 0"</span>
  <span class="n">mu_pos</span> <span class="o">=</span> <span class="n">mu</span>
  <span class="n">mu_neg</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>

  <span class="c1"># Make observation distributions</span>
  <span class="n">p_pos</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_pos</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">p_neg</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_neg</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="c1"># Generate a random sequence of measurements</span>
  <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_pos</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_neg</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>

  <span class="c1"># Calculate log likelihood ratio for each measurement (delta_t)</span>
  <span class="n">ll_ratio_vec</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">p_neg</span><span class="p">,</span> <span class="n">p_pos</span><span class="p">)</span>

  <span class="c1"># STEP 1: Calculate accumulated evidence (S) given a time series of evidence (hint: np.cumsum)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ll_ratio_vec</span><span class="p">)</span>

  <span class="c1"># STEP 2: Make decision based on the sign of the evidence at the final time.</span>
  <span class="n">decision</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set model parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.5</span>  <span class="c1"># standard deviation for p+ and p-</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of simulations to run</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># number of steps before stopping</span>

<span class="c1"># Simulate and visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">simulate_and_plot_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-1-2-trajectories-under-the-fixed-time-stopping-rule">
<h2>Interactive Demo 1.2: Trajectories under the fixed-time stopping rule<a class="headerlink" href="#interactive-demo-1-2-trajectories-under-the-fixed-time-stopping-rule" title="Permalink to this headline">¶</a></h2>
<p>In the following demo, you can change the drift level (mu), noise level (sigma) in the observation model and the number of time steps before stopping (stop_time) using the sliders. You will then observe 10 simulations with those parameters. As in the previous exercise, the true state is +1.</p>
<ol class="simple">
<li><p>Are you more likely to make the wrong decision (choose the incorrect state) with high or low noise?</p></li>
<li><p>What happens when sigma is very small? Why?</p></li>
<li><p>Are you more likely to make the wrong decision (choose the incorrect state) with fewer or more time steps before stopping?</p></li>
</ol>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="k">def</span> <span class="nf">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with fixed time stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation of observation models</span>
<span class="sd">    stop_time (int): Number of samples to take before stopping</span>
<span class="sd">    true_dist (1 or -1): Which state is the true state.</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for s = 1, -1 for s = -1</span>
<span class="sd">    Mvec (numpy vector): the generated sequences of measurement data in this trial</span>
<span class="sd">  """</span>

  <span class="c1"># Set means of observation distributions</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt;0"</span>
  <span class="n">mu_pos</span> <span class="o">=</span> <span class="n">mu</span>
  <span class="n">mu_neg</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>

  <span class="c1"># Make observation distributions</span>
  <span class="n">p_pos</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_pos</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">p_neg</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">mu_neg</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="c1"># Generate a random sequence of measurements</span>
  <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_pos</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">p_neg</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">stop_time</span><span class="p">)</span>

  <span class="c1"># Calculate log likelihood ratio for each measurement (delta_t)</span>
  <span class="n">ll_ratio_vec</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">p_neg</span><span class="p">,</span> <span class="n">p_pos</span><span class="p">)</span>

  <span class="c1"># STEP 1: Calculate accumulated evidence (S) given a time series of evidence (hint: np.cumsum)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ll_ratio_vec</span><span class="p">)</span>

  <span class="c1"># STEP 2: Make decision based on the sign of the evidence at the final time.</span>
  <span class="n">decision</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">stop_time</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">):</span>
  <span class="n">simulate_and_plot_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>

<span class="sd">1) Higher noise, or higher sigma, means that the evidence accumulation varies up</span>
<span class="sd">   and down more. You are more likely to make a wrong decision with high noise,</span>
<span class="sd">   since the accumulated log likelihood ratio is more likely to be negative at the end</span>
<span class="sd">   despite the true distribution being s = +1.</span>

<span class="sd">2) When sigma is very small, the cumulated log likelihood ratios are basically a linear</span>
<span class="sd">   diagonal line. This is because each new measurement will be very similar (since they are</span>
<span class="sd">   being drawn from a Gaussian with a tiny standard deviation)</span>

<span class="sd">3) You are more likely to be wrong with a small number of time steps before decision. There is</span>
<span class="sd">   more change that the noise will affect the decision. We will explore this in the next section.</span>

<span class="sd">"""</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="video-3-section-1-exercises-discussion">
<h3>Video 3: Section 1 Exercises Discussion<a class="headerlink" href="#video-3-section-1-exercises-discussion" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-analyzing-the-ddm-accuracy-vs-stopping-time">
<h1>Section 2: Analyzing the DDM: accuracy vs stopping time<a class="headerlink" href="#section-2-analyzing-the-ddm-accuracy-vs-stopping-time" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 28 min</em></p>
<div class="section" id="video-4-speed-vs-accuracy-tradeoff">
<h2>Video 4: Speed vs Accuracy Tradeoff<a class="headerlink" href="#video-4-speed-vs-accuracy-tradeoff" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>If you make a hasty decision (e.g., after only seeing 2 samples), or if observation noise buries the signal, you may see a negative accumulated log likelihood ratio and thus make a wrong decision. Let’s plot how decision accuracy varies with the number of samples. Accuracy is the proportion of correct trials across our repeated simulations: <span class="math notranslate nohighlight">\(\frac{\# \textrm{ correct decisions}}{\# \textrm{ total decisions}}\)</span>.</p>
<div class="section" id="coding-exercise-2-1-the-speed-accuracy-tradeoff">
<h3>Coding Exercise 2.1: The Speed/Accuracy Tradeoff<a class="headerlink" href="#coding-exercise-2-1-the-speed-accuracy-tradeoff" title="Permalink to this headline">¶</a></h3>
<p>We will fix our observation noise level. In this exercise you will implement a function to run many simulations for a certain stopping time, and calculate the <em>average decision accuracy</em>. We will then visualize the relation between average decision accuracy and stopping time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">no_numerical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. stopping time by running</span>
<span class="sd">  repeated SPRT simulations for each stop time.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      stop_list_list (list-like object): a list of stopping times to run over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>
<span class="sd">      no_numerical (bool): flag that indicates the function to return analytical values only</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `stop_time_list`</span>
<span class="sd">      decisions_list: a list of decisions made in all trials</span>
<span class="sd">  """</span>

  <span class="c1">#################################################</span>
  <span class="c1">## TODO for students##</span>
  <span class="c1"># Fill out function and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: complete simulate_accuracy_vs_stoptime"</span><span class="p">)</span>
  <span class="c1">#################################################</span>

  <span class="c1"># Determine true state (1 or -1)</span>
  <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Set up tracker of accuracy and decisions</span>
  <span class="n">accuracies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">accuracies_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">decisions_list</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="c1"># Loop over stop times</span>
  <span class="k">for</span> <span class="n">i_stop_time</span><span class="p">,</span> <span class="n">stop_time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_numerical</span><span class="p">:</span>
      <span class="c1"># Set up tracker of decisions for this stop time</span>
      <span class="n">decisions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_sample</span><span class="p">,))</span>

      <span class="c1"># Loop over samples</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>

        <span class="c1"># STEP 1: Simulate run for this stop time (hint: use output from last exercise)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="o">...</span>

        <span class="c1"># Log decision</span>
        <span class="n">decisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decision</span>

      <span class="c1"># STEP 2: Calculate accuracy by averaging over trials</span>
      <span class="n">accuracies</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

      <span class="c1"># Log decision</span>
      <span class="n">decisions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decisions</span><span class="p">)</span>

    <span class="c1"># Calculate analytical accuracy</span>
    <span class="n">sigma_sum_gaussian</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stop_time</span><span class="p">)</span>
    <span class="n">accuracies_analytical</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_sum_gaussian</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">decisions_list</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set parameters of model</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">4.65</span>  <span class="c1"># standard deviation for observation noise</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># number of simulations to run for each stopping time</span>
<span class="n">stop_time_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Array of stopping times to use</span>


<span class="c1"># Calculate accuracies for each stop time</span>
<span class="n">accuracies</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span>
                                                   <span class="n">num_sample</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">plot_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="k">def</span> <span class="nf">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">no_numerical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. stopping time by running</span>
<span class="sd">  repeated SPRT simulations for each stop time.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      stop_list_list (list-like object): a list of stopping times to run over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>
<span class="sd">      no_numerical (bool): flag that indicates the function to return analytical values only</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `stop_time_list`</span>
<span class="sd">      decisions_list: a list of decisions made in all trials</span>
<span class="sd">  """</span>

  <span class="c1"># Determine true state (1 or -1)</span>
  <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Set up tracker of accuracy and decisions</span>
  <span class="n">accuracies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">accuracies_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">decisions_list</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="c1"># Loop over stop times</span>
  <span class="k">for</span> <span class="n">i_stop_time</span><span class="p">,</span> <span class="n">stop_time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_numerical</span><span class="p">:</span>
      <span class="c1"># Set up tracker of decisions for this stop time</span>
      <span class="n">decisions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_sample</span><span class="p">,))</span>

      <span class="c1"># Loop over samples</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>

        <span class="c1"># STEP 1: Simulate run for this stop time (hint: use output from last exercise)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">true_dist</span><span class="p">)</span>

        <span class="c1"># Log decision</span>
        <span class="n">decisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decision</span>

      <span class="c1"># STEP 2: Calculate accuracy by averaging over trials</span>
      <span class="n">accuracies</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">decisions</span> <span class="o">==</span> <span class="n">true_dist</span><span class="p">)</span> <span class="o">/</span> <span class="n">decisions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

      <span class="c1"># Store the decisions</span>
      <span class="n">decisions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decisions</span><span class="p">)</span>

    <span class="c1"># Calculate analytical accuracy</span>
    <span class="c1"># S_t is a normal variable with SNR scale as sqrt(stop_time)</span>
    <span class="n">sigma_sum_gaussian</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stop_time</span><span class="p">)</span>
    <span class="n">accuracies_analytical</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_sum_gaussian</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">decisions_list</span>


<span class="c1"># Set random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set parameters of model</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">4.65</span>  <span class="c1"># standard deviation for observation noise</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># number of simulations to run for each stopping time</span>
<span class="n">stop_time_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Array of stopping times to use</span>

<span class="c1"># Calculate accuracies for each stop time</span>
<span class="n">accuracies</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span>
                                                   <span class="n">num_sample</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the figure above, we are plotting the simulated accuracies in orange. We can actually find an analytical equation for the average accuracy in this specific case, which we plot in blue. We will not dive into this analytical solution here but you can imagine that if you ran a bunch of different simulations and had the equivalent number of orange lines, the average of those would resemble the blue line.</p>
<p>In the insets, we are showing the evidence distributions for the two states at a certain time point. Recall from Section 1 that the likelihood ratio at time <span class="math notranslate nohighlight">\(T\)</span> for state of +1 is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b69ad5dd-24c1-46a4-b15c-a0ed26a6bc43">
<span class="eqno">(372)<a class="headerlink" href="#equation-b69ad5dd-24c1-46a4-b15c-a0ed26a6bc43" title="Permalink to this equation">¶</a></span>\[\begin{equation}
L_T\sim\mathcal{N}\left(2\frac{\mu^2}{\sigma^2}T,\ 4\frac{\mu^2}{\sigma^2}T\right)=\mathcal{N}(bT,c^2T)
\end{equation}\]</div>
<p>If the state is -1, the mean is the reverse sign. We are plotting this Gaussian distribution for the state equaling -1 (dashed line) and the state equaling +1 (solid line). The area in red reflects the error rate - this region corresponds to <span class="math notranslate nohighlight">\(L_T\)</span> being below 0 even though the true state is +1 so you would decide on the wrong state. As more time goes by, these distributions separate more and the error is lower.</p>
</div>
<div class="section" id="interactive-demo-2-2-accuracy-versus-stop-time">
<h3>Interactive Demo 2.2: Accuracy versus stop-time<a class="headerlink" href="#interactive-demo-2-2-accuracy-versus-stop-time" title="Permalink to this headline">¶</a></h3>
<p>For this same visualization, now vary the mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard deviation <code class="docutils literal notranslate"><span class="pre">sigma</span></code> of the evidence. What do you predict will the accuracy vs stopping time plot look like for low noise and high noise?</p>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Make sure you execute this cell to enable the widget!</span>
<span class="k">def</span> <span class="nf">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">no_numerical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. stopping time by running</span>
<span class="sd">  repeated SPRT simulations for each stop time.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      stop_list_list (list-like object): a list of stopping times to run over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>
<span class="sd">      no_numerical (bool): flag that indicates the function to return analytical values only</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `stop_time_list`</span>
<span class="sd">      decisions_list: a list of decisions made in all trials</span>
<span class="sd">  """</span>

  <span class="c1"># Determine true state (1 or -1)</span>
  <span class="n">true_dist</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># Set up tracker of accuracy and decisions</span>
  <span class="n">accuracies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">accuracies_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">),)</span>
  <span class="n">decisions_list</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="c1"># Loop over stop times</span>
  <span class="k">for</span> <span class="n">i_stop_time</span><span class="p">,</span> <span class="n">stop_time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stop_time_list</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_numerical</span><span class="p">:</span>
      <span class="c1"># Set up tracker of decisions for this stop time</span>
      <span class="n">decisions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_sample</span><span class="p">,))</span>

      <span class="c1"># Loop over samples</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>

        <span class="c1"># Simulate run for this stop time (hint: last exercise)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">simulate_SPRT_fixedtime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">true_dist</span><span class="p">)</span>

        <span class="c1"># Log decision</span>
        <span class="n">decisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decision</span>

      <span class="c1"># Calculate accuracy</span>
      <span class="n">accuracies</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">decisions</span> <span class="o">==</span> <span class="n">true_dist</span><span class="p">)</span> <span class="o">/</span> <span class="n">decisions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="c1"># Log decisions</span>
      <span class="n">decisions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decisions</span><span class="p">)</span>

    <span class="c1"># Calculate analytical accuracy</span>
    <span class="n">sigma_sum_gaussian</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stop_time</span><span class="p">)</span>
    <span class="n">accuracies_analytical</span><span class="p">[</span><span class="n">i_stop_time</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_sum_gaussian</span><span class="p">)</span>


  <span class="k">return</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">decisions_list</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">stop_time_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)):</span>
 <span class="c1"># Calculate accuracies for each stop time</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulate_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">no_numerical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="c1"># Visualize</span>
  <span class="n">plot_accuracy_vs_stoptime</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">stop_time_list</span><span class="p">,</span> <span class="n">accuracies_analytical</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>

<span class="sd">1) Low levels of noise results in higher accuracies generally, especially</span>
<span class="sd">   at early stop times.</span>

<span class="sd">2) High levels of noise generally results in lower accuracies.</span>


<span class="sd">"""</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="video-5-section-2-exercises-discussion">
<h4>Video 5: Section 2 Exercises Discussion<a class="headerlink" href="#video-5-section-2-exercises-discussion" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-input docutils container">
</div>
<p><strong>Application</strong></p>
<p>We have looked at the drift diffusion model of decisions in the context of the fishing problem. There are lots of uses of this in neuroscience! As one example, a classic experimental task in neuroscience is the random dot kinematogram (<a class="reference external" href="https://www.nature.com/articles/341052a0.pdf">Newsome, Britten, Movshon 1989</a>), in which a pattern of moving dots are moving in random directions but with some weak coherence that favors a net rightward or leftward motion. The observer must guess the direction. Neurons in the brain are informative about this task, and have responses that correlate with the choice, as predicted by the Drift Diffusion Model (Huk and Shadlen 2005).</p>
<p>Below is a video by Pamela Reinagle of a rat guessing the direction of motion in such a task.</p>
<p>Rat performing random dot motion task</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>After you finish the other tutorials, come back to see Bonus material to learn about a different stopping rule for DDMs: a fixed threshold on confidence.</p>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 45 minutes</em></p>
<p>Good job! By simulating Drift Diffusion Models, you have learnt how to:</p>
<ul class="simple">
<li><p>Calculate individual sample evidence as the log likelihood ratio of two candidate models</p></li>
<li><p>Accumulate evidence from new data points, and compute posterior using recursive formula</p></li>
<li><p>Run repeated simulations to get an estimate of decision accuracies</p></li>
<li><p>Measure the speed-accuracy tradeoff</p></li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="bonus">
<h1>Bonus<a class="headerlink" href="#bonus" title="Permalink to this headline">¶</a></h1>
<hr class="docutils"/>
<div class="section" id="bonus-section-1-ddm-with-fixed-thresholds-on-confidence">
<h2>Bonus Section 1: DDM with fixed thresholds on confidence<a class="headerlink" href="#bonus-section-1-ddm-with-fixed-thresholds-on-confidence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="video-6-fixed-threshold-on-confidence">
<h3>Video 6: Fixed threshold on confidence<a class="headerlink" href="#video-6-fixed-threshold-on-confidence" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<p>The next exercises consider a variant of the DDM with fixed confidence thresholds instead of fixed decision time. This may be a better description of neural integration. Please complete this material after you have finished the main content of all tutorials, if you would like extra information about this topic.</p>
</div>
<div class="section" id="bonus-coding-exercise-1-1-coding-simulating-the-ddm-with-fixed-confidence-thresholds">
<h3>Bonus Coding Exercise 1.1, Coding: Simulating the DDM with fixed confidence thresholds<a class="headerlink" href="#bonus-coding-exercise-1-1-coding-simulating-the-ddm-with-fixed-confidence-thresholds" title="Permalink to this headline">¶</a></h3>
<p><em>Referred to as exercise 3 in video</em></p>
<p>In this exercise, we will use thresholding as our stopping rule and observe the behavior of the DDM.</p>
<p>With thresholding stopping rule, we define a desired error rate and will continue making measurements until that error rate is reached. Experimental evidence suggested that evidence accumulation and thresholding stopping strategy happens at neuronal level (see <a class="reference external" href="https://www.annualreviews.org/doi/full/10.1146/annurev.neuro.29.051605.113038">this article</a> for further reading).</p>
<ul class="simple">
<li><p>Complete the function <code class="docutils literal notranslate"><span class="pre">threshold_from_errorrate</span></code> to calculate the evidence threshold from desired error rate <span class="math notranslate nohighlight">\(\alpha\)</span> as described in the formulas below. The evidence thresholds <span class="math notranslate nohighlight">\(th_1\)</span> and <span class="math notranslate nohighlight">\(th_0\)</span> for <span class="math notranslate nohighlight">\(p_+\)</span> and <span class="math notranslate nohighlight">\(p_-\)</span> are opposite of each other as shown below, so you can just return the absolute value.</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-906baa93-7213-462c-81c5-13cd880e20d7">
<span class="eqno">(373)<a class="headerlink" href="#equation-906baa93-7213-462c-81c5-13cd880e20d7" title="Permalink to this equation">¶</a></span>\[\begin{align}
th_{L} &amp;= \log \frac{\alpha}{1-\alpha} = -th_{R} \\
th_{R} &amp;= \log \frac{1-\alpha}{\alpha} = -th{_1}
\end{align}\]</div>
<ul class="simple">
<li><p>Complete the function <code class="docutils literal notranslate"><span class="pre">simulate_SPRT_threshold</span></code> to simulate an SPRT with thresholding stopping rule given noise level and desired threshold</p></li>
<li><p>Run repeated simulations for a given noise level and a desired error rate visualize the DDM traces using our provided code</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span> <span class="p">,</span> <span class="n">true_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with thresholding stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation</span>
<span class="sd">    threshold (float): Desired log likelihood ratio threshold to achieve</span>
<span class="sd">                        before making decision</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for pR, 0 for pL</span>
<span class="sd">    data (numpy vector): the generated sequences of data in this trial</span>
<span class="sd">  """</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt; 0"</span>
  <span class="n">muL</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>
  <span class="n">muR</span> <span class="o">=</span> <span class="n">mu</span>

  <span class="n">pL</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muL</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">pR</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muR</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">current_evidence</span> <span class="o">=</span> <span class="mf">0.0</span>

  <span class="c1"># Keep sampling data until threshold is crossed</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="n">has_enough_data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pR</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pL</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># Insert your code here to:</span>
    <span class="c1">#      * Calculate the log-likelihood ratio for the new sample</span>
    <span class="c1">#      * Update the accumulated evidence</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"`simulate_SPRT_threshold` is incomplete"</span><span class="p">)</span>
    <span class="c1">########################################################################</span>

    <span class="c1"># STEP 1: individual log likelihood ratios</span>
    <span class="n">ll_ratio</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="c1"># STEP 2: accumulated evidence for this chunk</span>
    <span class="n">evidence_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="c1"># update the collection of all data</span>
    <span class="n">data_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
    <span class="n">current_evidence</span> <span class="o">=</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># check if we've got enough data</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">current_evidence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
      <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_history</span><span class="p">)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">)</span>

  <span class="c1"># Make decision</span>
  <span class="k">if</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">elif</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">data_history</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.8</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">log10_alpha</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="c1"># log10(alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">log10_alpha</span><span class="p">)</span>

<span class="c1"># Simulate and visualize</span>
<span class="n">simulate_and_plot_SPRT_fixedthreshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span> <span class="p">,</span> <span class="n">true_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with thresholding stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation</span>
<span class="sd">    threshold (float): Desired log likelihood ratio threshold to achieve</span>
<span class="sd">                        before making decision</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for pR, 0 for pL</span>
<span class="sd">    data (numpy vector): the generated sequences of data in this trial</span>
<span class="sd">  """</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt; 0"</span>
  <span class="n">muL</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>
  <span class="n">muR</span> <span class="o">=</span> <span class="n">mu</span>

  <span class="n">pL</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muL</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">pR</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muR</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">current_evidence</span> <span class="o">=</span> <span class="mf">0.0</span>

  <span class="c1"># Keep sampling data until threshold is crossed</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="n">has_enough_data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pR</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pL</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>

    <span class="c1"># STEP 1: individual log likelihood ratios</span>
    <span class="n">ll_ratio</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">pL</span><span class="p">,</span> <span class="n">pR</span><span class="p">)</span>

    <span class="c1"># STEP 2: accumulated evidence for this chunk</span>
    <span class="n">evidence_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ll_ratio</span> <span class="o">+</span> <span class="n">current_evidence</span><span class="p">)</span>

    <span class="c1"># update the collection of all data</span>
    <span class="n">data_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
    <span class="n">current_evidence</span> <span class="o">=</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># check if we've got enough data</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">current_evidence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
      <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_history</span><span class="p">)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">)</span>

  <span class="c1"># Make decision</span>
  <span class="k">if</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">elif</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">data_history</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.8</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">log10_alpha</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="c1"># log10(alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">log10_alpha</span><span class="p">)</span>

<span class="c1"># Simulate and visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">simulate_and_plot_SPRT_fixedthreshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-interactive-demo-1-2-ddm-with-fixed-confidence-threshold">
<h3>Bonus Interactive Demo 1.2: DDM with fixed confidence threshold<a class="headerlink" href="#bonus-interactive-demo-1-2-ddm-with-fixed-confidence-threshold" title="Permalink to this headline">¶</a></h3>
<p>Play with different values of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma</span></code> and observe how that affects the dynamics of Drift-Diffusion Model.</p>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="k">def</span> <span class="nf">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span> <span class="p">,</span> <span class="n">true_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Simulate a Sequential Probability Ratio Test with thresholding stopping</span>
<span class="sd">  rule. Two observation models are 1D Gaussian distributions N(1,sigma^2) and</span>
<span class="sd">  N(-1,sigma^2).</span>

<span class="sd">  Args:</span>
<span class="sd">    mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">    sigma (float): Standard deviation</span>
<span class="sd">    threshold (float): Desired log likelihood ratio threshold to achieve</span>
<span class="sd">                        before making decision</span>

<span class="sd">  Returns:</span>
<span class="sd">    evidence_history (numpy vector): the history of cumulated evidence given</span>
<span class="sd">                                      generated data</span>
<span class="sd">    decision (int): 1 for pR, 0 for pL</span>
<span class="sd">    data (numpy vector): the generated sequences of data in this trial</span>
<span class="sd">  """</span>
  <span class="k">assert</span> <span class="n">mu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Mu should be &gt; 0"</span>
  <span class="n">muL</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span>
  <span class="n">muR</span> <span class="o">=</span> <span class="n">mu</span>

  <span class="n">pL</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muL</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
  <span class="n">pR</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">muR</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

  <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">current_evidence</span> <span class="o">=</span> <span class="mf">0.0</span>

  <span class="c1"># Keep sampling data until threshold is crossed</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="n">has_enough_data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">true_dist</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pR</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">Mvec</span> <span class="o">=</span> <span class="n">pL</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>

    <span class="c1"># STEP 1: individual log likelihood ratios</span>
    <span class="n">ll_ratio</span> <span class="o">=</span> <span class="n">log_likelihood_ratio</span><span class="p">(</span><span class="n">Mvec</span><span class="p">,</span> <span class="n">pL</span><span class="p">,</span> <span class="n">pR</span><span class="p">)</span>

    <span class="c1"># STEP 2: accumulated evidence for this chunk</span>
    <span class="n">evidence_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ll_ratio</span> <span class="o">+</span> <span class="n">current_evidence</span><span class="p">)</span>

    <span class="c1"># update the collection of all data</span>
    <span class="n">data_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
    <span class="n">current_evidence</span> <span class="o">=</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># check if we've got enough data</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">current_evidence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
      <span class="n">has_enough_data</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="n">data_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_history</span><span class="p">)</span>
  <span class="n">evidence_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">evidence_history</span><span class="p">)</span>

  <span class="c1"># Make decision</span>
  <span class="k">if</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">elif</span> <span class="n">evidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">decision</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">return</span> <span class="n">evidence_history</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">data_history</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">10</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">log10_alpha</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)):</span>
  <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">log10_alpha</span><span class="p">)</span>
  <span class="n">simulate_and_plot_SPRT_fixedthreshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-coding-exercise-1-3-speed-accuracy-tradeoff-revisited">
<h3>Bonus Coding Exercise 1.3: Speed/Accuracy Tradeoff Revisited<a class="headerlink" href="#bonus-coding-exercise-1-3-speed-accuracy-tradeoff-revisited" title="Permalink to this headline">¶</a></h3>
<p>The faster you make a decision, the lower your accuracy often is. This phenomenon is known as the <strong>speed/accuracy tradeoff</strong>. Humans can make this tradeoff in a wide range of situations, and many animal species, including ants, bees, rodents, and monkeys also show similar effects.</p>
<p>To illustrate the speed/accuracy tradeoff under thresholding stopping rule, let’s run some simulations under different thresholds and look at how average decision “speed” (1/length) changes with average decision accuracy. We use speed rather than accuracy because in real experiments, subjects can be incentivized to respond faster or slower; it’s much harder to precisely control their decision time or error threshold.</p>
<ul class="simple">
<li><p>Complete the function <code class="docutils literal notranslate"><span class="pre">simulate_accuracy_vs_threshold</span></code> to simulate and compute average accuracies vs. average decision lengths for a list of error thresholds. You will need to supply code to calculate average decision ‘speed’ from the lengths of trials. You should also calculate the overall accuracy across these trials.</p></li>
<li><p>We’ve set up a list of error thresholds. Run repeated simulations and collect average accuracy with average length for each error rate in this list, and use our provided code to visualize the speed/accuracy tradeoff. You should see a positive correlation between length and accuracy.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. average decision length by</span>
<span class="sd">  running repeated SPRT simulations with thresholding stopping rule for each</span>
<span class="sd">  threshold.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      threshold_list (list-like object): a list of evidence thresholds to run</span>
<span class="sd">                                          over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `threshold_list`</span>
<span class="sd">      decision_speed_list: a list of average decision speeds</span>
<span class="sd">  """</span>
  <span class="n">decision_speed_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">threshold_list</span><span class="p">:</span>
    <span class="n">decision_time_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decision_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>
      <span class="c1"># run simulation and get decision of current simulation</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span> <span class="o">=</span> <span class="n">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
      <span class="n">decision_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
      <span class="n">decision_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision</span><span class="p">)</span>
      <span class="n">decision_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_time</span><span class="p">)</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># Insert your code here to:</span>
    <span class="c1">#      * Calculate mean decision speed given a list of decision times</span>
    <span class="c1">#      * Hint: Think about speed as being inversely proportional</span>
    <span class="c1">#        to decision_length. If it takes 10 seconds to make one decision,</span>
    <span class="c1">#        our "decision speed" is 0.1 decisions per second.</span>
    <span class="c1">#      * Calculate the decision accuracy</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"`simulate_accuracy_vs_threshold` is incomplete"</span><span class="p">)</span>
    <span class="c1">########################################################################</span>
    <span class="c1"># Calculate and store average decision speed and accuracy</span>
    <span class="n">decision_speed</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">decision_accuracy</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">decision_speed_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_speed</span><span class="p">)</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_accuracy</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">accuracy_list</span><span class="p">,</span> <span class="n">decision_speed_list</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.75</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">alpha_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">threshold_list</span> <span class="o">=</span> <span class="n">threshold_from_errorrate</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">)</span>

<span class="c1"># Simulate and visualize</span>
<span class="n">simulate_and_plot_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">simulate_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. average decision speed by</span>
<span class="sd">  running repeated SPRT simulations with thresholding stopping rule for each</span>
<span class="sd">  threshold.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      threshold_list (list-like object): a list of evidence thresholds to run</span>
<span class="sd">                                          over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `threshold_list`</span>
<span class="sd">      decision_speed_list: a list of average decision speeds</span>
<span class="sd">  """</span>
  <span class="n">decision_speed_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">threshold_list</span><span class="p">:</span>
    <span class="n">decision_time_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decision_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>
      <span class="c1"># run simulation and get decision of current simulation</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span> <span class="o">=</span> <span class="n">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
      <span class="n">decision_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
      <span class="n">decision_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision</span><span class="p">)</span>
      <span class="n">decision_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_time</span><span class="p">)</span>

    <span class="c1"># Calculate and store average decision speed and accuracy</span>
    <span class="n">decision_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">decision_time_list</span><span class="p">))</span>
    <span class="n">decision_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">decision_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">decision_list</span><span class="p">)</span>
    <span class="n">decision_speed_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_speed</span><span class="p">)</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_accuracy</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">accuracy_list</span><span class="p">,</span> <span class="n">decision_speed_list</span>


<span class="c1"># Set parameters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.75</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">alpha_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">threshold_list</span> <span class="o">=</span> <span class="n">threshold_from_errorrate</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">)</span>

<span class="c1"># Simulate and visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">simulate_and_plot_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-interactive-demo-1-4-speed-accuracy-with-a-threshold-rule">
<h3>Bonus Interactive demo 1.4: Speed/Accuracy with a threshold rule<a class="headerlink" href="#bonus-interactive-demo-1-4-speed-accuracy-with-a-threshold-rule" title="Permalink to this headline">¶</a></h3>
<p>Manipulate the noise level <code class="docutils literal notranslate"><span class="pre">sigma</span></code> and observe how that affects the speed/accuracy tradeoff.</p>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>
<span class="k">def</span> <span class="nf">simulate_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Calculate the average decision accuracy vs. average decision speed by</span>
<span class="sd">  running repeated SPRT simulations with thresholding stopping rule for each</span>
<span class="sd">  threshold.</span>

<span class="sd">  Args:</span>
<span class="sd">      mu (float): absolute mean value of the symmetric observation distributions</span>
<span class="sd">      sigma (float): standard deviation for observation model</span>
<span class="sd">      threshold_list (list-like object): a list of evidence thresholds to run</span>
<span class="sd">                                          over</span>
<span class="sd">      num_sample (int): number of simulations to run per stopping time</span>

<span class="sd">  Returns:</span>
<span class="sd">      accuracy_list: a list of average accuracies corresponding to input</span>
<span class="sd">                      `threshold_list`</span>
<span class="sd">      decision_speed_list: a list of average decision speeds</span>
<span class="sd">  """</span>
  <span class="n">decision_speed_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">accuracy_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">threshold_list</span><span class="p">:</span>
    <span class="n">decision_time_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decision_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sample</span><span class="p">):</span>
      <span class="c1"># run simulation and get decision of current simulation</span>
      <span class="n">_</span><span class="p">,</span> <span class="n">decision</span><span class="p">,</span> <span class="n">Mvec</span> <span class="o">=</span> <span class="n">simulate_SPRT_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
      <span class="n">decision_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>
      <span class="n">decision_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision</span><span class="p">)</span>
      <span class="n">decision_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_time</span><span class="p">)</span>

    <span class="c1"># Calculate and store average decision speed and accuracy</span>
    <span class="n">decision_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">decision_time_list</span><span class="p">))</span>
    <span class="n">decision_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">decision_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">decision_list</span><span class="p">)</span>
    <span class="n">decision_speed_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_speed</span><span class="p">)</span>
    <span class="n">accuracy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decision_accuracy</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">accuracy_list</span><span class="p">,</span> <span class="n">decision_speed_list</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">num_sample</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">alpha_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">threshold_list</span> <span class="o">=</span> <span class="n">threshold_from_errorrate</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">)</span>

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)):</span>
  <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">log10_alpha</span><span class="p">)</span>
  <span class="n">simulate_and_plot_accuracy_vs_threshold</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">threshold_list</span><span class="p">,</span> <span class="n">num_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W3D2_HiddenDynamics/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W3D2_Intro.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Intro</p>
</div>
</a>
<a class="right-next" href="W3D2_Tutorial2.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Tutorial 2: Hidden Markov Model</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br/>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>