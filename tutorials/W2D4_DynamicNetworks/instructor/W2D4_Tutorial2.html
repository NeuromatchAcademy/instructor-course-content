
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 2: Wilson-Cowan Model — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D4_Tutorial3.html" rel="next" title="Bonus Tutorial: Extending the Wilson-Cowan Model"/>
<link href="W2D4_Tutorial1.html" rel="prev" title="Tutorial 1: Neural Rate Models"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training - Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial3.html">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: Wilson-Cowan Model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations">
   Section 1: Wilson-Cowan model of excitatory and inhibitory populations
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-phase-analysis-of-the-wilson-cowan-e-i-model">
     Video 1: Phase analysis of the Wilson-Cowan E-I model
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-mathematical-description-of-the-wc-model">
     Section 1.1: Mathematical description of the WC model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-plot-out-the-f-i-curves-for-the-e-and-i-populations">
       Coding Exercise 1.1: Plot out the F-I curves for the E and I populations
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-simulation-scheme-for-the-wilson-cowan-model">
     Section 1.2: Simulation scheme for the Wilson-Cowan model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-numerically-integrate-the-wilson-cowan-equations">
       Coding Exercise 1.2: Numerically integrate the Wilson-Cowan equations
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-population-trajectories-with-different-initial-values">
       Interactive Demo 1.2: population trajectories with different initial values
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-2">
       Think! 1.2
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-phase-plane-analysis">
   Section 2: Phase plane analysis
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-nullclines-and-vector-fields">
     Video 2: Nullclines and Vector Fields
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane">
     Interactive Demo 2: From the Activity - time plane to the
     <strong>
<span class="math notranslate nohighlight">
       \(r_I\)
      </span>
      -
      <span class="math notranslate nohighlight">
       \(r_E\)
      </span>
</strong>
     phase plane
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-nullclines-of-the-wilson-cowan-equations">
     Section 2.1: Nullclines of the Wilson-Cowan Equations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-compute-the-nullclines-of-the-wilson-cowan-model">
       Coding Exercise 2.1: Compute the nullclines of the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-vector-field">
     Section 2.2: Vector field
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-2-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big">
       Coding Exercise 2.2: Compute and plot the vector field
       <span class="math notranslate nohighlight">
        \(\displaystyle{\Big{(}\frac{dr_E}{dt}, \frac{dr_I}{dt} \Big{)}}\)
       </span>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-2-analyzing-the-vector-field">
     Think! 2.2: Analyzing the vector field
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 2: Wilson-Cowan Model</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: Wilson-Cowan Model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper Functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations">
   Section 1: Wilson-Cowan model of excitatory and inhibitory populations
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-phase-analysis-of-the-wilson-cowan-e-i-model">
     Video 1: Phase analysis of the Wilson-Cowan E-I model
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-mathematical-description-of-the-wc-model">
     Section 1.1: Mathematical description of the WC model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-plot-out-the-f-i-curves-for-the-e-and-i-populations">
       Coding Exercise 1.1: Plot out the F-I curves for the E and I populations
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-simulation-scheme-for-the-wilson-cowan-model">
     Section 1.2: Simulation scheme for the Wilson-Cowan model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-numerically-integrate-the-wilson-cowan-equations">
       Coding Exercise 1.2: Numerically integrate the Wilson-Cowan equations
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-population-trajectories-with-different-initial-values">
       Interactive Demo 1.2: population trajectories with different initial values
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-2">
       Think! 1.2
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-phase-plane-analysis">
   Section 2: Phase plane analysis
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-nullclines-and-vector-fields">
     Video 2: Nullclines and Vector Fields
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane">
     Interactive Demo 2: From the Activity - time plane to the
     <strong>
<span class="math notranslate nohighlight">
       \(r_I\)
      </span>
      -
      <span class="math notranslate nohighlight">
       \(r_E\)
      </span>
</strong>
     phase plane
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-nullclines-of-the-wilson-cowan-equations">
     Section 2.1: Nullclines of the Wilson-Cowan Equations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-compute-the-nullclines-of-the-wilson-cowan-model">
       Coding Exercise 2.1: Compute the nullclines of the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-vector-field">
     Section 2.2: Vector field
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-2-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big">
       Coding Exercise 2.2: Compute and plot the vector field
       <span class="math notranslate nohighlight">
        \(\displaystyle{\Big{(}\frac{dr_E}{dt}, \frac{dr_I}{dt} \Big{)}}\)
       </span>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-2-analyzing-the-vector-field">
     Think! 2.2: Analyzing the vector field
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial2.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-2-wilson-cowan-model">
<h1>Tutorial 2: Wilson-Cowan Model<a class="headerlink" href="#tutorial-2-wilson-cowan-model" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 4: Dynamic Networks</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, Arvind Kumar, John Murray, Julijana Gjorgjieva</p>
<p><strong>Content reviewers:</strong> Maryam Vaziri-Pashkam, Ella Batty, Lorenzo Fontolan, Richard Gao, Spiros Chavlis, Michael Waskom, Siddharth Suresh</p>
<p><strong>Post-production team:</strong> Gagana B, Spiros Chavlis</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 1 hour, 35 minutes</em></p>
<p>In the previous tutorial, you became familiar with a neuronal network consisting of only an excitatory population. Here, we extend the approach we used to include both excitatory and inhibitory neuronal populations in our network. A simple, yet powerful model to study the dynamics of two interacting populations of excitatory and inhibitory neurons, is the so-called <strong>Wilson-Cowan</strong> rate model, which will be the subject of this tutorial.</p>
<p>The objectives of this tutorial are to:</p>
<ul class="simple">
<li><p>Write the <strong>Wilson-Cowan</strong> equations for the firing rate dynamics of a 2D system composed of an excitatory (E) and an inhibitory (I) population of neurons</p></li>
<li><p>Simulate the dynamics of the system, i.e., Wilson-Cowan model.</p></li>
<li><p>Plot the frequency-current (F-I) curves for both populations (i.e., E and I).</p></li>
<li><p>Visualize and inspect the behavior of the system using <strong>phase plane analysis</strong>, <strong>vector fields</strong>, and <strong>nullclines</strong>.</p></li>
</ul>
<p>Bonus steps:</p>
<ul class="simple">
<li><p>Find and plot the <strong>fixed points</strong> of the Wilson-Cowan model.</p></li>
<li><p>Investigate the stability of the Wilson-Cowan model by linearizing its dynamics and examining the <strong>Jacobian matrix</strong>.</p></li>
<li><p>Learn how the Wilson-Cowan model can reach an oscillatory state.</p></li>
</ul>
<p>Bonus steps (applications):</p>
<ul class="simple">
<li><p>Visualize the behavior of an Inhibition-stabilized network.</p></li>
<li><p>Simulate working memory using the Wilson-Cowan model.</p></li>
</ul>
<br/>
<p>Reference paper:</p>
<p>Wilson, H., and Cowan, J. (1972). Excitatory and inhibitory interactions in localized populations of model neurons. <em>Biophysical Journal</em> <strong>12</strong>. doi: <a class="reference external" href="https://doi.org/10.1016/S0006-3495(72)86068-5">10.1016/S0006-3495(72)86068-5</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Tutorial slides</span>
<span class="c1"># @markdown These are the slides for the videos in all tutorials today</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">link_id</span> <span class="o">=</span> <span class="s2">"nvuty"</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"If you want to download the slides: https://osf.io/download/</span><span class="si">{</span><span class="n">link_id</span><span class="si">}</span><span class="s2">/"</span><span class="p">)</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="sa">f</span><span class="s2">"https://mfr.ca-1.osf.io/render?url=https://osf.io/</span><span class="si">{</span><span class="n">link_id</span><span class="si">}</span><span class="s2">/?direct%26mode=render%26action=download%26mode=render"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>  <span class="c1"># root-finding algorithm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting Functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>



<span class="k">def</span> <span class="nf">plot_FI_inverse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"$F^{-1}(x)$"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_FI_EI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'x (a.u.)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'F(x)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_test_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span><span class="p">,</span> <span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE1</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI1</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

  <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE2</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI2</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_vector</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">my_n_skip</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">myscale</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">n_skip</span> <span class="o">=</span> <span class="n">my_n_skip</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">myscale</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mycolor</span><span class="p">,</span> <span class="n">x_init</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for I along the E_grid from dE/dt = 0.</span>

<span class="sd">  Expects:</span>
<span class="sd">  pars    : Parameter dictionary</span>
<span class="sd">  dx      : increment of initial values</span>
<span class="sd">  n       : n*n trjectories</span>
<span class="sd">  mylabel : label for legend</span>

<span class="sd">  Returns:</span>
<span class="sd">    figure of trajectory</span>
<span class="sd">  """</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">ie</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ie</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ii</span>
      <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ie</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ii</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_complete_analysis</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.7</span><span class="p">,</span> <span class="mf">6.</span><span class="p">))</span>

  <span class="c1"># plot example trajectories</span>
  <span class="n">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
                       <span class="s1">'Sample trajectories </span><span class="se">\n</span><span class="s1">for different init. conditions'</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                     <span class="s1">'Sample trajectory for </span><span class="se">\n</span><span class="s1">low activity'</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                     <span class="s1">'Sample trajectory for </span><span class="se">\n</span><span class="s1">high activity'</span><span class="p">)</span>

  <span class="c1"># plot nullclines</span>
  <span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># plot vector field</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">],</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_fp</span><span class="p">(</span><span class="n">x_fp</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'ko'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
           <span class="sa">f</span><span class="s1">'Fixed Point1=</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)'</span><span class="p">,</span>
           <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">,</span>
           <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper Functions</span>

<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1"># Excitatory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>     <span class="c1"># Timescale of the E population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span>      <span class="c1"># Gain of the E population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.8</span>  <span class="c1"># Threshold of the E population</span>

  <span class="c1"># Inhibitory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>    <span class="c1"># Timescale of the I population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Gain of the I population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="c1"># Threshold of the I population</span>

  <span class="c1"># Connection strength</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>   <span class="c1"># E to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span>   <span class="c1"># I to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.</span>  <span class="c1"># E to I</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.</span>  <span class="c1"># I to I</span>

  <span class="c1"># External input</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

  <span class="c1"># simulation parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.</span>        <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>        <span class="c1"># Simulation time step [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of I</span>

  <span class="c1"># External parameters if any</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
      <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="c1"># Vector of discretized time points [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Population activation function, F-I curve</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    f     : the population activation response f(x) for input x</span>
<span class="sd">  """</span>

  <span class="c1"># add the expression of f = F(x)</span>
  <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">theta</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>

  <span class="k">return</span> <span class="n">f</span>


<span class="k">def</span> <span class="nf">dF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Derivative of the population activation function.</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    dFdx  :  Derivative of the population activation function.</span>
<span class="sd">  """</span>

  <span class="n">dFdx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">2</span>

  <span class="k">return</span> <span class="n">dFdx</span>
</pre></div>
</div>
</div>
</div>
<p>The helper functions included:</p>
<ul class="simple">
<li><p>Parameter dictionary: <code class="docutils literal notranslate"><span class="pre">default_pars(**kwargs)</span></code>. You can use:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code> to get all the parameters, and then you can execute <code class="docutils literal notranslate"><span class="pre">print(pars)</span></code> to check these parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars(T=T_sim,</span> <span class="pre">dt=time_step)</span></code> to set a different simulation time and time step</p></li>
<li><p>After <code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code>, use <code class="docutils literal notranslate"><span class="pre">par['New_para']</span> <span class="pre">=</span> <span class="pre">value</span></code> to add a new parameter with its value</p></li>
<li><p>Pass to functions that accept individual parameters with <code class="docutils literal notranslate"><span class="pre">func(**pars)</span></code></p></li>
</ul>
</li>
<li><p>F-I curve: <code class="docutils literal notranslate"><span class="pre">F(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
<li><p>Derivative of the F-I curve: <code class="docutils literal notranslate"><span class="pre">dF(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
</ul>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations">
<h1>Section 1: Wilson-Cowan model of excitatory and inhibitory populations<a class="headerlink" href="#section-1-wilson-cowan-model-of-excitatory-and-inhibitory-populations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-1-phase-analysis-of-the-wilson-cowan-e-i-model">
<h2>Video 1: Phase analysis of the Wilson-Cowan E-I model<a class="headerlink" href="#video-1-phase-analysis-of-the-wilson-cowan-e-i-model" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>This video explains how to model a network with interacting populations of excitatory and inhibitory neurons (the Wilson-Cowan model). It shows how to solve the network activity vs. time and introduces the phase plane in two dimensions.</p>
</div>
<div class="section" id="section-1-1-mathematical-description-of-the-wc-model">
<h2>Section 1.1: Mathematical description of the WC model<a class="headerlink" href="#section-1-1-mathematical-description-of-the-wc-model" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 12 min</em></p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>Many of the rich dynamics recorded in the brain are generated by the interaction of excitatory and inhibitory subtype neurons. Here, similar to what we did in the previous tutorial, we will model two coupled populations of E and I neurons (<strong>Wilson-Cowan</strong> model). We can write two coupled differential equations, each representing the dynamics of the excitatory or inhibitory population:</p>
<div class="amsmath math notranslate nohighlight" id="equation-77ba16e3-9d1d-4c52-b21f-47ded0101368">
<span class="eqno">(323)<a class="headerlink" href="#equation-77ba16e3-9d1d-4c52-b21f-47ded0101368" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= -r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E)\\
\tau_I \frac{dr_I}{dt} &amp;= -r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I)    \qquad (1)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(r_E(t)\)</span> represents the average activation (or firing rate) of the excitatory population at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the activation (or firing rate) of the inhibitory population. The parameters <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> control the timescales of the dynamics of each population. Connection strengths are given by: <span class="math notranslate nohighlight">\(w_{EE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{EI}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{IE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> I), and <span class="math notranslate nohighlight">\(w_{II}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> I). The terms <span class="math notranslate nohighlight">\(w_{EI}\)</span> and <span class="math notranslate nohighlight">\(w_{IE}\)</span> represent connections from inhibitory to excitatory population and vice versa, respectively. The transfer functions (or F-I curves) <span class="math notranslate nohighlight">\(F_E(x;a_E,\theta_E)\)</span> and <span class="math notranslate nohighlight">\(F_I(x;a_I,\theta_I)\)</span> can be different for the excitatory and the inhibitory populations.</p>
<div class="section" id="coding-exercise-1-1-plot-out-the-f-i-curves-for-the-e-and-i-populations">
<h3>Coding Exercise 1.1: Plot out the F-I curves for the E and I populations<a class="headerlink" href="#coding-exercise-1-1-plot-out-the-f-i-curves-for-the-e-and-i-populations" title="Permalink to this headline">¶</a></h3>
<p>Let’s first plot out the F-I curves for the E and I populations using the helper function <code class="docutils literal notranslate"><span class="pre">F</span></code> with default parameter values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">])</span>

<span class="c1">###################################################################</span>
<span class="c1"># TODO for students: compute and plot the F-I curve here          #</span>
<span class="c1"># Note: aE, thetaE, aI and theta_I are in the dictionary 'pairs'   #</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">'student exercise: compute F-I curves of excitatory and inhibitory populations'</span><span class="p">)</span>
<span class="c1">###################################################################</span>

<span class="c1"># Compute the F-I curve of the excitatory population</span>
<span class="n">FI_exc</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Compute the F-I curve of the inhibitory population</span>
<span class="n">FI_inh</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Visualize</span>
<span class="n">plot_FI_EI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">])</span>

<span class="c1"># Compute the F-I curve of the excitatory population</span>
<span class="n">FI_exc</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">])</span>

<span class="c1"># Compute the F-I curve of the inhibitory population</span>
<span class="n">FI_inh</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">])</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_FI_EI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</details></div>
<div class="section" id="section-1-2-simulation-scheme-for-the-wilson-cowan-model">
<h2>Section 1.2: Simulation scheme for the Wilson-Cowan model<a class="headerlink" href="#section-1-2-simulation-scheme-for-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 20 min</em></p>
<p>Once again, we can integrate our equations numerically. Using the Euler method, the dynamics of E and I populations can be simulated on a time-grid of stepsize <span class="math notranslate nohighlight">\(\Delta t\)</span>. The updates for the activity of the excitatory and the inhibitory populations can be written as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7210bf79-d49c-4ad1-b704-54fadf4019f9">
<span class="eqno">(324)<a class="headerlink" href="#equation-7210bf79-d49c-4ad1-b704-54fadf4019f9" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E[k+1] &amp;= r_E[k] + \Delta r_E[k]\\
r_I[k+1] &amp;= r_I[k] + \Delta r_I[k] 
\end{align}\]</div>
<p>with the increments</p>
<div class="amsmath math notranslate nohighlight" id="equation-322644ab-c923-4d80-8076-d1d48bf66fb7">
<span class="eqno">(325)<a class="headerlink" href="#equation-322644ab-c923-4d80-8076-d1d48bf66fb7" title="Permalink to this equation">¶</a></span>\[\begin{align}
\Delta r_E[k] &amp;= \frac{\Delta t}{\tau_E}[-r_E[k] + F_E(w_{EE}r_E[k] -w_{EI}r_I[k] + I^{\text{ext}}_E[k];a_E,\theta_E)]\\
\Delta r_I[k] &amp;= \frac{\Delta t}{\tau_I}[-r_I[k] + F_I(w_{IE}r_E[k] -w_{II}r_I[k] + I^{\text{ext}}_I[k];a_I,\theta_I)] 
\end{align}\]</div>
<div class="section" id="coding-exercise-1-2-numerically-integrate-the-wilson-cowan-equations">
<h3>Coding Exercise 1.2: Numerically integrate the Wilson-Cowan equations<a class="headerlink" href="#coding-exercise-1-2-numerically-integrate-the-wilson-cowan-equations" title="Permalink to this headline">¶</a></h3>
<p>We will implement this numerical simulation of our equations and visualize two simulations with similar initial points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">simulate_wc</span><span class="p">(</span><span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span>
                <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
                <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Simulate the Wilson-Cowan equations</span>

<span class="sd">  Args:</span>
<span class="sd">    Parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE, rI (arrays) : Activity of excitatory and inhibitory populations</span>
<span class="sd">  """</span>
  <span class="c1"># Initialize activity arrays</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rI_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">I_ext_E</span> <span class="o">=</span> <span class="n">I_ext_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">I_ext_I</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># Simulate the Wilson-Cowan equations</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># TODO for students: compute drE and drI and remove the error</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the change in E/I"</span><span class="p">)</span>
    <span class="c1">########################################################################</span>

    <span class="c1"># Calculate the derivative of the E population</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="o">...</span>

    <span class="c1"># Calculate the derivative of the I population</span>
    <span class="n">drI</span> <span class="o">=</span> <span class="o">...</span>

    <span class="c1"># Update using Euler's method</span>
    <span class="n">rE</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drE</span>
    <span class="n">rI</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drI</span>

  <span class="k">return</span> <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="c1"># Simulate first trajectory</span>
<span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">.32</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">))</span>

<span class="c1"># Simulate second trajectory</span>
<span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">.33</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">))</span>

<span class="c1"># Visualize</span>
<span class="n">my_test_plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span><span class="p">,</span> <span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">simulate_wc</span><span class="p">(</span><span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span>
                <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
                <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Simulate the Wilson-Cowan equations</span>

<span class="sd">  Args:</span>
<span class="sd">    Parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE, rI (arrays) : Activity of excitatory and inhibitory populations</span>
<span class="sd">  """</span>
  <span class="c1"># Initialize activity arrays</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rI_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">I_ext_E</span> <span class="o">=</span> <span class="n">I_ext_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">I_ext_I</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># Simulate the Wilson-Cowan equations</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Calculate the derivative of the E population</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_E</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                                   <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span>

    <span class="c1"># Calculate the derivative of the I population</span>
    <span class="n">drI</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_I</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                                   <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span>

    <span class="c1"># Update using Euler's method</span>
    <span class="n">rE</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drE</span>
    <span class="n">rI</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drI</span>

  <span class="k">return</span> <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="c1"># Simulate first trajectory</span>
<span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">.32</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">))</span>

<span class="c1"># Simulate second trajectory</span>
<span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">.33</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">))</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">my_test_plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span><span class="p">,</span> <span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The two plots above show the temporal evolution of excitatory (<span class="math notranslate nohighlight">\(r_E\)</span>, blue) and inhibitory (<span class="math notranslate nohighlight">\(r_I\)</span>, red) activity for two different sets of initial conditions.</p>
</div>
<div class="section" id="interactive-demo-1-2-population-trajectories-with-different-initial-values">
<h3>Interactive Demo 1.2: population trajectories with different initial values<a class="headerlink" href="#interactive-demo-1-2-population-trajectories-with-different-initial-values" title="Permalink to this headline">¶</a></h3>
<p>In this interactive demo, we will simulate the Wilson-Cowan model and plot the trajectories of each population. We change the initial activity of the excitatory population.</p>
<p>What happens to the E and I population trajectories with different initial conditions?</p>
<div class="section" id="id1">
<h4><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">plot_EI_diffinitial</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">rE_init</span><span class="o">=</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">.15</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_EI_diffinitial</span><span class="p">,</span> <span class="n">rE_init</span><span class="o">=</span><span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>
<span class="sd">"""</span>
<span class="sd">Sometimes both the excitatory and inhibitory population activities decay to 0 and</span>
<span class="sd">sometimes they level out at different positive values.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="think-1-2">
<h3>Think! 1.2<a class="headerlink" href="#think-1-2" title="Permalink to this headline">¶</a></h3>
<p>It is evident that the steady states of the neuronal response can be different when different initial states are chosen. Why is that?</p>
<p>We will discuss this in the next section but try to think about it first.</p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-phase-plane-analysis">
<h1>Section 2: Phase plane analysis<a class="headerlink" href="#section-2-phase-plane-analysis" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing to here from start of tutorial: 45 min</em></p>
<p>Just like we used a graphical method to study the dynamics of a 1-D system in the previous tutorial, here we will learn a  graphical approach called <strong>phase plane analysis</strong> to study the dynamics of a 2-D system like the Wilson-Cowan model. You have seen this before in the <a class="reference external" href="https://compneuro.neuromatch.io/tutorials/W0D4_Calculus/student/W0D4_Tutorial3.html#section-3-2-phase-plane-plot-and-nullcline">pre-reqs calculus day</a> and on the <a class="reference external" href="https://compneuro.neuromatch.io/tutorials/W2D2_LinearSystems/student/W2D2_Tutorial1.html#section-4-stream-plots">Linear Systems day</a></p>
<p>So far, we have plotted the activities of the two populations as a function of time, i.e., in the <code class="docutils literal notranslate"><span class="pre">Activity-t</span></code> plane, either the <span class="math notranslate nohighlight">\((t, r_E(t))\)</span> plane or the <span class="math notranslate nohighlight">\((t, r_I(t))\)</span> one. Instead, we can plot the two activities <span class="math notranslate nohighlight">\(r_E(t)\)</span> and <span class="math notranslate nohighlight">\(r_I(t)\)</span> against each other at any time point <span class="math notranslate nohighlight">\(t\)</span>. This characterization in the <code class="docutils literal notranslate"><span class="pre">rI-rE</span></code> plane <span class="math notranslate nohighlight">\((r_I(t), r_E(t))\)</span> is called the <strong>phase plane</strong>. Each line in the phase plane indicates how both <span class="math notranslate nohighlight">\(r_E\)</span> and <span class="math notranslate nohighlight">\(r_I\)</span> evolve with time.</p>
<div class="section" id="video-2-nullclines-and-vector-fields">
<h2>Video 2: Nullclines and Vector Fields<a class="headerlink" href="#video-2-nullclines-and-vector-fields" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="interactive-demo-2-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane">
<h2>Interactive Demo 2: From the Activity - time plane to the <strong><span class="math notranslate nohighlight">\(r_I\)</span> - <span class="math notranslate nohighlight">\(r_E\)</span></strong> phase plane<a class="headerlink" href="#interactive-demo-2-from-the-activity-time-plane-to-the-r-i-r-e-phase-plane" title="Permalink to this headline">¶</a></h2>
<p>In this demo, we will visualize the system dynamics using both the <code class="docutils literal notranslate"><span class="pre">Activity-time</span></code> and the <code class="docutils literal notranslate"><span class="pre">(rE,</span> <span class="pre">rI)</span></code> phase plane. The circles indicate the activities at a given time <span class="math notranslate nohighlight">\(t\)</span>, while the lines represent the evolution of the system for the entire duration of the simulation.</p>
<p>Move the time slider to better understand how the top plot relates to the bottom plot. Does the bottom plot have explicit information about time? What information does it give us?</p>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rE_init</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">rI_init</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_activity_phase</span><span class="p">(</span><span class="n">n_t</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rE</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">'bo'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">'ro'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">n_t</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="n">n_t</span><span class="p">],</span> <span class="s1">'ko'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_activity_phase</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">- Phase plane portraits allows us to visualize out of all possible states which</span>
<span class="sd">states a system can take. For example in this demo you see that the among all</span>
<span class="sd">possible pairs of values for r1 and r2, this system can take only a limited number</span>
<span class="sd">of states (those that lie on the black line).</span>

<span class="sd">- There are other things we can infer from the phase portraits e.g. fixed</span>
<span class="sd">points, trajectory to the fixed points etc.</span>

<span class="sd">- Explicit information about time is not visible in the phase portraits</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-2-1-nullclines-of-the-wilson-cowan-equations">
<h2>Section 2.1: Nullclines of the Wilson-Cowan Equations<a class="headerlink" href="#section-2-1-nullclines-of-the-wilson-cowan-equations" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 1 hour, 3 min</em></p>
<p>An important concept in the phase plane analysis is the “nullcline” which is defined as the set of points in the phase plane where the activity of one population (but not necessarily the other) does not change.</p>
<p>In other words, the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> nullclines of Equation <span class="math notranslate nohighlight">\((1)\)</span> are defined as the points where <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E}{dt}}=0\)</span>, for the excitatory nullcline, or <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_I}{dt}=0\)</span> for the inhibitory nullcline. That is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7ed13b87-2cf4-4fce-aa85-b5b3308141d3">
<span class="eqno">(326)<a class="headerlink" href="#equation-7ed13b87-2cf4-4fce-aa85-b5b3308141d3" title="Permalink to this equation">¶</a></span>\[\begin{align}
-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E) &amp;= 0  \qquad (2)\\[1mm]
-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I) &amp;= 0  \qquad (3)
\end{align}\]</div>
<div class="section" id="coding-exercise-2-1-compute-the-nullclines-of-the-wilson-cowan-model">
<h3>Coding Exercise 2.1: Compute the nullclines of the Wilson-Cowan model<a class="headerlink" href="#coding-exercise-2-1-compute-the-nullclines-of-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>In the next exercise, we will compute and plot the nullclines of the E and I population.</p>
<p>Along the nullcline of excitatory population Equation <span class="math notranslate nohighlight">\(2\)</span>, you can calculate the inhibitory activity by rewriting Equation <span class="math notranslate nohighlight">\(2\)</span> into</p>
<div class="amsmath math notranslate nohighlight" id="equation-7c128287-1d79-4848-bca4-e589d1774589">
<span class="eqno">(327)<a class="headerlink" href="#equation-7c128287-1d79-4848-bca4-e589d1774589" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_I = \frac{1}{w_{EI}}\big{[}w_{EE}r_E - F_E^{-1}(r_E; a_E,\theta_E) + I^{\text{ext}}_E \big{]}. \qquad(4)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_E^{-1}(r_E; a_E,\theta_E)\)</span> is the inverse of the excitatory transfer function (defined below). Equation <span class="math notranslate nohighlight">\(4\)</span> defines the <span class="math notranslate nohighlight">\(r_E\)</span> nullcline.</p>
<p>Along the nullcline of inhibitory population Equation <span class="math notranslate nohighlight">\(3\)</span>, you can calculate the excitatory activity by rewriting Equation <span class="math notranslate nohighlight">\(3\)</span> into</p>
<div class="amsmath math notranslate nohighlight" id="equation-e60e286a-c5f5-43e3-8fd3-669110f0fd80">
<span class="eqno">(328)<a class="headerlink" href="#equation-e60e286a-c5f5-43e3-8fd3-669110f0fd80" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_E = \frac{1}{w_{IE}} \big{[} w_{II}r_I + F_I^{-1}(r_I;a_I,\theta_I) - I^{\text{ext}}_I \big{]}  \qquad (5)
\end{align}\]</div>
<p>shere <span class="math notranslate nohighlight">\(F_I^{-1}(r_I; a_I,\theta_I)\)</span> is the inverse of the inhibitory transfer function (defined below). Equation <span class="math notranslate nohighlight">\(5\)</span> defines the <span class="math notranslate nohighlight">\(I\)</span> nullcline.</p>
<p>Note that, when computing the nullclines with Equations 4-5, we also need to calculate the inverse of the transfer functions.</p>
<p>The inverse of the sigmoid shaped <strong>f-I</strong> function that we have been using is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a13224be-cd07-4d08-a558-24a9cc018a4c">
<span class="eqno">(329)<a class="headerlink" href="#equation-a13224be-cd07-4d08-a558-24a9cc018a4c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
F^{-1}(x; a, \theta) = -\frac{1}{a} \ln \left[ \frac{1}{x + \displaystyle \frac{1}{1+\text{e}^{a\theta}}} - 1 \right] + \theta \qquad (6)
\end{equation}\]</div>
<p>The first step is to implement the inverse transfer function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    x         : the population input</span>
<span class="sd">    a         : the gain of the function</span>
<span class="sd">    theta     : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    F_inverse : value of the inverse function</span>
<span class="sd">  """</span>

  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute F_inverse</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the inverse of F(x)"</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>

  <span class="c1"># Calculate Finverse (ln(x) can be calculated as np.log(x))</span>
  <span class="n">F_inverse</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">F_inverse</span>


<span class="c1"># Set parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Get inverse and visualize</span>
<span class="n">plot_FI_inverse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    x         : the population input</span>
<span class="sd">    a         : the gain of the function</span>
<span class="sd">    theta     : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    F_inverse : value of the inverse function</span>
<span class="sd">  """</span>

  <span class="c1"># Calculate Finverse (ln(x) can be calculated as np.log(x))</span>
  <span class="n">F_inverse</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">theta</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta</span>

  <span class="k">return</span> <span class="n">F_inverse</span>


<span class="c1"># Set parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Get inverse and visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_FI_inverse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now you can compute the nullclines, using Equations 4-5 (repeated here for ease of access):</p>
<div class="amsmath math notranslate nohighlight" id="equation-53c4e0f0-e310-4b9e-8ea0-cb784b7c3a3a">
<span class="eqno">(330)<a class="headerlink" href="#equation-53c4e0f0-e310-4b9e-8ea0-cb784b7c3a3a" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_I &amp;= \frac{1}{w_{EI}}\big{[}w_{EE}r_E - F_E^{-1}(r_E; a_E,\theta_E) + I^{\text{ext}}_E \big{]} &amp;\qquad(4) \\
r_E &amp;= \frac{1}{w_{IE}} \big{[} w_{II}r_I + F_I^{-1}(r_I;a_I,\theta_I) - I^{\text{ext}}_I \big{]} &amp;\qquad (5) 
\end{align}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">get_E_nullcline</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for rI along the rE from drE/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rE    : response of excitatory population</span>
<span class="sd">    a_E, theta_E, wEE, wEI, I_ext_E : Wilson-Cowan excitatory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rI    : values of inhibitory population along the nullcline on the rE</span>
<span class="sd">  """</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute rI for rE nullcline and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the E nullcline"</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>

  <span class="c1"># calculate rI for E nullclines on rI</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rI</span>


<span class="k">def</span> <span class="nf">get_I_nullcline</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for E along the rI from dI/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rI    : response of inhibitory population</span>
<span class="sd">    a_I, theta_I, wIE, wII, I_ext_I : Wilson-Cowan inhibitory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE    : values of the excitatory population along the nullcline on the rI</span>
<span class="sd">  """</span>
  <span class="c1">#########################################################################</span>
  <span class="c1"># TODO for students: compute rI for rE nullcline and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the I nullcline"</span><span class="p">)</span>
  <span class="c1">#########################################################################</span>

  <span class="c1"># calculate rE for I nullclines on rI</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rE</span>


<span class="c1"># Set parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Compute nullclines</span>
<span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="n">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">get_E_nullcline</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for rI along the rE from drE/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rE    : response of excitatory population</span>
<span class="sd">    a_E, theta_E, wEE, wEI, I_ext_E : Wilson-Cowan excitatory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rI    : values of inhibitory population along the nullcline on the rE</span>
<span class="sd">  """</span>
  <span class="c1"># calculate rI for E nullclines on rI</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">wEI</span> <span class="o">*</span> <span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">)</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">rI</span>


<span class="k">def</span> <span class="nf">get_I_nullcline</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for E along the rI from dI/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rI    : response of inhibitory population</span>
<span class="sd">    a_I, theta_I, wIE, wII, I_ext_I : Wilson-Cowan inhibitory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE    : values of the excitatory population along the nullcline on the rI</span>
<span class="sd">  """</span>
  <span class="c1"># calculate rE for I nullclines on rI</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">wIE</span> <span class="o">*</span> <span class="p">(</span><span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">)</span> <span class="o">-</span> <span class="n">I_ext_I</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">rE</span>


<span class="c1"># Set parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Compute nullclines</span>
<span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="c1"># Visualize</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that by definition along the blue line in the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span>, <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} = 0\)</span>, therefore, it is called a nullcline.</p>
<p>That is, the blue nullcline divides the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span> into two regions: on one side of the nullcline <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} &gt; 0\)</span> and on the other side <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_E(t)}{dt}} &lt; 0\)</span>.</p>
<p>The same is true for the red line along which <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} = 0\)</span>. That is, the red nullcline divides the phase-plane spanned by <span class="math notranslate nohighlight">\(r_E, r_I\)</span> into two regions: on one side of the nullcline <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} &gt; 0\)</span> and on the other side <span class="math notranslate nohighlight">\(\displaystyle{\frac{dr_I(t)}{dt}} &lt; 0\)</span>.</p>
</div>
</div>
<div class="section" id="section-2-2-vector-field">
<h2>Section 2.2: Vector field<a class="headerlink" href="#section-2-2-vector-field" title="Permalink to this headline">¶</a></h2>
<p><em>Estimated timing to here from start of tutorial: 1 hour, 20 min</em></p>
<p>How can the phase plane and the nullcline curves help us understand the behavior of the Wilson-Cowan model?</p>
<details>
<summary> <font color="blue">Click here for text recap of relevant part of video </font></summary>
<p>The activities of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> populations <span class="math notranslate nohighlight">\(r_E(t)\)</span> and <span class="math notranslate nohighlight">\(r_I(t)\)</span> at each time point <span class="math notranslate nohighlight">\(t\)</span> correspond to a single point in the phase plane, with coordinates <span class="math notranslate nohighlight">\((r_E(t),r_I(t))\)</span>. Therefore, the time-dependent trajectory of the system can be described as a continuous curve in the phase plane, and the tangent vector to the trajectory, which is defined as the vector <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E(t)}{dt},\frac{dr_I(t)}{dt}}\bigg{)}\)</span>, indicates the direction towards which the activity is evolving and how fast is the activity changing along each axis. In fact, for each point <span class="math notranslate nohighlight">\((E,I)\)</span> in the phase plane, we can compute the tangent vector <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E}{dt},\frac{dr_I}{dt}}\bigg{)}\)</span>, which  indicates the behavior of the system when it traverses that point.</p>
<p>The map of tangent vectors in the phase plane is called <strong>vector field</strong>. The behavior of any trajectory in the phase plane is determined by i) the initial conditions <span class="math notranslate nohighlight">\((r_E(0),r_I(0))\)</span>, and ii) the vector field <span class="math notranslate nohighlight">\(\bigg{(}\displaystyle{\frac{dr_E(t)}{dt},\frac{dr_I(t)}{dt}}\bigg{)}\)</span>.</p>
<p>In general, the value of the vector field at a particular point in the phase plane is represented by an arrow. The orientation and the size of the arrow reflect the direction and the norm of the vector, respectively.</p>
<div class="section" id="coding-exercise-2-2-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big">
<h3>Coding Exercise 2.2: Compute and plot the vector field <span class="math notranslate nohighlight">\(\displaystyle{\Big{(}\frac{dr_E}{dt}, \frac{dr_I}{dt} \Big{)}}\)</span><a class="headerlink" href="#coding-exercise-2-2-compute-and-plot-the-vector-field-displaystyle-big-frac-dr-e-dt-frac-dr-i-dt-big" title="Permalink to this headline">¶</a></h3>
<p>Note that</p>
<div class="amsmath math notranslate nohighlight" id="equation-06809c4f-eaba-4a80-8431-8e19d43b0347">
<span class="eqno">(331)<a class="headerlink" href="#equation-06809c4f-eaba-4a80-8431-8e19d43b0347" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dr_E}{dt} &amp;= [-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E)]\frac{1}{\tau_E}\\
\frac{dr_I}{dt} &amp;= [-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I)]\frac{1}{\tau_I}    
\end{align}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span>
             <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
             <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
             <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Time derivatives for E/I variables (dE/dt, dI/dt)."""</span>
  <span class="c1">######################################################################</span>
  <span class="c1"># TODO for students: compute drEdt and drIdt and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the vector field"</span><span class="p">)</span>
  <span class="c1">######################################################################</span>

  <span class="c1"># Compute the derivative of rE</span>
  <span class="n">drEdt</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Compute the derivative of rI</span>
  <span class="n">drIdt</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span>


<span class="c1"># Create vector field using EIderivs</span>
<span class="n">plot_complete_analysis</span><span class="p">(</span><span class="n">default_pars</span><span class="p">())</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span>
             <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
             <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
             <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Time derivatives for E/I variables (dE/dt, dI/dt)."""</span>

  <span class="c1"># Compute the derivative of rE</span>
  <span class="n">drEdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>

  <span class="c1"># Compute the derivative of rI</span>
  <span class="n">drIdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span>


<span class="c1"># Create vector field using EIderivs</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_complete_analysis</span><span class="p">(</span><span class="n">default_pars</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>The last phase plane plot shows us that:</p>
<ul class="simple">
<li><p>Trajectories seem to follow the direction of the vector field.</p></li>
<li><p>Different trajectories eventually always reach one of two points depending on the initial conditions.</p></li>
<li><p>The two points where the trajectories converge are the intersection of the two nullcline curves.</p></li>
</ul>
</div>
</details></div>
<div class="section" id="think-2-2-analyzing-the-vector-field">
<h2>Think! 2.2: Analyzing the vector field<a class="headerlink" href="#think-2-2-analyzing-the-vector-field" title="Permalink to this headline">¶</a></h2>
<p>There are, in total, three intersection points, meaning that the system has three fixed points.</p>
<ol class="simple">
<li><p>One of the fixed points (the one in the middle) is never the final state of a trajectory. Why is that?</p></li>
<li><p>Why do the arrows tend to get smaller as they approach the fixed points?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>
<span class="sd">"""</span>
<span class="sd">1. Because the middle fixed point is unstable. Trajectories only point to stable</span>
<span class="sd">fixed points.</span>

<span class="sd">2. The slope of dr/dt determines the speed at which the system states will evolve.</span>
<span class="sd">At the nullclines dr_e/dt = 0 and/or dr_i/dt = 0. That means as we move close to</span>
<span class="sd">the nullclines the dr/dt becomes smaller and smaller. Therefore the system state</span>
<span class="sd">evolves slower and slower as we approach the nullcline.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p><em>Estimated timing of tutorial: 1 hour, 35 minutes</em></p>
<p>Congratulations! You have finished the fourth day of the second week of the neuromatch academy! Here, you learned how to simulate a rate based model consisting of excitatory and inhibitory population of neurons.</p>
<p>In the last tutorial on dynamical neuronal networks you learned to:</p>
<ul class="simple">
<li><p>Implement and simulate a 2D system composed of an E and an I population of neurons using the <strong>Wilson-Cowan</strong> model</p></li>
<li><p>Plot the frequency-current (F-I) curves for both populations</p></li>
<li><p>Examine the behavior of the system using phase <strong>plane analysis</strong>, <strong>vector fields</strong>, and <strong>nullclines</strong>.</p></li>
</ul>
<p>Do you have more time? Have you finished early? We have more fun material for you!</p>
<p>In the bonus tutorial, there are some, more advanced concepts on dynamical systems:</p>
<ul class="simple">
<li><p>You will learn how to find the fixed points on such a system, and to investigate its stability by linearizing its dynamics and examining the <strong>Jacobian matrix</strong>.</p></li>
<li><p>You will identify conditions under which the Wilson-Cowan model can exhibit oscillations.</p></li>
</ul>
<p>If you need even more, there are two applications of the Wilson-Cowan model:</p>
<ul class="simple">
<li><p>Visualization of an Inhibition-stabilized network</p></li>
<li><p>Simulation of working memory</p></li>
</ul>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D4_DynamicNetworks/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W2D4_Tutorial1.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 1: Neural Rate Models</p>
</div>
</a>
<a class="right-next" href="W2D4_Tutorial3.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Bonus Tutorial: Extending the Wilson-Cowan Model</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>