
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Bonus Tutorial: Extending the Wilson-Cowan Model — Neuromatch Academy: Computational Neuroscience (instructor's version)</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D4_Outro.html" rel="next" title="Outro"/>
<link href="W2D4_Tutorial2.html" rel="prev" title="Tutorial 2: Wilson-Cowan Model"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience (instructor's version)</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../prereqs/ComputationalNeuroscience.html">
   Prerequisites and preparatory materials for NMA Computational Neuroscience
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../tatraining/TA_Training_CN.html">
   TA Training - Computational Neuroscience
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/instructor/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/instructor/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/instructor/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/instructor/W0D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial1.html">
     Tutorial 1: Differentiation and Integration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/instructor/W0D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial1.html">
     Tutorial 1: Probability Distributions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/instructor/W0D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Tutorial4.html">
     Tutorial 4: Model Discussions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/instructor/W1D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_ModelingPractice/chapter_title.html">
   Modeling Practice (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_ModelingPractice/instructor/W2D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelFitting/chapter_title.html">
   Model Fitting (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelFitting/instructor/W1D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_GeneralizedLinearModels/instructor/W1D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_DimensionalityReduction/instructor/W1D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DeepLearning/chapter_title.html">
   Deep Learning (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial3.html">
     Tutorial 3: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Tutorial4.html">
     Bonus Tutorial: Diving Deeper into Decoding &amp; Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DeepLearning/instructor/W1D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Bonus_Autoencoders/chapter_title.html">
   Autoencoders (Bonus)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial1.html">
     Tutorial 1: Intro to Autoencoders
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial2.html">
     Tutorial 2: Autoencoder extensions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Tutorial3.html">
     Tutorial 3: Autoencoders applications
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Bonus_Autoencoders/instructor/Bonus_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/MachineLearning.html">
   Machine Learning Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/instructor/W2D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Tutorial4.html">
     Bonus Tutorial: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_BiologicalNeuronModels/instructor/W2D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Bonus Tutorial: Extending the Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/DynamicalSystems.html">
   Dynamical Systems Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial : Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/instructor/W3D1_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial3.html">
     Tutorial 3: The Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial4.html">
     Bonus Tutorial 4: The Kalman Filter, part 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Tutorial5.html">
     Bonus Tutorial 5: Expectation Maximization for spiking neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/instructor/W3D2_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/instructor/W3D3_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/instructor/W3D4_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
<label for="toctree-checkbox-24">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/instructor/W3D5_DaySummary.html">
     Day Summary
    </a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../Module_WrapUps/StochasticProcesses.html">
   Stochastic Processes Wrap-Up
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
<label for="toctree-checkbox-25">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through4.html">
     Modeling Steps 1 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through10.html">
     Modeling Steps 5 - 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModel.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProject.html">
     Example Data Project: the Train Illusion
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Datasets
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
<label for="toctree-checkbox-26">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/neurons.html">
     Neurons
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
<label for="toctree-checkbox-27">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/neurons/neurons_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/fMRI.html">
     fMRI
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
<label for="toctree-checkbox-28">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/fMRI/fMRI_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/ECoG.html">
     ECoG
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
<label for="toctree-checkbox-29">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ECoG/ECoG_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/behavior.html">
     Behavior
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
<label for="toctree-checkbox-30">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/README.html">
       Guide
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/behavior/behavior_videos.html">
       Overview videos
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/docs/theory.html">
     Theory
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
<label for="toctree-checkbox-31">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/theory/README.html">
       Guide
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_templates.html">
   Project Templates
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_2020_highlights.html">
   Projects 2020
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
<label for="toctree-checkbox-32">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/neurons.html">
     Neurons
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/theory.html">
     Theory
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/behavior.html">
     Behavior
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/fMRI.html">
     fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/docs/projects_2020/eeg.html">
     EEG
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Bonus Tutorial: Extending the Wilson-Cowan Model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model">
   Section 1: Fixed points, stability analysis, and limit cycles in the Wilson-Cowan model
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-fixed-points-and-their-stability">
     Video 1: Fixed points and their stability
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-fixed-points-of-the-e-i-system">
     Section 1.1: Fixed Points of the E/I system
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-find-the-fixed-points-of-the-wilson-cowan-model">
       Coding Exercise 1.1: Find the fixed points of the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix">
     Section 1.2: Stability of a fixed point and eigenvalues of the Jacobian Matrix
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-compute-the-jacobian-matrix-for-the-wilson-cowan-model">
       Coding Exercise 1.2: Compute the Jacobian Matrix for the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-3-effect-of-wee-on-the-nullclines-and-the-eigenvalues">
     Section 1.3: Effect of
     <code class="docutils literal notranslate">
<span class="pre">
       wEE
      </span>
</code>
     on the nullclines and the eigenvalues
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-3-nullclines-position-in-the-phase-plane-changes-with-parameter-values">
       Interactive Demo 1.3: Nullclines position in the phase plane changes with parameter values
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-4-limit-cycle-oscillations">
     Section 1.4: Limit cycle - Oscillations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-4-limit-cycle-and-oscillations">
       Interactive Demo 1.4: Limit cycle and oscillations.
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-inhibition-stabilized-network-isn">
   Section 2: Inhibition-stabilized network (ISN)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-inhibition-stabilized-network">
     Section 2.1: Inhibition-stabilized network
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-compute-displaystyle-frac-partial-g-e-partial-r-e">
       Coding Exercise 2.1: Compute
       <span class="math notranslate nohighlight">
        \(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)
       </span>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-nullcline-analysis-of-the-isn">
     Section 2.2: Nullcline analysis of the ISN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-nullclines-of-example-isn-and-non-isn">
       Interactive Demo 2.2: Nullclines of Example
       <strong>
        ISN
       </strong>
       and
       <strong>
        non-ISN
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-fixed-point-and-working-memory">
   Section 3: Fixed point and working memory
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-short-pulse-induced-persistent-activity">
     Interactive Demo 3: Short pulse induced persistent activity
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Bonus Tutorial: Extending the Wilson-Cowan Model</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Bonus Tutorial: Extending the Wilson-Cowan Model
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting Functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model">
   Section 1: Fixed points, stability analysis, and limit cycles in the Wilson-Cowan model
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-fixed-points-and-their-stability">
     Video 1: Fixed points and their stability
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-fixed-points-of-the-e-i-system">
     Section 1.1: Fixed Points of the E/I system
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-1-find-the-fixed-points-of-the-wilson-cowan-model">
       Coding Exercise 1.1: Find the fixed points of the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix">
     Section 1.2: Stability of a fixed point and eigenvalues of the Jacobian Matrix
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-2-compute-the-jacobian-matrix-for-the-wilson-cowan-model">
       Coding Exercise 1.2: Compute the Jacobian Matrix for the Wilson-Cowan model
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-3-effect-of-wee-on-the-nullclines-and-the-eigenvalues">
     Section 1.3: Effect of
     <code class="docutils literal notranslate">
<span class="pre">
       wEE
      </span>
</code>
     on the nullclines and the eigenvalues
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-3-nullclines-position-in-the-phase-plane-changes-with-parameter-values">
       Interactive Demo 1.3: Nullclines position in the phase plane changes with parameter values
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-4-limit-cycle-oscillations">
     Section 1.4: Limit cycle - Oscillations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-4-limit-cycle-and-oscillations">
       Interactive Demo 1.4: Limit cycle and oscillations.
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-inhibition-stabilized-network-isn">
   Section 2: Inhibition-stabilized network (ISN)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-1-inhibition-stabilized-network">
     Section 2.1: Inhibition-stabilized network
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-1-compute-displaystyle-frac-partial-g-e-partial-r-e">
       Coding Exercise 2.1: Compute
       <span class="math notranslate nohighlight">
        \(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)
       </span>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-2-nullcline-analysis-of-the-isn">
     Section 2.2: Nullcline analysis of the ISN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-2-2-nullclines-of-example-isn-and-non-isn">
       Interactive Demo 2.2: Nullclines of Example
       <strong>
        ISN
       </strong>
       and
       <strong>
        non-ISN
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-fixed-point-and-working-memory">
   Section 3: Fixed point and working memory
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-short-pulse-induced-persistent-activity">
     Interactive Demo 3: Short pulse induced persistent activity
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/main/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/tutorials/W2D4_DynamicNetworks/instructor/W2D4_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="bonus-tutorial-extending-the-wilson-cowan-model">
<h1>Bonus Tutorial: Extending the Wilson-Cowan Model<a class="headerlink" href="#bonus-tutorial-extending-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 4: Dynamic Networks</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, Arvind Kumar, John Murray, Julijana Gjorgjieva</p>
<p><strong>Content reviewers:</strong> Maryam Vaziri-Pashkam, Ella Batty, Lorenzo Fontolan, Richard Gao, Spiros Chavlis, Michael Waskom</p>
<p><strong>Production editors:</strong> Siddharth Suresh</p>
<p><strong>Post-Production team:</strong> Gagana B, Spiros Chavlis</p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In the previous tutorial, you learned about the <strong>Wilson-Cowan</strong> rate model. Here we will dive into some deeper analyses of this model.</p>
<p>Bonus steps:</p>
<ul class="simple">
<li><p>Find and plot the <strong>fixed points</strong> of the Wilson-Cowan model.</p></li>
<li><p>Investigate the stability of the Wilson-Cowan model by linearizing its dynamics and examining the <strong>Jacobian matrix</strong>.</p></li>
<li><p>Learn how the Wilson-Cowan model can reach an oscillatory state.</p></li>
</ul>
<p>Applications of Wilson-Cowan model:</p>
<ul class="simple">
<li><p>Visualize the behavior of an Inhibition-stabilized network.</p></li>
<li><p>Simulate working memory using the Wilson-Cowan model.</p></li>
</ul>
<br/>
<p>Reference paper:</p>
<p>Wilson, H., and Cowan, J. (1972). Excitatory and inhibitory interactions in localized populations of model neurons. <em>Biophysical Journal</em> <strong>12</strong>. doi: <a class="reference external" href="https://doi.org/10.1016/S0006-3495(72)86068-5">10.1016/S0006-3495(72)86068-5</a></p>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>  <span class="c1"># root-finding algorithm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting Functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting Functions</span>

<span class="k">def</span> <span class="nf">plot_FI_inverse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
  <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"$F^{-1}(x)$"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_FI_EI</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_exc</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FI_inh</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'x (a.u.)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'F(x)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_test_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rE1</span><span class="p">,</span> <span class="n">rI1</span><span class="p">,</span> <span class="n">rE2</span><span class="p">,</span> <span class="n">rI2</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE1</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI1</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

  <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE2</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI2</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_vector</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">my_n_skip</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">myscale</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">n_skip</span> <span class="o">=</span> <span class="n">my_n_skip</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">myscale</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mycolor</span><span class="p">,</span> <span class="n">x_init</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for I along the E_grid from dE/dt = 0.</span>

<span class="sd">  Expects:</span>
<span class="sd">  pars    : Parameter dictionary</span>
<span class="sd">  dx      : increment of initial values</span>
<span class="sd">  n       : n*n trjectories</span>
<span class="sd">  mylabel : label for legend</span>

<span class="sd">  Returns:</span>
<span class="sd">    figure of trajectory</span>
<span class="sd">  """</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">ie</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ie</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ii</span>
      <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ie</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ii</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_complete_analysis</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.7</span><span class="p">,</span> <span class="mf">6.</span><span class="p">))</span>

  <span class="c1"># plot example trajectories</span>
  <span class="n">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
                       <span class="s1">'Sample trajectories </span><span class="se">\n</span><span class="s1">for different init. conditions'</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                     <span class="s1">'Sample trajectory for </span><span class="se">\n</span><span class="s1">low activity'</span><span class="p">)</span>
  <span class="n">my_plot_trajectory</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                     <span class="s1">'Sample trajectory for </span><span class="se">\n</span><span class="s1">high activity'</span><span class="p">)</span>

  <span class="c1"># plot nullclines</span>
  <span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># plot vector field</span>
  <span class="n">EI_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid</span><span class="p">,</span> <span class="n">EI_grid</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
             <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">],</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_fp</span><span class="p">(</span><span class="n">x_fp</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'ko'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
           <span class="sa">f</span><span class="s1">'Fixed Point1=</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)'</span><span class="p">,</span>
           <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">,</span>
           <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1"># Excitatory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>     <span class="c1"># Timescale of the E population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span>      <span class="c1"># Gain of the E population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.8</span>  <span class="c1"># Threshold of the E population</span>

  <span class="c1"># Inhibitory parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>    <span class="c1"># Timescale of the I population [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Gain of the I population</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="c1"># Threshold of the I population</span>

  <span class="c1"># Connection strength</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>   <span class="c1"># E to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span>   <span class="c1"># I to E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.</span>  <span class="c1"># E to I</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.</span>  <span class="c1"># I to I</span>

  <span class="c1"># External input</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

  <span class="c1"># simulation parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.</span>        <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>        <span class="c1"># Simulation time step [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of E</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Initial value of I</span>

  <span class="c1"># External parameters if any</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
      <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="c1"># Vector of discretized time points [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">])</span>

  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Population activation function, F-I curve</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    f     : the population activation response f(x) for input x</span>
<span class="sd">  """</span>

  <span class="c1"># add the expression of f = F(x)</span>
  <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">theta</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>

  <span class="k">return</span> <span class="n">f</span>


<span class="k">def</span> <span class="nf">dF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Derivative of the population activation function.</span>

<span class="sd">  Args:</span>
<span class="sd">    x     : the population input</span>
<span class="sd">    a     : the gain of the function</span>
<span class="sd">    theta : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    dFdx  :  Derivative of the population activation function.</span>
<span class="sd">  """</span>

  <span class="n">dFdx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)))</span><span class="o">**-</span><span class="mi">2</span>

  <span class="k">return</span> <span class="n">dFdx</span>

<span class="k">def</span> <span class="nf">F_inv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    x         : the population input</span>
<span class="sd">    a         : the gain of the function</span>
<span class="sd">    theta     : the threshold of the function</span>

<span class="sd">  Returns:</span>
<span class="sd">    F_inverse : value of the inverse function</span>
<span class="sd">  """</span>

  <span class="c1"># Calculate Finverse (ln(x) can be calculated as np.log(x))</span>
  <span class="n">F_inverse</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">theta</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta</span>

  <span class="k">return</span> <span class="n">F_inverse</span>


<span class="k">def</span> <span class="nf">get_E_nullcline</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for rI along the rE from drE/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rE    : response of excitatory population</span>
<span class="sd">    a_E, theta_E, wEE, wEI, I_ext_E : Wilson-Cowan excitatory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rI    : values of inhibitory population along the nullcline on the rE</span>
<span class="sd">  """</span>
  <span class="c1"># calculate rI for E nullclines on rI</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">wEI</span> <span class="o">*</span> <span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">)</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">rI</span>


<span class="k">def</span> <span class="nf">get_I_nullcline</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Solve for E along the rI from dI/dt = 0.</span>

<span class="sd">  Args:</span>
<span class="sd">    rI    : response of inhibitory population</span>
<span class="sd">    a_I, theta_I, wIE, wII, I_ext_I : Wilson-Cowan inhibitory parameters</span>
<span class="sd">    Other parameters are ignored</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE    : values of the excitatory population along the nullcline on the rI</span>
<span class="sd">  """</span>
  <span class="c1"># calculate rE for I nullclines on rI</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">wIE</span> <span class="o">*</span> <span class="p">(</span><span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">F_inv</span><span class="p">(</span><span class="n">rI</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">)</span> <span class="o">-</span> <span class="n">I_ext_I</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">rE</span>

<span class="k">def</span> <span class="nf">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span>
             <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
             <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
             <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Time derivatives for E/I variables (dE/dt, dI/dt)."""</span>

  <span class="c1"># Compute the derivative of rE</span>
  <span class="n">drEdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>

  <span class="c1"># Compute the derivative of rI</span>
  <span class="n">drIdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span>

<span class="k">def</span> <span class="nf">simulate_wc</span><span class="p">(</span><span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span>
                <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span>
                <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Simulate the Wilson-Cowan equations</span>

<span class="sd">  Args:</span>
<span class="sd">    Parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    rE, rI (arrays) : Activity of excitatory and inhibitory populations</span>
<span class="sd">  """</span>
  <span class="c1"># Initialize activity arrays</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rI_init</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">I_ext_E</span> <span class="o">=</span> <span class="n">I_ext_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">I_ext_I</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># Simulate the Wilson-Cowan equations</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Calculate the derivative of the E population</span>
    <span class="n">drE</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_E</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                                   <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span>

    <span class="c1"># Calculate the derivative of the I population</span>
    <span class="n">drI</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_I</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                                   <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span>

    <span class="c1"># Update using Euler's method</span>
    <span class="n">rE</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rE</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drE</span>
    <span class="n">rI</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">drI</span>

  <span class="k">return</span> <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span>
</pre></div>
</div>
</div>
</div>
<p>The helper functions included:</p>
<ul class="simple">
<li><p>Parameter dictionary: <code class="docutils literal notranslate"><span class="pre">default_pars(**kwargs)</span></code>. You can use:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code> to get all the parameters, and then you can execute <code class="docutils literal notranslate"><span class="pre">print(pars)</span></code> to check these parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars(T=T_sim,</span> <span class="pre">dt=time_step)</span></code> to set a different simulation time and time step</p></li>
<li><p>After <code class="docutils literal notranslate"><span class="pre">pars</span> <span class="pre">=</span> <span class="pre">default_pars()</span></code>, use <code class="docutils literal notranslate"><span class="pre">par['New_para']</span> <span class="pre">=</span> <span class="pre">value</span></code> to add a new parameter with its value</p></li>
<li><p>Pass to functions that accept individual parameters with <code class="docutils literal notranslate"><span class="pre">func(**pars)</span></code></p></li>
</ul>
</li>
<li><p>F-I curve: <code class="docutils literal notranslate"><span class="pre">F(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
<li><p>Derivative of the F-I curve: <code class="docutils literal notranslate"><span class="pre">dF(x,</span> <span class="pre">a,</span> <span class="pre">theta)</span></code></p></li>
<li><p>Inverse of F-I curve: <code class="docutils literal notranslate"><span class="pre">F_inv</span></code></p></li>
<li><p>Nullcline calculations: <code class="docutils literal notranslate"><span class="pre">get_E_nullcline</span></code>, <code class="docutils literal notranslate"><span class="pre">get_I_nullcline</span></code></p></li>
<li><p>Derivatives of E/I variables: <code class="docutils literal notranslate"><span class="pre">EIderivs</span></code></p></li>
<li><p>Simulate the Wilson-Cowan model: <code class="docutils literal notranslate"><span class="pre">simulate_wc</span></code></p></li>
</ul>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model">
<h1>Section 1: Fixed points, stability analysis, and limit cycles in the Wilson-Cowan model<a class="headerlink" href="#section-1-fixed-points-stability-analysis-and-limit-cycles-in-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h1>
<p><em>Correction to video: this is now the first part of the second bonus tutorial, not the last part of the second tutorial</em></p>
<div class="section" id="video-1-fixed-points-and-their-stability">
<h2>Video 1: Fixed points and their stability<a class="headerlink" href="#video-1-fixed-points-and-their-stability" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<p>As in Tutorial 2, we will be looking at the Wilson-Cowan model, with coupled equations representing the dynamics of the excitatory or inhibitory population:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d9559e00-d6a1-4e44-acd5-ec5582f27219">
<span class="eqno">(332)<a class="headerlink" href="#equation-d9559e00-d6a1-4e44-acd5-ec5582f27219" title="Permalink to this equation">¶</a></span>\[\begin{align}
\tau_E \frac{dr_E}{dt} &amp;= -r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E) \\
\tau_I \frac{dr_I}{dt} &amp;= -r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a_I,\theta_I) \qquad (1)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(r_E(t)\)</span> represents the average activation (or firing rate) of the excitatory population at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(r_I(t)\)</span> the activation (or firing rate) of the inhibitory population. The parameters <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> control the timescales of the dynamics of each population. Connection strengths are given by: <span class="math notranslate nohighlight">\(w_{EE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{EI}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> E), <span class="math notranslate nohighlight">\(w_{IE}\)</span> (E <span class="math notranslate nohighlight">\(\rightarrow\)</span> I), and <span class="math notranslate nohighlight">\(w_{II}\)</span> (I <span class="math notranslate nohighlight">\(\rightarrow\)</span> I). The terms <span class="math notranslate nohighlight">\(w_{EI}\)</span> and <span class="math notranslate nohighlight">\(w_{IE}\)</span> represent connections from inhibitory to excitatory population and vice versa, respectively. The transfer functions (or F-I curves) <span class="math notranslate nohighlight">\(F_E(x;a_E,\theta_E)\)</span> and <span class="math notranslate nohighlight">\(F_I(x;a_I,\theta_I)\)</span> can be different for the excitatory and the inhibitory populations.</p>
</div>
<div class="section" id="section-1-1-fixed-points-of-the-e-i-system">
<h2>Section 1.1: Fixed Points of the E/I system<a class="headerlink" href="#section-1-1-fixed-points-of-the-e-i-system" title="Permalink to this headline">¶</a></h2>
<p>The intersection points of the two nullcline curves are the fixed points of the Wilson-Cowan model in Equation <span class="math notranslate nohighlight">\((1)\)</span>.</p>
<p>In the next exercise, we will find the coordinate of all fixed points for a given set of parameters.</p>
<p>We’ll make use of two functions, similar to ones we saw in Tutorial 1, which use a root-finding algorithm to find the fixed points of the system with Excitatory and Inhibitory populations.</p>
<p>Execute to visualize nullclines</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute to visualize nullclines</span>

<span class="c1"># Set parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Compute nullclines</span>
<span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="n">plot_nullclines</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Execute the cell to define <code class="docutils literal notranslate"><span class="pre">my_fp</span></code> and <code class="docutils literal notranslate"><span class="pre">check_fp</span></code></em></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown *Execute the cell to define `my_fp` and `check_fp`*</span>

<span class="k">def</span> <span class="nf">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Use opt.root function to solve Equations (2)-(3) from initial values</span>
<span class="sd">  """</span>

  <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'a_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_E'</span><span class="p">]</span>
  <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_I'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'a_I'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'theta_I'</span><span class="p">]</span>
  <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span>
  <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span>
  <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">I_ext_I</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span>

  <span class="c1"># define the right hand of wilson-cowan equations</span>
  <span class="k">def</span> <span class="nf">my_WCr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>

    <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">drEdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rE</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>
    <span class="n">drIdt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rI</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">y</span>

  <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rE_init</span><span class="p">,</span> <span class="n">rI_init</span><span class="p">])</span>
  <span class="n">x_fp</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">my_WCr</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>

  <span class="k">return</span> <span class="n">x_fp</span>


<span class="k">def</span> <span class="nf">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp</span><span class="p">,</span> <span class="n">mytol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Verify (drE/dt)^2 + (drI/dt)^2&lt; mytol</span>

<span class="sd">  Args:</span>
<span class="sd">    pars    : Parameter dictionary</span>
<span class="sd">    fp      : value of fixed point</span>
<span class="sd">    mytol   : tolerance, default as 10^{-6}</span>

<span class="sd">  Returns :</span>
<span class="sd">    Whether it is a correct fixed point: True/False</span>
<span class="sd">  """</span>

  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">x_fp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">drEdt</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">drIdt</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">mytol</span>

<span class="n">help</span><span class="p">(</span><span class="n">my_fp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-1-1-find-the-fixed-points-of-the-wilson-cowan-model">
<h3>Coding Exercise 1.1: Find the fixed points of the Wilson-Cowan model<a class="headerlink" href="#coding-exercise-1-1-find-the-fixed-points-of-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>From the above nullclines, we notice that the system features  three fixed points with the parameters we used. To find their coordinates, we need to choose a proper initial value to give to the <code class="docutils literal notranslate"><span class="pre">opt.root</span></code> function inside of the function <code class="docutils literal notranslate"><span class="pre">my_fp</span></code> we just defined, since the algorithm can only find fixed points in the vicinity of the initial value.</p>
<p>In this exercise, you will use the function <code class="docutils literal notranslate"><span class="pre">my_fp</span></code> to find each of the fixed points by varying the initial values. Note that you can choose the values near the intersections of the nullclines as the initial values to calculate the fixed points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="c1">######################################################################</span>
<span class="c1"># TODO: Provide initial values to calculate the fixed points</span>
<span class="c1"># Check if x_fp's are the correct with the function check_fp(x_fp)</span>
<span class="c1"># Hint: vary different initial values to find the correct fixed points</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">'student exercise: find fixed points'</span><span class="p">)</span>
<span class="c1">######################################################################</span>

<span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

<span class="c1"># Find the first fixed point</span>
<span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_1</span><span class="p">):</span>
  <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">)</span>

<span class="c1"># Find the second fixed point</span>
<span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_2</span><span class="p">):</span>
  <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">)</span>

<span class="c1"># Find the third fixed point</span>
<span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_3</span><span class="p">):</span>
  <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># Find the first fixed point</span>
  <span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_1</span><span class="p">):</span>
    <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">)</span>

  <span class="c1"># Find the second fixed point</span>
  <span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_2</span><span class="p">):</span>
    <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">)</span>

  <span class="c1"># Find the third fixed point</span>
  <span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_3</span><span class="p">):</span>
    <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-2-stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix">
<h2>Section 1.2: Stability of a fixed point and eigenvalues of the Jacobian Matrix<a class="headerlink" href="#section-1-2-stability-of-a-fixed-point-and-eigenvalues-of-the-jacobian-matrix" title="Permalink to this headline">¶</a></h2>
<p>First, let’s first rewrite the system <span class="math notranslate nohighlight">\(1\)</span> as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b5c56aa0-652f-4c9e-bb13-43b62557f1c7">
<span class="eqno">(333)<a class="headerlink" href="#equation-b5c56aa0-652f-4c9e-bb13-43b62557f1c7" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{dr_E}{dt} &amp;= G_E(r_E,r_I) \\
\frac{dr_I}{dt} &amp;= G_I(r_E,r_I)
\end{align}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight" id="equation-6f6cd425-2f53-4896-9fbd-f41f3797e9b8">
<span class="eqno">(334)<a class="headerlink" href="#equation-6f6cd425-2f53-4896-9fbd-f41f3797e9b8" title="Permalink to this equation">¶</a></span>\[\begin{align}
G_E(r_E,r_I) &amp;= \frac{1}{\tau_E} [-r_E + F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a,\theta)] \\
G_I(r_E,r_I) &amp;= \frac{1}{\tau_I} [-r_I + F_I(w_{IE}r_E -w_{II}r_I + I^{\text{ext}}_I;a,\theta)]
\end{align}\]</div>
<p>By definition, <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_E}{dt}=0\)</span> and <span class="math notranslate nohighlight">\(\displaystyle\frac{dr_I}{dt}=0\)</span> at each fixed point. Therefore, if the initial state is exactly at the fixed point, the state of the system will not change as time evolves.</p>
<p>However, if the initial state deviates slightly from the fixed point, there are two possibilities
the trajectory will be attracted back to the</p>
<ol class="simple">
<li><p>The trajectory will be attracted back to the fixed point</p></li>
<li><p>The trajectory will diverge from the fixed point.</p></li>
</ol>
<p>These two possibilities define the type of fixed point, i.e., stable or unstable. Similar to the 1D system studied in the previous tutorial, the stability of a fixed point <span class="math notranslate nohighlight">\((r_E^*, r_I^*)\)</span> can be determined by linearizing the dynamics of the system (can you figure out how?). The linearization will yield a matrix of first-order derivatives called the Jacobian matrix:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f62d6aa2-6805-47b0-8a14-f735b29c1e4b">
<span class="eqno">(335)<a class="headerlink" href="#equation-f62d6aa2-6805-47b0-8a14-f735b29c1e4b" title="Permalink to this equation">¶</a></span>\[\begin{equation}
J=
\left[ {\begin{array}
  \displaystyle{\frac{\partial}{\partial r_E}}G_E(r_E^*, r_I^*) &amp; \displaystyle{\frac{\partial}{\partial r_I}}G_E(r_E^*, r_I^*)\\[1mm]
  \displaystyle\frac{\partial}{\partial r_E} G_I(r_E^*, r_I^*) &amp; \displaystyle\frac{\partial}{\partial r_I}G_I(r_E^*, r_I^*) \\
\end{array} } \right] \quad (7)
\end{equation}\]</div>
<br/>
<p>The eigenvalues of the Jacobian matrix calculated at the fixed point will determine whether it is a stable or unstable fixed point.</p>
<p>We can now compute the derivatives needed to build the Jacobian matrix. Using the chain and product rules the derivatives for the excitatory population are given by:</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-1b45673c-9710-4164-833d-842f256cdb23">
<span class="eqno">(336)<a class="headerlink" href="#equation-1b45673c-9710-4164-833d-842f256cdb23" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\partial}{\partial r_E} G_E(r_E^*, r_I^*) &amp;= \frac{1}{\tau_E} [-1 + w_{EE} F_E'(w_{EE}r_E^* -w_{EI}r_I^* +  I^{\text{ext}}_E;\alpha_E, \theta_E)] \\[1mm]
\frac{\partial}{\partial r_I} G_E(r_E^*, r_I^*) &amp;= \frac{1}{\tau_E} [-w_{EI} F_E'(w_{EE}r_E^* -w_{EI}r_I^* +  I^{\text{ext}}_E;\alpha_E, \theta_E)]
\end{align}\]</div>
<br/>
<p>The same applies to the inhibitory population.</p>
<div class="section" id="coding-exercise-1-2-compute-the-jacobian-matrix-for-the-wilson-cowan-model">
<h3>Coding Exercise 1.2: Compute the Jacobian Matrix for the Wilson-Cowan model<a class="headerlink" href="#coding-exercise-1-2-compute-the-jacobian-matrix-for-the-wilson-cowan-model" title="Permalink to this headline">¶</a></h3>
<p>Here, you can use <code class="docutils literal notranslate"><span class="pre">dF(x,a,theta)</span></code> defined in the <code class="docutils literal notranslate"><span class="pre">Helper</span> <span class="pre">functions</span></code> to calculate the derivative of the F-I curve.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">get_eig_Jacobian</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span>
                     <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
                     <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Compute eigenvalues of the Wilson-Cowan Jacobian matrix at fixed point."""</span>
  <span class="c1"># Initialization</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>
  <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

  <span class="c1">###########################################################################</span>
  <span class="c1"># TODO for students: compute J and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the Jacobian matrix"</span><span class="p">)</span>
  <span class="c1">###########################################################################</span>
  <span class="c1"># Compute the four elements of the Jacobian matrix</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Compute and return the eigenvalues</span>
  <span class="n">evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">J</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">evals</span>


<span class="c1"># Compute eigenvalues of Jacobian</span>
<span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">eig_2</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">eig_3</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eig_1</span><span class="p">,</span> <span class="s1">'Stable point'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eig_2</span><span class="p">,</span> <span class="s1">'Unstable point'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eig_3</span><span class="p">,</span> <span class="s1">'Stable point'</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">get_eig_Jacobian</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span>
                     <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span>
                     <span class="n">tau_I</span><span class="p">,</span> <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">,</span> <span class="n">wIE</span><span class="p">,</span> <span class="n">wII</span><span class="p">,</span> <span class="n">I_ext_I</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Compute eigenvalues of the Wilson-Cowan Jacobian matrix at fixed point."""</span>
  <span class="c1"># Initialization</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>
  <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

  <span class="c1"># Compute the four elements of the Jacobian matrix</span>
  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">wEE</span> <span class="o">*</span> <span class="n">dF</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span>
                           <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>

  <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">wEI</span> <span class="o">*</span> <span class="n">dF</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span>
                       <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>

  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">dF</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span>
                      <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>

  <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">dF</span><span class="p">(</span><span class="n">wIE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wII</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_I</span><span class="p">,</span>
                           <span class="n">a_I</span><span class="p">,</span> <span class="n">theta_I</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_I</span>

  <span class="c1"># Compute and return the eigenvalues</span>
  <span class="n">evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">J</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">evals</span>


<span class="c1"># Compute eigenvalues of Jacobian</span>
<span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">eig_2</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">eig_3</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eig_1</span><span class="p">,</span> <span class="s1">'Stable point'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eig_2</span><span class="p">,</span> <span class="s1">'Unstable point'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eig_3</span><span class="p">,</span> <span class="s1">'Stable point'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As is evident, the stable fixed points correspond to the negative eigenvalues, while unstable points correspond to at least one positive eigenvalue.</p>
<p>The sign of the eigenvalues is determined by the connectivity (interaction) between excitatory and inhibitory populations.</p>
<p>Below we investigate the effect of <span class="math notranslate nohighlight">\(w_{EE}\)</span> on the nullclines and the eigenvalues of the dynamical system.</p>
<p>* <em>Critical change is referred to as <strong>pitchfork bifurcation</strong></em>.</p>
</div>
</div>
<div class="section" id="section-1-3-effect-of-wee-on-the-nullclines-and-the-eigenvalues">
<h2>Section 1.3: Effect of <code class="docutils literal notranslate"><span class="pre">wEE</span></code> on the nullclines and the eigenvalues<a class="headerlink" href="#section-1-3-effect-of-wee-on-the-nullclines-and-the-eigenvalues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="interactive-demo-1-3-nullclines-position-in-the-phase-plane-changes-with-parameter-values">
<h3>Interactive Demo 1.3: Nullclines position in the phase plane changes with parameter values<a class="headerlink" href="#interactive-demo-1-3-nullclines-position-in-the-phase-plane-changes-with-parameter-values" title="Permalink to this headline">¶</a></h3>
<p>How do the nullclines move for different values of the parameter <span class="math notranslate nohighlight">\(w_{EE}\)</span>? What does this mean for fixed points and system activity?</p>
<div class="section" id="id1">
<h4><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">plot_nullcline_diffwEE</span><span class="p">(</span><span class="n">wEE</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">    plot nullclines for different values of wEE</span>
<span class="sd">  """</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">wEE</span><span class="o">=</span><span class="n">wEE</span><span class="p">)</span>

  <span class="c1"># plot the E, I nullclines</span>
  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">.96</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'E/I activity</span><span class="se">\n</span><span class="s1">for different initial conditions'</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">plot_nullcline_diffwEE</span><span class="p">,</span> <span class="n">wEE</span><span class="o">=</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>

<span class="sd">- For low values of wEE there is only one fixed point and it is stable so initial</span>
<span class="sd">conditions do not matter and the system always converge to the only fixed point</span>

<span class="sd">- For high values of wEE we have three fixed points of which two are stable and</span>
<span class="sd">one is unstable (or saddle). Now it matters where the initial conditions are. If</span>
<span class="sd">the initial conditions are in the attractor region os the high activity fixed</span>
<span class="sd">point then the system will converge to that (the bottom example).</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>We can also investigate the effect of different <span class="math notranslate nohighlight">\(w_{EI}\)</span>, <span class="math notranslate nohighlight">\(w_{IE}\)</span>, <span class="math notranslate nohighlight">\(w_{II}\)</span>, <span class="math notranslate nohighlight">\(\tau_{E}\)</span>, <span class="math notranslate nohighlight">\(\tau_{I}\)</span>, and <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}\)</span> on the stability of fixed points. In addition, we can also consider the perturbation of the parameters of the gain curve <span class="math notranslate nohighlight">\(F(\cdot)\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="section-1-4-limit-cycle-oscillations">
<h2>Section 1.4: Limit cycle - Oscillations<a class="headerlink" href="#section-1-4-limit-cycle-oscillations" title="Permalink to this headline">¶</a></h2>
<p>For some values of interaction terms (<span class="math notranslate nohighlight">\(w_{EE}, w_{IE}, w_{EI}, w_{II}\)</span>), the eigenvalues can become complex. When at least one pair of eigenvalues is complex, oscillations arise.
The stability of oscillations is determined by the real part of the eigenvalues (+ve real part oscillations will grow, -ve real part oscillations will die out). The size of the complex part determines the frequency of oscillations.</p>
<p>For instance, if we use a different set of parameters, <span class="math notranslate nohighlight">\(w_{EE}=6.4\)</span>, <span class="math notranslate nohighlight">\(w_{EI}=4.8\)</span>, <span class="math notranslate nohighlight">\(w_{IE}=6.\)</span>, <span class="math notranslate nohighlight">\(w_{II}=1.2\)</span>, and <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}=0.8\)</span>, then we shall observe that the E and I population activity start to oscillate! Please execute the cell below to check the oscillatory behavior.</p>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Make sure you execute this cell to see the oscillations!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to see the oscillations!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span>

<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can also understand the oscillations of the population behavior using the phase plane. By plotting a set of trajectories with different initial states, we can see that these trajectories will move in a circle instead of converging to a fixed point. This circle is called “limit cycle” and shows the periodic oscillations of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> population behavior under some conditions.</p>
<p>Let’s plot the phase plane using the previously defined functions.</p>
<p>Execute to visualize phase plane</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute to visualize phase plane</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">my_plot_nullcline</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

<span class="c1"># Find the correct fixed point</span>
<span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="k">if</span> <span class="n">check_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x_fp_1</span><span class="p">):</span>
  <span class="n">plot_fp</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="n">my_plot_trajectories</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="s1">'Sample trajectories </span><span class="se">\n</span><span class="s1">with different initial values'</span><span class="p">)</span>

<span class="n">my_plot_vector</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.01</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-1-4-limit-cycle-and-oscillations">
<h3>Interactive Demo 1.4: Limit cycle and oscillations.<a class="headerlink" href="#interactive-demo-1-4-limit-cycle-and-oscillations" title="Permalink to this headline">¶</a></h3>
<p>From the above examples, the change of model parameters changes the shape of the nullclines and, accordingly, the behavior of the <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(I\)</span> populations from steady fixed points to oscillations. However, the shape of the nullclines is unable to fully determine the behavior of the network. The vector field also matters. To demonstrate this, here, we will investigate the effect of time constants on the population behavior. By changing the inhibitory time constant <span class="math notranslate nohighlight">\(\tau_I\)</span>, the nullclines do not change, but the network behavior changes substantially from steady state to oscillations with different frequencies.</p>
<p>Such a dramatic change in the system behavior is referred to as a <strong>bifurcation</strong>.</p>
<p>\
Please execute the code below to check this out.</p>
<div class="section" id="id3">
<h4><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">time_constant_effect</span><span class="p">(</span><span class="n">tau_i</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_I'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau_i</span>

  <span class="n">Exc_null_rE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  <span class="n">Inh_null_rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

  <span class="n">Exc_null_rI</span> <span class="o">=</span> <span class="n">get_E_nullcline</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">Inh_null_rE</span> <span class="o">=</span> <span class="n">get_I_nullcline</span><span class="p">(</span><span class="n">Inh_null_rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># nullclines</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Exc_null_rE</span><span class="p">,</span> <span class="n">Exc_null_rI</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E nullcline'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Inh_null_rE</span><span class="p">,</span> <span class="n">Inh_null_rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I nullcline'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>

  <span class="c1"># fixed point</span>
  <span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_fp_1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'ko'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

  <span class="n">eig_1</span> <span class="o">=</span> <span class="n">get_eig_Jacobian</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="c1"># trajectories</span>
  <span class="k">for</span> <span class="n">ie</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ie</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ii</span>
      <span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rE_tj</span><span class="p">,</span> <span class="n">rI_tj</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="c1"># vector field</span>
  <span class="n">EI_grid_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">EI_grid_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">EI_grid_E</span><span class="p">,</span> <span class="n">EI_grid_I</span><span class="p">)</span>
  <span class="n">drEdt</span><span class="p">,</span> <span class="n">drIdt</span> <span class="o">=</span> <span class="n">EIderivs</span><span class="p">(</span><span class="n">rE</span><span class="p">,</span> <span class="n">rI</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">rE</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">rI</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
              <span class="n">drEdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span> <span class="n">drIdt</span><span class="p">[::</span><span class="n">n_skip</span><span class="p">,</span> <span class="p">::</span><span class="n">n_skip</span><span class="p">],</span>
              <span class="n">angles</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\tau_I=$'</span><span class="o">+</span><span class="s1">'</span><span class="si">%.1f</span><span class="s1"> ms'</span> <span class="o">%</span> <span class="n">tau_i</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># sample E/I trajectories</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\tau_I=$'</span><span class="o">+</span><span class="s1">'</span><span class="si">%.1f</span><span class="s1"> ms'</span> <span class="o">%</span> <span class="n">tau_i</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">time_constant_effect</span><span class="p">,</span> <span class="n">tau_i</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Both <span class="math notranslate nohighlight">\(\tau_E\)</span> and <span class="math notranslate nohighlight">\(\tau_I\)</span> feature in the Jacobian of the two population network (eq 7). So here is seems that the by increasing <span class="math notranslate nohighlight">\(\tau_I\)</span> the eigenvalues corresponding to the stable fixed point are becoming complex.</p>
<p>Intuitively, when <span class="math notranslate nohighlight">\(\tau_I\)</span> is smaller, inhibitory activity changes faster than excitatory activity. As inhibition exceeds above a certain value, high inhibition inhibits excitatory population but that in turns means that inhibitory population gets smaller input (from the exc. connection). So inhibition decreases rapidly. But this means that excitation recovers – and so on …</p>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-inhibition-stabilized-network-isn">
<h1>Section 2: Inhibition-stabilized network (ISN)<a class="headerlink" href="#section-2-inhibition-stabilized-network-isn" title="Permalink to this headline">¶</a></h1>
<div class="section" id="section-2-1-inhibition-stabilized-network">
<h2>Section 2.1: Inhibition-stabilized network<a class="headerlink" href="#section-2-1-inhibition-stabilized-network" title="Permalink to this headline">¶</a></h2>
<p>As described above, one can obtain the linear approximation around the fixed point as</p>
<div class="amsmath math notranslate nohighlight" id="equation-b9283ecb-3ab7-4fa0-830d-7791459d4e8f">
<span class="eqno">(337)<a class="headerlink" href="#equation-b9283ecb-3ab7-4fa0-830d-7791459d4e8f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{d}{dr} \vec{R} =
\left[ {\begin{array}
\displaystyle{\frac{\partial G_E}{\partial r_E}} &amp; \displaystyle{\frac{\partial G_E}{\partial r_I}} \\
\displaystyle\frac{\partial G_I}{\partial r_E} &amp; \displaystyle\frac{\partial G_I}{\partial r_I} \\
\end{array} } \right] \vec{R},
\end{equation}\]</div>
<br/>
<p>where <span class="math notranslate nohighlight">\(\vec{R} = [r_E, r_I]^{\rm T}\)</span> is the vector of the E/I activity.</p>
<p>Let’s direct our attention to the excitatory subpopulation which follows:</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-d36144b1-78e4-46da-9dca-1a497d45a8d9">
<span class="eqno">(338)<a class="headerlink" href="#equation-d36144b1-78e4-46da-9dca-1a497d45a8d9" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{dr_E}{dt} = \frac{\partial G_E}{\partial r_E}\cdot r_E + \frac{\partial G_E}{\partial r_I} \cdot r_I
\end{equation}\]</div>
<br/>
<p>Recall that, around fixed point <span class="math notranslate nohighlight">\((r_E^*, r_I^*)\)</span>:</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-2eb2624d-144e-4342-aaa0-a72e2cee649e">
<span class="eqno">(339)<a class="headerlink" href="#equation-2eb2624d-144e-4342-aaa0-a72e2cee649e" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*) &amp;= \frac{1}{\tau_E} [-1 + w_{EE} F'_{E}(w_{EE}r_E^* -w_{EI}r_I^* + I^{\text{ext}}_E; \alpha_E, \theta_E)] &amp;\qquad (8) \\
\frac{\partial}{\partial r_I}G_E(r_E^*, r_I^*) &amp;= \frac{1}{\tau_E} [-w_{EI} F'_{E}(w_{EE}r_E^* -w_{EI}r_I^* + I^{\text{ext}}_E; \alpha_E, \theta_E)] &amp;\qquad (9)\\
\frac{\partial}{\partial r_E}G_I(r_E^*, r_I^*) &amp;= \frac{1}{\tau_I} [w_{IE} F'_{I}(w_{IE}r_E^* -w_{II}r_I^* + I^{\text{ext}}_I; \alpha_I, \theta_I)] &amp;\qquad (10) \\
\frac{\partial}{\partial r_I}G_I(r_E^*, r_I^*) &amp;= \frac{1}{\tau_I} [-1-w_{II} F'_{I}(w_{IE}r_E^* -w_{II}r_I^* + I^{\text{ext}}_I; \alpha_I, \theta_I)] &amp;\qquad (11)
\end{align}\]</div>
<br/>
<p>From Equation. (8), it is clear that <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_I}}\)</span> is negative since the <span class="math notranslate nohighlight">\(\displaystyle{\frac{dF}{dx}}\)</span> is always positive. It can be understood by that the recurrent inhibition from the inhibitory activity (<span class="math notranslate nohighlight">\(I\)</span>) can reduce the excitatory (<span class="math notranslate nohighlight">\(E\)</span>) activity. However, as described above, <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span> has negative terms related to the “leak” effect, and positive terms related to the recurrent excitation. Therefore, it leads to two different regimes:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*)}&lt;0\)</span>, <strong>noninhibition-stabilized
network (non-ISN) regime</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial}{\partial r_E}G_E(r_E^*, r_I^*)}&gt;0\)</span>, <strong>inhibition-stabilized
network (ISN) regime</strong></p></li>
</ul>
<div class="section" id="coding-exercise-2-1-compute-displaystyle-frac-partial-g-e-partial-r-e">
<h3>Coding Exercise 2.1: Compute <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span><a class="headerlink" href="#coding-exercise-2-1-compute-displaystyle-frac-partial-g-e-partial-r-e" title="Permalink to this headline">¶</a></h3>
<p>Implement the function to calculate the <span class="math notranslate nohighlight">\(\displaystyle{\frac{\partial G_E}{\partial r_E}}\)</span> for the default parameters, and the parameters of the limit cycle case.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">get_dGdE</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Compute dGdE</span>

<span class="sd">  Args:</span>
<span class="sd">    fp   : fixed point (E, I), array</span>
<span class="sd">    Other arguments are parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    J    : the 2x2 Jacobian matrix</span>
<span class="sd">  """</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>

  <span class="c1">##########################################################################</span>
  <span class="c1"># TODO for students: compute dGdrE and disable the error</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the dG/dE, Eq. (13)"</span><span class="p">)</span>
  <span class="c1">##########################################################################</span>
  <span class="c1"># Calculate the J[0,0]</span>
  <span class="n">dGdrE</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">dGdrE</span>


<span class="c1"># Get fixed points</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Compute dGdE</span>
<span class="n">dGdrE1</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">dGdrE2</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">dGdrE3</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'For the default case:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp1) = </span><span class="si">{</span><span class="n">dGdrE1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp2) = </span><span class="si">{</span><span class="n">dGdrE2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp3) = </span><span class="si">{</span><span class="n">dGdrE3</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">wEE</span><span class="o">=</span><span class="mf">6.4</span><span class="p">,</span> <span class="n">wEI</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span> <span class="n">wIE</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">wII</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">x_fp_lc</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">dGdrE_lc</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_lc</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'For the limit cycle case:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp_lc) = </span><span class="si">{</span><span class="n">dGdrE_lc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">get_dGdE</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">tau_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">,</span> <span class="n">wEE</span><span class="p">,</span> <span class="n">wEI</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="o">**</span><span class="n">other_pars</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Compute dGdE</span>

<span class="sd">  Args:</span>
<span class="sd">    fp   : fixed point (E, I), array</span>
<span class="sd">    Other arguments are parameters of the Wilson-Cowan model</span>

<span class="sd">  Returns:</span>
<span class="sd">    J    : the 2x2 Jacobian matrix</span>
<span class="sd">  """</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">fp</span>

  <span class="c1"># Calculate the J[0,0]</span>
  <span class="n">dGdrE</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">wEE</span> <span class="o">*</span> <span class="n">dF</span><span class="p">(</span><span class="n">wEE</span> <span class="o">*</span> <span class="n">rE</span> <span class="o">-</span> <span class="n">wEI</span> <span class="o">*</span> <span class="n">rI</span> <span class="o">+</span> <span class="n">I_ext_E</span><span class="p">,</span> <span class="n">a_E</span><span class="p">,</span> <span class="n">theta_E</span><span class="p">))</span> <span class="o">/</span> <span class="n">tau_E</span>

  <span class="k">return</span> <span class="n">dGdrE</span>


<span class="c1"># Get fixed points</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">()</span>
<span class="n">x_fp_1</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">x_fp_2</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">x_fp_3</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Compute dGdE</span>
<span class="n">dGdrE1</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_1</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">dGdrE2</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_2</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">dGdrE3</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_3</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'For the default case:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp1) = </span><span class="si">{</span><span class="n">dGdrE1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp2) = </span><span class="si">{</span><span class="n">dGdrE2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp3) = </span><span class="si">{</span><span class="n">dGdrE3</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">wEE</span><span class="o">=</span><span class="mf">6.4</span><span class="p">,</span> <span class="n">wEI</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span> <span class="n">wIE</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">wII</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">I_ext_E</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">x_fp_lc</span> <span class="o">=</span> <span class="n">my_fp</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">dGdrE_lc</span> <span class="o">=</span> <span class="n">get_dGdE</span><span class="p">(</span><span class="n">x_fp_lc</span><span class="p">,</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'For the limit cycle case:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'dG/drE(fp_lc) = </span><span class="si">{</span><span class="n">dGdrE_lc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>SAMPLE OUTPUT</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">the</span> <span class="n">default</span> <span class="n">case</span><span class="p">:</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.650</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.519</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.706</span>


<span class="n">For</span> <span class="n">the</span> <span class="n">limit</span> <span class="n">cycle</span> <span class="n">case</span><span class="p">:</span>
<span class="n">dG</span><span class="o">/</span><span class="n">drE</span><span class="p">(</span><span class="n">fp_lc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.837</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="section-2-2-nullcline-analysis-of-the-isn">
<h2>Section 2.2: Nullcline analysis of the ISN<a class="headerlink" href="#section-2-2-nullcline-analysis-of-the-isn" title="Permalink to this headline">¶</a></h2>
<p>Recall that the E nullcline follows</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-d916bbf2-386a-468d-ba47-2eb58276e1a8">
<span class="eqno">(340)<a class="headerlink" href="#equation-d916bbf2-386a-468d-ba47-2eb58276e1a8" title="Permalink to this equation">¶</a></span>\[\begin{equation}
r_E = F_E(w_{EE}r_E -w_{EI}r_I + I^{\text{ext}}_E;a_E,\theta_E). 
\end{equation}\]</div>
<br/>
<p>That is, the firing rate <span class="math notranslate nohighlight">\(r_E\)</span> can be a function of <span class="math notranslate nohighlight">\(r_I\)</span>. Let’s take the derivative of <span class="math notranslate nohighlight">\(r_E\)</span> over <span class="math notranslate nohighlight">\(r_I\)</span>, and obtain</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-78fa9e98-6665-4114-a5bc-44f7cd7a0b53">
<span class="eqno">(341)<a class="headerlink" href="#equation-78fa9e98-6665-4114-a5bc-44f7cd7a0b53" title="Permalink to this equation">¶</a></span>\[\begin{align}
&amp;\frac{dr_E}{dr_I} = F_E' \cdot (w_{EE}\frac{dr_E}{dr_I} -w_{EI}) \iff \\
&amp;(1-F_E'w_{EE})\frac{dr_E}{dr_I} = -F_E' w_{EI} \iff \\
&amp;\frac{dr_E}{dr_I} = \frac{F_E' w_{EI}}{F_E'w_{EE}-1}.
\end{align}\]</div>
<br/>
<p>That is, in the phase plane <code class="docutils literal notranslate"><span class="pre">rI-rE</span></code>-plane, we can obtain the slope along the E nullcline as</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-d290e3b2-b4a9-4877-bba0-b7ad9d408133">
<span class="eqno">(342)<a class="headerlink" href="#equation-d290e3b2-b4a9-4877-bba0-b7ad9d408133" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{dr_I}{dr_E} = \frac{F_E'w_{EE}-1}{F_E' w_{EI}} \qquad (12)
\end{equation}\]</div>
<br/>
<p>Similarly, we can obtain the slope along the I nullcline as</p>
<div class="amsmath math notranslate nohighlight" id="equation-eb011841-f7f7-45c9-abd6-95c64d4a357a">
<span class="eqno">(343)<a class="headerlink" href="#equation-eb011841-f7f7-45c9-abd6-95c64d4a357a" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{dr_I}{dr_E} = \frac{F_I'w_{IE}}{F_I' w_{II}+1} \qquad (13)
\end{equation}\]</div>
<br/>
<p>Then, we can find that <span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm I-nullcline} &gt;0\)</span> in Equation (13).</p>
<br/>
<p>However, in Equation (12), the sign of <span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}\)</span> depends on the sign of <span class="math notranslate nohighlight">\((F_E'w_{EE}-1)\)</span>. Note that, <span class="math notranslate nohighlight">\((F_E'w_{EE}-1)\)</span> is the same as what we show above (Equation (8)). Therefore, we can have the following results:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}&lt;0\)</span>, <strong>noninhibition-stabilized
network (non-ISN) regime</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}&gt;0\)</span>, <strong>inhibition-stabilized
network (ISN) regime</strong></p></li>
</ul>
<br/>
<p>In addition, it is important to point out the following two conclusions:</p>
<p><strong>Conclusion 1:</strong> The stability of a fixed point can determine the relationship between the slopes Equations (12) and (13). As discussed above, the fixed point is stable when the Jacobian matrix (<span class="math notranslate nohighlight">\(J\)</span> in Equation (7)) has two eigenvalues with a negative real part, which indicates a positive determinant of <span class="math notranslate nohighlight">\(J\)</span>, i.e., <span class="math notranslate nohighlight">\(\text{det}(J)&gt;0\)</span>.</p>
<p>From the Jacobian matrix definition and from Equations (8-11), we can obtain:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9b10ec49-b7ac-4fa2-b117-f713875c07ca">
<span class="eqno">(344)<a class="headerlink" href="#equation-9b10ec49-b7ac-4fa2-b117-f713875c07ca" title="Permalink to this equation">¶</a></span>\[\begin{equation}
J =
\left[ {\begin{array}
\displaystyle{\frac{1}{\tau_E}(w_{EE}F_E'-1)} &amp; \displaystyle{-\frac{1}{\tau_E}w_{EI}F_E'}\\[1mm]
\displaystyle {\frac{1}{\tau_I}w_{IE}F_I'}&amp; \displaystyle {\frac{1}{\tau_I}(-w_{II}F_I'-1)} \\
\end{array} } \right]
\end{equation}\]</div>
<br/>
<p>Note that, if we let</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-4da9203a-84ff-4ec1-85c4-2364b5358e79">
<span class="eqno">(345)<a class="headerlink" href="#equation-4da9203a-84ff-4ec1-85c4-2364b5358e79" title="Permalink to this equation">¶</a></span>\[\begin{equation}
  T=
  \left[
  { 
    \begin{matrix}
      \displaystyle{\tau_E} &amp; \displaystyle{0} \\
      \displaystyle 0&amp; \displaystyle \tau_I
  \end{matrix}
  } \right], 
  F=
  \left[
  {
    \begin{matrix}
      \displaystyle{F_E'} &amp; \displaystyle{0} \\
      \displaystyle 0&amp; \displaystyle F_I'
    \end{matrix}
  }
  \right]
  \text{, and }
  W=
  \left[
  {
    \begin{matrix}
      \displaystyle{w_{EE}} &amp; \displaystyle{-w_{EI}} \\
      \displaystyle w_{IE}&amp; \displaystyle -w_{II}
    \end{matrix}
  }
  \right]
\end{equation}\]</div>
<p>then, using matrix notation, <span class="math notranslate nohighlight">\(J=T^{-1}(F W - I)\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix, i.e., <span class="math notranslate nohighlight">\(I = \begin{bmatrix} 
1 &amp; 0 \\
0 &amp; 1 
\end{bmatrix}.\)</span></p>
<br/>
<p>Therefore, <span class="math notranslate nohighlight">\(\det{(J)}=\det{(T^{-1}(F W - I))}=(\det{(T^{-1})})(\det{(F W - I)}).\)</span></p>
<p>Since <span class="math notranslate nohighlight">\(\det{(T^{-1})}&gt;0\)</span>, as time constants are positive by definition, the sign of <span class="math notranslate nohighlight">\(\det{(J)}\)</span> is the same as the sign of <span class="math notranslate nohighlight">\(\det{(F W - I)}\)</span>, and so</p>
<div class="math notranslate nohighlight">
\[\det{(FW - I)} = (F_E' w_{EI})(F_I'w_{IE}) - (F_I' w_{II} + 1)(F_E'w_{EE} - 1) &gt; 0.\]</div>
<br/>
<p>Then, combining this with Equations (12) and (13), we can obtain</p>
<div class="amsmath math notranslate nohighlight" id="equation-2e599999-4ca0-4f3d-9c1a-589f694294a9">
<span class="eqno">(346)<a class="headerlink" href="#equation-2e599999-4ca0-4f3d-9c1a-589f694294a9" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm I-nullcline}}{\Big{(} \displaystyle{\frac{dr_I}{dr_E}} \Big{)}_{\rm E-nullcline}} &gt; 1.
\end{equation}\]</div>
<p>Therefore, at the stable fixed point, I nullcline has a steeper slope than the E nullcline.</p>
<br/>
<p><strong>Conclusion 2:</strong> Effect of adding input to the inhibitory population.</p>
<p>While adding the input <span class="math notranslate nohighlight">\(\delta I^{\rm ext}_I\)</span> into the inhibitory population, we can find that the E nullcline (Equation (5)) stays the same, while the I nullcline has a pure left shift: the original I nullcline equation,</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-d44f5c00-6d78-4f3a-9071-9b83855f2412">
<span class="eqno">(347)<a class="headerlink" href="#equation-d44f5c00-6d78-4f3a-9071-9b83855f2412" title="Permalink to this equation">¶</a></span>\[\begin{equation}
r_I = F_I(w_{IE}r_E-w_{II}r_I + I^{\text{ext}}_I ; \alpha_I, \theta_I)
\end{equation}\]</div>
<br/>
<p>remains true if we take <span class="math notranslate nohighlight">\(I^{\text{ext}}_I \rightarrow I^{\text{ext}}_I +\delta I^{\rm ext}_I\)</span> and <span class="math notranslate nohighlight">\(r_E\rightarrow r_E'=r_E-\frac{\delta I^{\rm ext}_I}{w_{IE}}\)</span> to obtain</p>
<br/>
<div class="amsmath math notranslate nohighlight" id="equation-08494c8e-50e4-44d9-99b7-f01734584bac">
<span class="eqno">(348)<a class="headerlink" href="#equation-08494c8e-50e4-44d9-99b7-f01734584bac" title="Permalink to this equation">¶</a></span>\[\begin{equation}
r_I = F_I(w_{IE}r_E'-w_{II}r_I + I^{\text{ext}}_I +\delta I^{\rm ext}_I; \alpha_I, \theta_I)
\end{equation}\]</div>
<br/>
<p>Putting these points together, we obtain the phase plane pictures shown below. After adding input to the inhibitory population, it can be seen in the trajectories above and the phase plane below that, in an <strong>ISN</strong>, <span class="math notranslate nohighlight">\(r_I\)</span> will increase first but then decay to the new fixed point in which both <span class="math notranslate nohighlight">\(r_I\)</span> and <span class="math notranslate nohighlight">\(r_E\)</span> are decreased compared to the original fixed point. However, by adding <span class="math notranslate nohighlight">\(\delta I^{\rm ext}_I\)</span> into a <strong>non-ISN</strong>, <span class="math notranslate nohighlight">\(r_I\)</span> will increase while <span class="math notranslate nohighlight">\(r_E\)</span> will decrease.</p>
<div class="section" id="interactive-demo-2-2-nullclines-of-example-isn-and-non-isn">
<h3>Interactive Demo 2.2: Nullclines of Example <strong>ISN</strong> and <strong>non-ISN</strong><a class="headerlink" href="#interactive-demo-2-2-nullclines-of-example-isn-and-non-isn" title="Permalink to this headline">¶</a></h3>
<p>In this interactive widget, we inject excitatory (<span class="math notranslate nohighlight">\(I^{\text{ext}}_I&gt;0\)</span>) or inhibitory (<span class="math notranslate nohighlight">\(I^{\text{ext}}_I&lt;0\)</span>) drive into the inhibitory population when the system is at its equilibrium (with parameters <span class="math notranslate nohighlight">\(w_{EE}=6.4\)</span>, <span class="math notranslate nohighlight">\(w_{EI}=4.8\)</span>, <span class="math notranslate nohighlight">\(w_{IE}=6.\)</span>, <span class="math notranslate nohighlight">\(w_{II}=1.2\)</span>, <span class="math notranslate nohighlight">\(I_{E}^{\text{ext}}=0.8\)</span>, <span class="math notranslate nohighlight">\(\tau_I = 0.8\)</span>, and <span class="math notranslate nohighlight">\(I^{\text{ext}}_I=0\)</span>). How does the firing rate of the <span class="math notranslate nohighlight">\(I\)</span> population changes with excitatory vs inhibitory drive into the inhibitory population?</p>
<div class="section" id="id4">
<h4><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wEE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wEI'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'wIE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'wII'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.2</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'tau_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="k">def</span> <span class="nf">ISN_I_perturb</span><span class="p">(</span><span class="n">dI</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">])</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="n">dI</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.26</span>
  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$I_I^{\mathrm</span><span class="si">{ext}</span><span class="s1">}$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_E$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">),</span> <span class="s1">'b--'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$r_I$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Lt</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">),</span> <span class="s1">'r--'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">ISN_I_perturb</span><span class="p">,</span> <span class="n">dI</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Discussion:</span>

<span class="sd">Here we observe a paradoxical effect; if we inject excitatory current to the I</span>
<span class="sd">population, the r_I goes down, whereas when we inject inhibitory current, the r_I</span>
<span class="sd">increases. Recall that we inject a constant excitatory current to the E population,</span>
<span class="sd">which also drives, indirectly, the I population. When Iext&gt;0, the r_I increases</span>
<span class="sd">but this drives E to a low state, which in turn leads to rI decrease. Whereas,</span>
<span class="sd">when Iext&lt;0, the effect is negative on I population for a short amount of time,</span>
<span class="sd">which is sufficient to drive the E population to a high steady state, and then due</span>
<span class="sd">to E to I connections, the I population activity is increased.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-fixed-point-and-working-memory">
<h1>Section 3: Fixed point and working memory<a class="headerlink" href="#section-3-fixed-point-and-working-memory" title="Permalink to this headline">¶</a></h1>
<p>The input into the neurons measured in the experiment is often very noisy (<a class="reference external" href="http://www.scholarpedia.org/article/Stochastic_dynamical_systems">links</a>). Here, the noisy synaptic input current is modeled as an Ornstein-Uhlenbeck (OU)process, which has been discussed several times in the previous tutorials.</p>
<p>Make sure you execute this cell to enable the function my_OU and plot the input current!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Make sure you execute this cell to enable the function my_OU and plot the input current!</span>


<span class="k">def</span> <span class="nf">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Expects:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  sig        : noise amplitute</span>
<span class="sd">  myseed     : random seed. int or boolean</span>

<span class="sd">  Returns:</span>
<span class="sd">  I          : Ornstein-Uhlenbeck input current</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">tau_ou</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_ou'</span><span class="p">]</span>  <span class="c1"># [ms]</span>

  <span class="c1"># set random seed</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># Initialize</span>
  <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ou</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">I_ou</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">noise</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">sig</span>

  <span class="c1"># generate OU</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
                    <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_ou</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">-</span> <span class="n">I_ou</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
                    <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_ou</span><span class="p">)</span> <span class="o">*</span> <span class="n">sig</span> <span class="o">*</span> <span class="n">noise</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">I_ou</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'tau_ou'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">I_ou</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">I_ou</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$I_{\mathrm</span><span class="si">{OU}</span><span class="s1">}$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With the default parameters, the system fluctuates around a resting state with the noisy input.</p>
<p>Execute this cell to plot activity with noisy input current</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Execute this cell to plot activity with noisy input current</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'tau_ou'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">20201</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">20202</span><span class="p">)</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-3-short-pulse-induced-persistent-activity">
<h2>Interactive Demo 3: Short pulse induced persistent activity<a class="headerlink" href="#interactive-demo-3-short-pulse-induced-persistent-activity" title="Permalink to this headline">¶</a></h2>
<p>Then, let’s use a brief 10-ms positive current to the E population when the system is at its equilibrium. When this amplitude (SE below) is sufficiently large, a persistent activity is produced that outlasts the transient input. What is the firing rate of the persistent activity, and what is the critical input strength? Try to understand the phenomena from the above phase-plane analysis.</p>
<div class="section" id="id5">
<h3><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Make sure you execute this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>


<span class="k">def</span> <span class="nf">my_inject</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_lag</span><span class="o">=</span><span class="mf">10.</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Expects:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  t_start    : pulse starts [ms]</span>
<span class="sd">  t_lag      : pulse lasts  [ms]</span>

<span class="sd">  Returns:</span>
<span class="sd">  I          : extra pulse time</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Initialize</span>
  <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># pulse timing</span>
  <span class="n">N_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_start</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">N_lag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_lag</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">I</span><span class="p">[</span><span class="n">N_start</span><span class="p">:</span><span class="n">N_start</span> <span class="o">+</span> <span class="n">N_lag</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

  <span class="k">return</span> <span class="n">I</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'tau_ou'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># [ms]</span>
<span class="n">sig_ou</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_I'</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'rE_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'rI_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="c1"># pulse</span>
<span class="n">I_pulse</span> <span class="o">=</span> <span class="n">my_inject</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">t_lag</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">L_pulse</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">I_pulse</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">WC_with_pulse</span><span class="p">(</span><span class="n">SE</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_OU</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig_ou</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'I_ext_E'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">SE</span> <span class="o">*</span> <span class="n">I_pulse</span>

  <span class="n">rE</span><span class="p">,</span> <span class="n">rI</span> <span class="o">=</span> <span class="n">simulate_wc</span><span class="p">(</span><span class="o">**</span><span class="n">pars</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rE</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'E population'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">rI</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'I population'</span><span class="p">)</span>

  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">I_pulse</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L_pulse</span><span class="p">),</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="s1">'stimulus on'</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t (ms)'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Activity'</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">WC_with_pulse</span><span class="p">,</span> <span class="n">SE</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Discussion:</span>

<span class="sd">When a system has more than one fixed points, depending on the input strength,</span>
<span class="sd">the network will settle in one of the fixed points. In this case, we have two</span>
<span class="sd">fixed points, one of the fixed points corresponds to high activity. So when input</span>
<span class="sd">drives the network to the high activity fixed points, the network activity will</span>
<span class="sd">remain there -- it is a stable fixed point. Because the network retains its</span>
<span class="sd">activity (persistent activity) even after the input has been removed, we can</span>
<span class="sd">take the persistent activity as working memory.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Explore what happens when a second, brief current is applied to the inhibitory population.</p>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D4_DynamicNetworks/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W2D4_Tutorial2.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 2: Wilson-Cowan Model</p>
</div>
</a>
<a class="right-next" href="W2D4_Outro.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Outro</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>